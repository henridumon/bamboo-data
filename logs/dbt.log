2020-09-27 15:05:20.673958 (MainThread): Done resetting log handlers.
2020-09-27 15:05:20.674007 (MainThread): Received response from rpc task.
2020-09-27 15:05:20.674039 (MainThread): Updating status to Paused
2020-09-27 15:05:21.340686 (MainThread): reported 12 traces in 0.00394s, 2 additional messages skipped
2020-09-27 15:05:21.340845 (MainThread): initialized RateSampler, sample 100% of traces, 95 additional messages skipped
2020-09-27 15:09:11.300867 (MainThread): Caught sighup
2020-09-27 15:09:11.907813 (MainThread): Updating status to Ready
2020-09-27 15:09:11.909154 (MainThread): ignoring not number metric _dd1.sr.eausr:None, 19 additional messages skipped
2020-09-27 15:09:11.910107 (MainThread): writing 2 spans (enabled:True), 11 additional messages skipped
2020-09-27 15:09:11.910202 (MainThread): 
      name postgres.query
        id 5620042394952099844
  trace_id 7329693679140028889
 parent_id None
   service defaultdb
  resource SELECT "develop_request"."id", "develop_request"."user_id", "develop_request"."status", "develop_request"."environment_id", "develop_request"."project_id", "develop_request"."account_id", "develop_request"."status_message", "develop_request"."dbt_version", "develop_request"."container_version", "develop_request"."created_at", "develop_request"."updated_at", "develop_request"."last_request_at", "develop_request"."environment_setup_started_at", "develop_request"."profile_setup_started_at", "develop_request"."deps_setup_started_at", "develop_request"."running_at", "develop_request"."ready_at", "develop_request"."stopping_at", "develop_request"."stopped_at" FROM "develop_request" WHERE "develop_request"."id" = %s FOR UPDATE
      type sql
     start 1601219351.90894
       end 1601219351.910005
  duration 0.001065s
     error 0
      tags 
           django.db.alias:default
           django.db.vendor:postgresql
           runtime-id:7e36ebb93cc14dd8bd6614809d83e421, 21 additional messages skipped
2020-09-27 15:09:11.918453 (MainThread): Kicking off rpc task.
2020-09-27 15:09:11.918505 (MainThread): dbt client called with ['--partial-parse', 'rpc', '--profile', 'user']
2020-09-27 15:09:11.920099 (MainThread): Setting up log handlers...
2020-09-27 15:09:11.931674 (MainThread): Running with dbt=0.17.2
2020-09-27 15:09:12.184853 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.rpc.server.RPCServerTask'>, debug=False, exclude=None, host='0.0.0.0', log_cache_events=False, log_format='default', models=None, partial_parse=True, port=8580, profile='user', profiles_dir='/usr/src/develop/.dbt', project_dir=None, record_timing_info=None, rpc_method=None, single_threaded=False, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, vars='{}', version_check=True, warn_error=False, which='rpc', write_json=True)
2020-09-27 15:09:12.210850 (MainThread): Tracking: tracking
2020-09-27 15:09:12.211032 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa51da328d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa50cca7a20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa50cca72b0>]}
2020-09-27 15:09:12.211315 (MainThread): Serving RPC server at 0.0.0.0:8580, pid=13
2020-09-27 15:09:12.212121 (MainThread): Supported methods: ['cli_args', 'compile', 'compile_sql', 'deps', 'docs.generate', 'gc', 'get-manifest', 'kill', 'poll', 'ps', 'run', 'run-operation', 'run_sql', 'seed', 'snapshot', 'snapshot-freshness', 'status', 'test']
2020-09-27 15:09:12.212515 (MainThread): Send requests to http://localhost:8580/jsonrpc
2020-09-27 15:09:12.214308 (Thread-1): Parsing macros/core.sql
2020-09-27 15:09:12.219115 (Thread-1): Parsing macros/materializations/helpers.sql
2020-09-27 15:09:12.227662 (Thread-1): Parsing macros/materializations/common/merge.sql
2020-09-27 15:09:12.242200 (Thread-1): Parsing macros/materializations/table/table.sql
2020-09-27 15:09:12.249073 (Thread-1): Parsing macros/materializations/view/create_or_replace_view.sql
2020-09-27 15:09:12.254123 (Thread-1): Parsing macros/materializations/view/view.sql
2020-09-27 15:09:12.260682 (Thread-1): Parsing macros/materializations/snapshot/snapshot.sql
2020-09-27 15:09:12.290820 (Thread-1): Parsing macros/materializations/snapshot/strategies.sql
2020-09-27 15:09:12.309396 (Thread-1): Parsing macros/materializations/snapshot/snapshot_merge.sql
2020-09-27 15:09:12.311288 (Thread-1): Parsing macros/materializations/seed/seed.sql
2020-09-27 15:09:12.333042 (Thread-1): Parsing macros/materializations/incremental/incremental.sql
2020-09-27 15:09:12.339523 (Thread-1): Parsing macros/materializations/incremental/helpers.sql
2020-09-27 15:09:12.341504 (Thread-1): Parsing macros/etc/query.sql
2020-09-27 15:09:12.342764 (Thread-1): Parsing macros/etc/get_custom_schema.sql
2020-09-27 15:09:12.344991 (Thread-1): Parsing macros/etc/get_custom_alias.sql
2020-09-27 15:09:12.346018 (Thread-1): Parsing macros/etc/datetime.sql
2020-09-27 15:09:12.355183 (Thread-1): Parsing macros/etc/get_custom_database.sql
2020-09-27 15:09:12.356920 (Thread-1): Parsing macros/etc/is_incremental.sql
2020-09-27 15:09:12.358650 (Thread-1): Parsing macros/adapters/common.sql
2020-09-27 15:09:12.411518 (Thread-1): Parsing macros/schema_tests/relationships.sql
2020-09-27 15:09:12.411848 (AgentWriter): reported 40 traces in 0.03770s
2020-09-27 15:09:12.414431 (AgentWriter): initialized RateSampler, sample 100% of traces, 31 additional messages skipped
2020-09-27 15:09:12.415814 (Thread-1): Parsing macros/schema_tests/unique.sql
2020-09-27 15:09:12.417091 (Thread-1): Parsing macros/schema_tests/accepted_values.sql
2020-09-27 15:09:12.419164 (Thread-1): Parsing macros/schema_tests/not_null.sql
2020-09-27 15:09:12.420484 (Thread-1): Parsing macros/adapters.sql
2020-09-27 15:09:12.437437 (Thread-1): Parsing macros/catalog.sql
2020-09-27 15:09:12.443703 (Thread-1): Parsing macros/etc.sql
2020-09-27 15:09:12.444453 (Thread-1): Parsing macros/materializations/incremental.sql
2020-09-27 15:09:12.457774 (Thread-1): Parsing macros/materializations/snapshot.sql
2020-09-27 15:09:12.459705 (Thread-1): Parsing macros/materializations/seed.sql
2020-09-27 15:09:12.462512 (Thread-1): Parsing macros/materializations/table.sql
2020-09-27 15:09:12.472662 (Thread-1): Parsing macros/materializations/view.sql
2020-09-27 15:09:12.546744 (Thread-1): Acquiring new bigquery connection "model.hubspot.events".
2020-09-27 15:09:12.546909 (Thread-1): Opening a new connection, currently in state init
2020-09-27 15:09:12.734569 (Thread-1): WARNING: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.base

2020-09-27 15:09:13.401979 (Thread-2): handling status request
2020-09-27 15:09:13.402481 (Thread-2): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '27e7380c-b0a4-40fa-a943-feae0a06616b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa507313630>]}
2020-09-27 15:09:13.407729 (Thread-2): sending response (<Response 9588 bytes [200 OK]>) to 10.0.44.9
2020-09-27 15:09:17.825445 (Thread-3): handling status request
2020-09-27 15:09:17.827359 (Thread-3): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '27e7380c-b0a4-40fa-a943-feae0a06616b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa5072cf470>]}
2020-09-27 15:09:17.831362 (Thread-3): sending response (<Response 9588 bytes [200 OK]>) to 10.0.38.179
2020-09-27 15:09:18.136205 (Thread-4): handling run_sql request
2020-09-27 15:09:18.136679 (Thread-4): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '27e7380c-b0a4-40fa-a943-feae0a06616b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa5072d8710>]}
2020-09-27 15:09:18.139919 (Thread-4): Connection 'model.hubspot.events' was properly closed.
2020-09-27 15:09:19.157235 (Thread-4): sending response (<Response 137 bytes [200 OK]>) to 10.0.3.121
2020-09-27 15:09:19.177954 (MainThread): Acquiring new bigquery connection "rpc.hubspot.request".
2020-09-27 15:09:19.178384 (MainThread): Opening a new connection, currently in state init
2020-09-27 15:09:19.210827 (MainThread): Found 1 model, 0 tests, 0 snapshots, 0 analyses, 147 macros, 0 operations, 0 seed files, 0 sources
2020-09-27 15:09:19.211489 (Thread-1): Acquiring new bigquery connection "rpc.hubspot.request".
2020-09-27 15:09:19.211598 (Thread-1): Opening a new connection, currently in state init
2020-09-27 15:09:19.211679 (Thread-1): Compiling rpc.hubspot.request
2020-09-27 15:09:19.226230 (Thread-1): finished collecting timing info
2020-09-27 15:09:19.227100 (Thread-1): On rpc.hubspot.request: SELECT format_date( "%Y%m%d" ,date_add(PARSE_DATE("%Y%m%d",event_date), interval (select date_diff(current_date, PARSE_DATE("%Y%m%d",max(event_date)),day) FROM `bamboodata-project.analytics_220006363.events_an_purchases`) day)) event_date, 
       event_timestamp + (select date_diff(current_date, PARSE_DATE("%Y%m%d",max(event_date)),day) FROM `bamboodata-project.analytics_220006363.events_an_purchases`) * 3600*24*1000000 as event_timestamp,
       user_first_touch_timestamp + (select date_diff(current_date, PARSE_DATE("%Y%m%d",max(event_date)),day) FROM `bamboodata-project.analytics_220006363.events_an_purchases`) * 3600*24*1000000 as user_first_touch_timestamp,

* EXCEPT(event_date, event_timestamp, user_first_touch_timestamp)
FROM `.analytics_220006363.events_an_purchases`
order by event_timestamp desc


limit 100
2020-09-27 15:09:19.481746 (Thread-5): handling poll request
2020-09-27 15:09:19.482317 (Thread-5): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '27e7380c-b0a4-40fa-a943-feae0a06616b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa50732fdd8>]}
2020-09-27 15:09:19.486175 (Thread-5): sending response (<Response 3632 bytes [200 OK]>) to 10.0.38.179
2020-09-27 15:09:20.942065 (Thread-6): handling poll request
2020-09-27 15:09:20.942560 (Thread-6): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '27e7380c-b0a4-40fa-a943-feae0a06616b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa5072e2eb8>]}
2020-09-27 15:09:20.943586 (Thread-6): sending response (<Response 384 bytes [200 OK]>) to 10.0.47.163
2020-09-27 15:09:22.314293 (Thread-7): handling poll request
2020-09-27 15:09:22.316052 (Thread-7): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '27e7380c-b0a4-40fa-a943-feae0a06616b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa5072f0080>]}
2020-09-27 15:09:22.317082 (Thread-7): sending response (<Response 383 bytes [200 OK]>) to 10.0.47.163
2020-09-27 15:09:23.743210 (Thread-8): handling poll request
2020-09-27 15:09:23.743691 (Thread-8): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '27e7380c-b0a4-40fa-a943-feae0a06616b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa5072f09b0>]}
2020-09-27 15:09:23.744673 (Thread-8): sending response (<Response 384 bytes [200 OK]>) to 10.0.2.56
2020-09-27 15:09:25.186784 (Thread-9): handling poll request
2020-09-27 15:09:25.187274 (Thread-9): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '27e7380c-b0a4-40fa-a943-feae0a06616b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa5072f09b0>]}
2020-09-27 15:09:25.188289 (Thread-9): sending response (<Response 384 bytes [200 OK]>) to 10.0.38.51
2020-09-27 15:09:25.833171 (Thread-1): finished collecting timing info
2020-09-27 15:09:26.616493 (Thread-10): handling poll request
2020-09-27 15:09:26.617063 (Thread-10): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '27e7380c-b0a4-40fa-a943-feae0a06616b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa5072f05c0>]}
2020-09-27 15:09:26.624203 (Thread-10): sending response (<Response 233596 bytes [200 OK]>) to 10.0.2.56
2020-09-27 15:09:44.693765 (Thread-11): handling status request
2020-09-27 15:09:44.695623 (Thread-11): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '27e7380c-b0a4-40fa-a943-feae0a06616b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa5072f32b0>]}
2020-09-27 15:09:44.699712 (Thread-11): sending response (<Response 9588 bytes [200 OK]>) to 10.0.17.64
2020-09-27 15:09:44.838630 (Thread-12): handling status request
2020-09-27 15:09:44.839122 (Thread-12): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '27e7380c-b0a4-40fa-a943-feae0a06616b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa506aa5048>]}
2020-09-27 15:09:44.843157 (Thread-12): sending response (<Response 9588 bytes [200 OK]>) to 10.0.17.64
2020-09-27 15:09:45.155810 (Thread-13): handling cli_args request
2020-09-27 15:09:45.156514 (Thread-13): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '27e7380c-b0a4-40fa-a943-feae0a06616b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa506aba358>]}
2020-09-27 15:09:46.115426 (Thread-13): sending response (<Response 137 bytes [200 OK]>) to 10.0.47.163
2020-09-27 15:09:46.175197 (MainThread): Partial parsing not enabled
2020-09-27 15:09:46.177280 (MainThread): Parsing macros/core.sql
2020-09-27 15:09:46.182069 (MainThread): Parsing macros/materializations/helpers.sql
2020-09-27 15:09:46.190480 (MainThread): Parsing macros/materializations/common/merge.sql
2020-09-27 15:09:46.204982 (MainThread): Parsing macros/materializations/table/table.sql
2020-09-27 15:09:46.211869 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2020-09-27 15:09:46.216975 (MainThread): Parsing macros/materializations/view/view.sql
2020-09-27 15:09:46.223544 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2020-09-27 15:09:46.252657 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2020-09-27 15:09:46.270218 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2020-09-27 15:09:46.272167 (MainThread): Parsing macros/materializations/seed/seed.sql
2020-09-27 15:09:46.294508 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2020-09-27 15:09:46.301183 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2020-09-27 15:09:46.303279 (MainThread): Parsing macros/etc/query.sql
2020-09-27 15:09:46.304821 (MainThread): Parsing macros/etc/get_custom_schema.sql
2020-09-27 15:09:46.308067 (MainThread): Parsing macros/etc/get_custom_alias.sql
2020-09-27 15:09:46.309449 (MainThread): Parsing macros/etc/datetime.sql
2020-09-27 15:09:46.318798 (MainThread): Parsing macros/etc/get_custom_database.sql
2020-09-27 15:09:46.320584 (MainThread): Parsing macros/etc/is_incremental.sql
2020-09-27 15:09:46.322393 (MainThread): Parsing macros/adapters/common.sql
2020-09-27 15:09:46.373874 (MainThread): Parsing macros/schema_tests/relationships.sql
2020-09-27 15:09:46.375293 (MainThread): Parsing macros/schema_tests/unique.sql
2020-09-27 15:09:46.376528 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2020-09-27 15:09:46.378673 (MainThread): Parsing macros/schema_tests/not_null.sql
2020-09-27 15:09:46.379973 (MainThread): Parsing macros/adapters.sql
2020-09-27 15:09:46.397004 (MainThread): Parsing macros/catalog.sql
2020-09-27 15:09:46.403376 (MainThread): Parsing macros/etc.sql
2020-09-27 15:09:46.404221 (MainThread): Parsing macros/materializations/incremental.sql
2020-09-27 15:09:46.417618 (MainThread): Parsing macros/materializations/snapshot.sql
2020-09-27 15:09:46.419607 (MainThread): Parsing macros/materializations/seed.sql
2020-09-27 15:09:46.422564 (MainThread): Parsing macros/materializations/table.sql
2020-09-27 15:09:46.432845 (MainThread): Parsing macros/materializations/view.sql
2020-09-27 15:09:46.438463 (MainThread): Partial parsing not enabled
2020-09-27 15:09:46.483267 (MainThread): Acquiring new bigquery connection "model.hubspot.events".
2020-09-27 15:09:46.483400 (MainThread): Opening a new connection, currently in state init
2020-09-27 15:09:46.530017 (Thread-14): handling poll request
2020-09-27 15:09:46.530548 (Thread-14): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '27e7380c-b0a4-40fa-a943-feae0a06616b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa506a49518>]}
2020-09-27 15:09:46.535455 (Thread-14): sending response (<Response 9904 bytes [200 OK]>) to 10.0.27.68
2020-09-27 15:09:46.691231 (MainThread): WARNING: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.base

2020-09-27 15:09:46.703336 (MainThread): Found 1 model, 0 tests, 0 snapshots, 0 analyses, 147 macros, 0 operations, 0 seed files, 0 sources
2020-09-27 15:09:46.703824 (MainThread): WARNING: Nothing to do. Try checking your model configs and model specification args
2020-09-27 15:09:47.883739 (Thread-15): handling poll request
2020-09-27 15:09:47.884403 (Thread-15): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '27e7380c-b0a4-40fa-a943-feae0a06616b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa506a4f518>]}
2020-09-27 15:09:47.886439 (Thread-15): sending response (<Response 1455 bytes [200 OK]>) to 10.0.34.126
2020-09-27 15:09:48.218729 (Thread-16): handling status request
2020-09-27 15:09:48.219237 (Thread-16): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '27e7380c-b0a4-40fa-a943-feae0a06616b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa506a4d630>]}
2020-09-27 15:09:48.225002 (Thread-16): sending response (<Response 9588 bytes [200 OK]>) to 10.0.12.156
2020-09-27 15:10:25.747078 (MainThread): writing 1 spans (enabled:True), 50 additional messages skipped
2020-09-27 15:10:25.747299 (MainThread): 
      name jinja2.compile
        id 837104983208925768
  trace_id 13810474587998004565
 parent_id None
   service None
  resource <memory>
      type template
     start 1601219425.7460768
       end 1601219425.7468238
  duration 0.000747s
     error 0
      tags 
           jinja2.template_name:<memory>
           runtime-id:7e36ebb93cc14dd8bd6614809d83e421, 55 additional messages skipped
2020-09-27 15:10:25.815791 (Thread-17): project hash mismatch: values missing, cache invalidated: {'bamboodata'}
2020-09-27 15:10:25.856338 (Thread-17): Acquiring new bigquery connection "model.bamboodata.events".
2020-09-27 15:10:25.856493 (Thread-17): Opening a new connection, currently in state init
2020-09-27 15:10:26.060260 (Thread-17): WARNING: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.base

2020-09-27 15:10:26.243752 (Thread-18): handling status request
2020-09-27 15:10:26.244235 (Thread-18): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '27e7380c-b0a4-40fa-a943-feae0a06616b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa506913b00>]}
2020-09-27 15:10:26.245590 (Thread-18): sending response (<Response 1464 bytes [200 OK]>) to 10.0.47.163
2020-09-27 15:10:26.435701 (AgentWriter): reported 35 traces in 0.00502s, 1 additional messages skipped
2020-09-27 15:10:26.435939 (AgentWriter): initialized RateSampler, sample 100% of traces, 63 additional messages skipped
2020-09-27 15:10:29.026379 (Thread-19): handling status request
2020-09-27 15:10:29.028195 (Thread-19): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '27e7380c-b0a4-40fa-a943-feae0a06616b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa5075d05c0>]}
2020-09-27 15:10:29.029888 (Thread-19): sending response (<Response 1464 bytes [200 OK]>) to 10.0.12.156
2020-09-27 15:10:29.187676 (Thread-20): handling status request
2020-09-27 15:10:29.188164 (Thread-20): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '27e7380c-b0a4-40fa-a943-feae0a06616b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa5069e69b0>]}
2020-09-27 15:10:29.189428 (Thread-20): sending response (<Response 1464 bytes [200 OK]>) to 10.0.44.9
2020-09-27 15:10:29.630250 (Thread-21): handling cli_args request
2020-09-27 15:10:29.630737 (Thread-21): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '27e7380c-b0a4-40fa-a943-feae0a06616b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa5069640b8>]}
2020-09-27 15:10:29.639106 (Thread-21): Connection 'model.bamboodata.events' was properly closed.
2020-09-27 15:10:30.576931 (Thread-21): sending response (<Response 137 bytes [200 OK]>) to 10.0.5.150
2020-09-27 15:10:30.639380 (MainThread): Partial parsing not enabled
2020-09-27 15:10:30.641460 (MainThread): Parsing macros/core.sql
2020-09-27 15:10:30.646299 (MainThread): Parsing macros/materializations/helpers.sql
2020-09-27 15:10:30.654688 (MainThread): Parsing macros/materializations/common/merge.sql
2020-09-27 15:10:30.669260 (MainThread): Parsing macros/materializations/table/table.sql
2020-09-27 15:10:30.676235 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2020-09-27 15:10:30.681463 (MainThread): Parsing macros/materializations/view/view.sql
2020-09-27 15:10:30.688163 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2020-09-27 15:10:30.716980 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2020-09-27 15:10:30.734098 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2020-09-27 15:10:30.736053 (MainThread): Parsing macros/materializations/seed/seed.sql
2020-09-27 15:10:30.758063 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2020-09-27 15:10:30.764558 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2020-09-27 15:10:30.766674 (MainThread): Parsing macros/etc/query.sql
2020-09-27 15:10:30.767914 (MainThread): Parsing macros/etc/get_custom_schema.sql
2020-09-27 15:10:30.770206 (MainThread): Parsing macros/etc/get_custom_alias.sql
2020-09-27 15:10:30.771354 (MainThread): Parsing macros/etc/datetime.sql
2020-09-27 15:10:30.780959 (MainThread): Parsing macros/etc/get_custom_database.sql
2020-09-27 15:10:30.782790 (MainThread): Parsing macros/etc/is_incremental.sql
2020-09-27 15:10:30.784574 (MainThread): Parsing macros/adapters/common.sql
2020-09-27 15:10:30.835108 (MainThread): Parsing macros/schema_tests/relationships.sql
2020-09-27 15:10:30.836499 (MainThread): Parsing macros/schema_tests/unique.sql
2020-09-27 15:10:30.837837 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2020-09-27 15:10:30.839976 (MainThread): Parsing macros/schema_tests/not_null.sql
2020-09-27 15:10:30.841362 (MainThread): Parsing macros/adapters.sql
2020-09-27 15:10:30.858608 (MainThread): Parsing macros/catalog.sql
2020-09-27 15:10:30.865091 (MainThread): Parsing macros/etc.sql
2020-09-27 15:10:30.865919 (MainThread): Parsing macros/materializations/incremental.sql
2020-09-27 15:10:30.879402 (MainThread): Parsing macros/materializations/snapshot.sql
2020-09-27 15:10:30.881500 (MainThread): Parsing macros/materializations/seed.sql
2020-09-27 15:10:30.884371 (MainThread): Parsing macros/materializations/table.sql
2020-09-27 15:10:30.894584 (MainThread): Parsing macros/materializations/view.sql
2020-09-27 15:10:30.900416 (MainThread): Partial parsing not enabled
2020-09-27 15:10:30.945733 (MainThread): Acquiring new bigquery connection "model.bamboodata.events".
2020-09-27 15:10:30.945862 (MainThread): Opening a new connection, currently in state init
2020-09-27 15:10:31.028648 (Thread-22): handling poll request
2020-09-27 15:10:31.029294 (Thread-22): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '27e7380c-b0a4-40fa-a943-feae0a06616b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa5068cda20>]}
2020-09-27 15:10:31.036103 (Thread-22): sending response (<Response 9907 bytes [200 OK]>) to 10.0.34.126
2020-09-27 15:10:31.115538 (MainThread): WARNING: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.base

2020-09-27 15:10:31.134326 (MainThread): Found 1 model, 0 tests, 0 snapshots, 0 analyses, 147 macros, 0 operations, 0 seed files, 0 sources
2020-09-27 15:10:31.134863 (MainThread): WARNING: Nothing to do. Try checking your model configs and model specification args
2020-09-27 15:10:32.545877 (Thread-23): handling poll request
2020-09-27 15:10:32.546520 (Thread-23): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '27e7380c-b0a4-40fa-a943-feae0a06616b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa5075d0f98>]}
2020-09-27 15:10:32.548424 (Thread-23): sending response (<Response 1455 bytes [200 OK]>) to 10.0.38.179
2020-09-27 15:10:33.018732 (Thread-24): handling status request
2020-09-27 15:10:33.019231 (Thread-24): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '27e7380c-b0a4-40fa-a943-feae0a06616b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa506a4dd68>]}
2020-09-27 15:10:33.020492 (Thread-24): sending response (<Response 1464 bytes [200 OK]>) to 10.0.17.64
2020-09-27 15:12:24.146063 (Thread-25): handling status request
2020-09-27 15:12:24.147769 (Thread-25): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '27e7380c-b0a4-40fa-a943-feae0a06616b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa5068cd320>]}
2020-09-27 15:12:24.149000 (Thread-25): sending response (<Response 1464 bytes [200 OK]>) to 10.0.17.64
2020-09-27 15:12:28.951403 (MainThread): writing 1 spans (enabled:True), 34 additional messages skipped
2020-09-27 15:12:28.952926 (MainThread): 
      name jinja2.compile
        id 13868333548120498845
  trace_id 11027988821577780477
 parent_id None
   service None
  resource <memory>
      type template
     start 1601219548.950441
       end 1601219548.9511688
  duration 0.000728s
     error 0
      tags 
           jinja2.template_name:<memory>
           runtime-id:7e36ebb93cc14dd8bd6614809d83e421, 34 additional messages skipped
2020-09-27 15:12:29.051124 (Thread-26): Acquiring new bigquery connection "model.bamboodata.events".
2020-09-27 15:12:29.051288 (Thread-26): Opening a new connection, currently in state init
2020-09-27 15:12:29.304785 (Thread-26): WARNING: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.base

2020-09-27 15:12:29.456978 (AgentWriter): reported 35 traces in 0.00551s
2020-09-27 15:12:29.457233 (AgentWriter): initialized RateSampler, sample 100% of traces, 31 additional messages skipped
2020-09-27 15:12:29.612208 (Thread-27): handling status request
2020-09-27 15:12:29.612693 (Thread-27): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '27e7380c-b0a4-40fa-a943-feae0a06616b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa5073da7f0>]}
2020-09-27 15:12:29.613910 (Thread-27): sending response (<Response 1161 bytes [200 OK]>) to 10.0.47.163
2020-09-27 15:13:29.194445 (MainThread): writing 1 spans (enabled:True), 34 additional messages skipped
2020-09-27 15:13:29.195940 (MainThread): 
      name jinja2.compile
        id 12805244309187963898
  trace_id 11362372188797991562
 parent_id None
   service None
  resource <memory>
      type template
     start 1601219609.193781
       end 1601219609.194288
  duration 0.000507s
     error 0
      tags 
           jinja2.template_name:<memory>
           runtime-id:7e36ebb93cc14dd8bd6614809d83e421, 34 additional messages skipped
2020-09-27 15:13:29.267642 (Thread-28): For key bamboodata, hash mismatch (FileHash(name='sha256', checksum='30157199a8f1b2a5bf63fd4020baa498f9f981057867e4cae61592ead79f11e4') -> FileHash(name='sha256', checksum='6cdc30c4b9a9922548813ad8d29690f65ff80e9df1a08d04134d1005e60001c8')), cache invalidated
2020-09-27 15:13:29.306876 (Thread-28): Acquiring new bigquery connection "model.bamboodata.events".
2020-09-27 15:13:29.307049 (Thread-28): Opening a new connection, currently in state closed
2020-09-27 15:13:29.474080 (Thread-28): WARNING: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.output
- models.base

2020-09-27 15:13:29.475998 (AgentWriter): reported 36 traces in 0.00637s
2020-09-27 15:13:29.476202 (AgentWriter): initialized RateSampler, sample 100% of traces, 31 additional messages skipped
2020-09-27 15:13:29.925228 (Thread-29): handling status request
2020-09-27 15:13:29.925767 (Thread-29): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '27e7380c-b0a4-40fa-a943-feae0a06616b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa50682c668>]}
2020-09-27 15:13:29.927009 (Thread-29): sending response (<Response 1670 bytes [200 OK]>) to 10.0.38.51
2020-09-27 15:14:18.412675 (Thread-30): handling status request
2020-09-27 15:14:18.414570 (Thread-30): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '27e7380c-b0a4-40fa-a943-feae0a06616b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa5068e80f0>]}
2020-09-27 15:14:18.415800 (Thread-30): sending response (<Response 1670 bytes [200 OK]>) to 10.0.27.68
2020-09-27 15:14:18.419536 (Thread-31): handling status request
2020-09-27 15:14:18.419880 (Thread-31): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '27e7380c-b0a4-40fa-a943-feae0a06616b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa5068de7f0>]}
2020-09-27 15:14:18.420993 (Thread-31): sending response (<Response 1670 bytes [200 OK]>) to 10.0.24.187
2020-09-27 15:14:18.873951 (Thread-32): handling cli_args request
2020-09-27 15:14:18.874438 (Thread-32): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '27e7380c-b0a4-40fa-a943-feae0a06616b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa5068de7f0>]}
2020-09-27 15:14:18.876852 (Thread-32): Checking header 'user-agent' tracing in whitelist set(), 44 additional messages skipped
2020-09-27 15:14:18.898754 (Thread-32): writing 1 spans (enabled:True), 35 additional messages skipped
2020-09-27 15:14:18.899009 (Thread-32): 
      name requests.request
        id 5749923555100351885
  trace_id 11886711785028961000
 parent_id None
   service requests
  resource requests.request
      type http
     start 1601219658.8765771
       end 1601219658.8986242
  duration 0.022047s
     error 0
      tags 
           http.method:POST
           http.status_code:200
           http.url:https://fishtownanalytics.sinter-collect.com/com.snowplowanalytics.snowplow/tp2
           runtime-id:7e36ebb93cc14dd8bd6614809d83e421, 35 additional messages skipped
2020-09-27 15:14:18.910900 (Thread-32): Connection 'model.bamboodata.events' was properly closed.
2020-09-27 15:14:19.495534 (AgentWriter): reported 1 traces in 0.00556s
2020-09-27 15:14:19.496119 (AgentWriter): initialized RateSampler, sample 100% of traces, 31 additional messages skipped
2020-09-27 15:14:19.872340 (Thread-32): sending response (<Response 137 bytes [200 OK]>) to 10.0.34.126
2020-09-27 15:14:19.931927 (MainThread): Partial parsing not enabled
2020-09-27 15:14:19.934047 (MainThread): Parsing macros/core.sql
2020-09-27 15:14:19.938786 (MainThread): Parsing macros/materializations/helpers.sql
2020-09-27 15:14:19.947183 (MainThread): Parsing macros/materializations/common/merge.sql
2020-09-27 15:14:19.961775 (MainThread): Parsing macros/materializations/table/table.sql
2020-09-27 15:14:19.969343 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2020-09-27 15:14:19.974401 (MainThread): Parsing macros/materializations/view/view.sql
2020-09-27 15:14:19.981073 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2020-09-27 15:14:20.010289 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2020-09-27 15:14:20.027635 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2020-09-27 15:14:20.029592 (MainThread): Parsing macros/materializations/seed/seed.sql
2020-09-27 15:14:20.051732 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2020-09-27 15:14:20.058453 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2020-09-27 15:14:20.060444 (MainThread): Parsing macros/etc/query.sql
2020-09-27 15:14:20.061707 (MainThread): Parsing macros/etc/get_custom_schema.sql
2020-09-27 15:14:20.063893 (MainThread): Parsing macros/etc/get_custom_alias.sql
2020-09-27 15:14:20.065043 (MainThread): Parsing macros/etc/datetime.sql
2020-09-27 15:14:20.074792 (MainThread): Parsing macros/etc/get_custom_database.sql
2020-09-27 15:14:20.076703 (MainThread): Parsing macros/etc/is_incremental.sql
2020-09-27 15:14:20.079177 (MainThread): Parsing macros/adapters/common.sql
2020-09-27 15:14:20.130535 (MainThread): Parsing macros/schema_tests/relationships.sql
2020-09-27 15:14:20.131922 (MainThread): Parsing macros/schema_tests/unique.sql
2020-09-27 15:14:20.133257 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2020-09-27 15:14:20.135359 (MainThread): Parsing macros/schema_tests/not_null.sql
2020-09-27 15:14:20.136657 (MainThread): Parsing macros/adapters.sql
2020-09-27 15:14:20.153954 (MainThread): Parsing macros/catalog.sql
2020-09-27 15:14:20.160245 (MainThread): Parsing macros/etc.sql
2020-09-27 15:14:20.161070 (MainThread): Parsing macros/materializations/incremental.sql
2020-09-27 15:14:20.174689 (MainThread): Parsing macros/materializations/snapshot.sql
2020-09-27 15:14:20.176677 (MainThread): Parsing macros/materializations/seed.sql
2020-09-27 15:14:20.179624 (MainThread): Parsing macros/materializations/table.sql
2020-09-27 15:14:20.190085 (MainThread): Parsing macros/materializations/view.sql
2020-09-27 15:14:20.195527 (MainThread): Partial parsing not enabled
2020-09-27 15:14:20.241250 (MainThread): Acquiring new bigquery connection "model.bamboodata.events".
2020-09-27 15:14:20.241378 (MainThread): Opening a new connection, currently in state init
2020-09-27 15:14:20.308479 (Thread-33): handling poll request
2020-09-27 15:14:20.309118 (Thread-33): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '27e7380c-b0a4-40fa-a943-feae0a06616b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa5073814e0>]}
2020-09-27 15:14:20.313986 (Thread-33): sending response (<Response 9907 bytes [200 OK]>) to 10.0.12.102
2020-09-27 15:14:20.426405 (MainThread): WARNING: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.output
- models.base

2020-09-27 15:14:20.445775 (MainThread): Found 1 model, 0 tests, 0 snapshots, 0 analyses, 147 macros, 0 operations, 0 seed files, 0 sources
2020-09-27 15:14:20.446380 (MainThread): WARNING: Nothing to do. Try checking your model configs and model specification args
2020-09-27 15:14:21.759574 (Thread-34): handling poll request
2020-09-27 15:14:21.760082 (Thread-34): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '27e7380c-b0a4-40fa-a943-feae0a06616b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa5075a9470>]}
2020-09-27 15:14:21.761564 (Thread-34): sending response (<Response 1472 bytes [200 OK]>) to 10.0.38.51
2020-09-27 15:14:22.513174 (Thread-35): handling status request
2020-09-27 15:14:22.513661 (Thread-35): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '27e7380c-b0a4-40fa-a943-feae0a06616b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa5075a9320>]}
2020-09-27 15:14:22.515024 (Thread-35): sending response (<Response 1670 bytes [200 OK]>) to 10.0.2.56
2020-09-27 15:17:27.963188 (Thread-36): handling status request
2020-09-27 15:17:27.964806 (Thread-36): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '27e7380c-b0a4-40fa-a943-feae0a06616b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa5075a9320>]}
2020-09-27 15:17:27.966428 (Thread-36): sending response (<Response 1670 bytes [200 OK]>) to 10.0.36.169
2020-09-27 15:17:33.038697 (MainThread): writing 1 spans (enabled:True)
2020-09-27 15:17:33.040231 (MainThread): 
      name jinja2.compile
        id 17591074512887221440
  trace_id 626616726216760169
 parent_id None
   service None
  resource <memory>
      type template
     start 1601219853.037785
       end 1601219853.038535
  duration 0.000750s
     error 0
      tags 
           jinja2.template_name:<memory>
           runtime-id:7e36ebb93cc14dd8bd6614809d83e421
2020-09-27 15:17:33.140307 (Thread-37): Acquiring new bigquery connection "model.bamboodata.events".
2020-09-27 15:17:33.140474 (Thread-37): Opening a new connection, currently in state init
2020-09-27 15:17:33.291253 (Thread-37): WARNING: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.output
- models.base

2020-09-27 15:17:33.524184 (AgentWriter): reported 36 traces in 0.00512s
2020-09-27 15:17:33.524435 (AgentWriter): initialized RateSampler, sample 100% of traces, 31 additional messages skipped
2020-09-27 15:17:33.552384 (Thread-38): handling status request
2020-09-27 15:17:33.552922 (Thread-38): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '27e7380c-b0a4-40fa-a943-feae0a06616b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa506966048>]}
2020-09-27 15:17:33.554145 (Thread-38): sending response (<Response 1178 bytes [200 OK]>) to 10.0.3.121
2020-09-27 15:18:39.073530 (MainThread): writing 1 spans (enabled:True), 35 additional messages skipped
2020-09-27 15:18:39.074876 (MainThread): 
      name jinja2.compile
        id 6039168852336202519
  trace_id 13135486727334818978
 parent_id None
   service None
  resource <memory>
      type template
     start 1601219919.072792
       end 1601219919.073369
  duration 0.000577s
     error 0
      tags 
           jinja2.template_name:<memory>
           runtime-id:7e36ebb93cc14dd8bd6614809d83e421, 35 additional messages skipped
2020-09-27 15:18:39.154458 (Thread-39): Got an acceptable cached parse result
2020-09-27 15:18:39.343160 (Thread-39): WARNING: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.output
- models.base

2020-09-27 15:18:39.537757 (AgentWriter): reported 36 traces in 0.00524s
2020-09-27 15:18:39.538002 (AgentWriter): initialized RateSampler, sample 100% of traces, 31 additional messages skipped
2020-09-27 15:18:39.808061 (Thread-40): handling status request
2020-09-27 15:18:39.808558 (Thread-40): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '27e7380c-b0a4-40fa-a943-feae0a06616b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa506957048>]}
2020-09-27 15:18:39.809649 (Thread-40): sending response (<Response 873 bytes [200 OK]>) to 10.0.2.56
2020-09-27 15:18:46.186391 (Thread-41): Got an acceptable cached parse result
2020-09-27 15:18:46.228679 (Thread-41): Acquiring new bigquery connection "model.bamboodata.bbd_country_user_progress".
2020-09-27 15:18:46.228835 (Thread-41): Opening a new connection, currently in state closed
2020-09-27 15:18:46.499132 (Thread-41): WARNING: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.output
- models.base

2020-09-27 15:18:46.554357 (Thread-42): handling status request
2020-09-27 15:18:46.554851 (Thread-42): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '27e7380c-b0a4-40fa-a943-feae0a06616b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa50675df98>]}
2020-09-27 15:18:46.556095 (Thread-42): sending response (<Response 1467 bytes [200 OK]>) to 10.0.44.9
2020-09-27 15:18:51.362064 (Thread-43): Got an acceptable cached parse result
2020-09-27 15:18:51.403249 (Thread-43): Acquiring new bigquery connection "model.bamboodata.events".
2020-09-27 15:18:51.403411 (Thread-43): Opening a new connection, currently in state closed
2020-09-27 15:18:51.554800 (Thread-43): WARNING: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.output
- models.base

2020-09-27 15:18:51.749084 (Thread-44): handling status request
2020-09-27 15:18:51.749654 (Thread-44): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '27e7380c-b0a4-40fa-a943-feae0a06616b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa5067120f0>]}
2020-09-27 15:18:51.750904 (Thread-44): sending response (<Response 1448 bytes [200 OK]>) to 10.0.38.179
2020-09-27 15:20:55.897514 (Thread-45): handling status request
2020-09-27 15:20:55.899372 (Thread-45): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '27e7380c-b0a4-40fa-a943-feae0a06616b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa5072e2588>]}
2020-09-27 15:20:55.900707 (Thread-45): sending response (<Response 1448 bytes [200 OK]>) to 10.0.38.51
2020-09-27 15:20:56.226982 (Thread-46): handling run_sql request
2020-09-27 15:20:56.227475 (Thread-46): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '27e7380c-b0a4-40fa-a943-feae0a06616b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa5074a5400>]}
2020-09-27 15:20:56.228919 (Thread-46): Connection 'model.bamboodata.events' was properly closed.
2020-09-27 15:20:57.201589 (Thread-46): sending response (<Response 137 bytes [200 OK]>) to 10.0.18.102
2020-09-27 15:20:57.223444 (MainThread): Acquiring new bigquery connection "rpc.bamboodata.request".
2020-09-27 15:20:57.223882 (MainThread): Opening a new connection, currently in state init
2020-09-27 15:20:57.258939 (MainThread): Found 2 models, 0 tests, 0 snapshots, 0 analyses, 147 macros, 0 operations, 0 seed files, 0 sources
2020-09-27 15:20:57.259593 (Thread-1): Acquiring new bigquery connection "rpc.bamboodata.request".
2020-09-27 15:20:57.259701 (Thread-1): Opening a new connection, currently in state init
2020-09-27 15:20:57.259784 (Thread-1): Compiling rpc.bamboodata.request
2020-09-27 15:20:57.280686 (Thread-1): finished collecting timing info
2020-09-27 15:20:57.281544 (Thread-1): On rpc.bamboodata.request: with yesterday_new_users as 
(
select geo.country as country, app_info.id, count(distinct user_pseudo_id) yesterday_new_users
FROM `bamboodata-project`.`dbt_hdumon`.`events`
WHERE event_date = FORMAT_DATE("%Y%m%d", DATE_SUB(CURRENT_DATE(), INTERVAL 1 DAY))
      and event_timestamp = user_first_touch_timestamp
group by geo.country, app_info.id
),

prev_day_new_users as
(
select geo.country as country, app_info.id, count(distinct user_pseudo_id) prev_day_new_users
FROM `bamboodata-project`.`dbt_hdumon`.`events`
WHERE event_date = FORMAT_DATE("%Y%m%d", DATE_SUB(CURRENT_DATE(), INTERVAL 2 DAY))
      and event_timestamp = user_first_touch_timestamp
group by geo.country, app_info.id
),

three_day_ago_new_users as
(
select geo.country as country, app_info.id, count(distinct user_pseudo_id) three_day_ago_new_users
FROM `bamboodata-project`.`dbt_hdumon`.`events`
WHERE event_date = FORMAT_DATE("%Y%m%d", DATE_SUB(CURRENT_DATE(), INTERVAL 3 DAY))
      and event_timestamp = user_first_touch_timestamp
group by geo.country, app_info.id
),

last_week_users as
(
select geo.country as country, app_info.id, count(distinct user_pseudo_id) last_week_users
FROM `bamboodata-project`.`dbt_hdumon`.`events`
WHERE event_date <= FORMAT_DATE("%Y%m%d", DATE_TRUNC(CURRENT_DATE(), WEEK))
      AND event_date > FORMAT_DATE("%Y%m%d", DATE_SUB(DATE_TRUNC(CURRENT_DATE(), WEEK), INTERVAL 1 WEEK))
      and event_timestamp = user_first_touch_timestamp
group by geo.country,app_info.id),

previous_week_users as
(
select geo.country as country, app_info.id, count(distinct user_pseudo_id) prev_week_users
FROM `bamboodata-project`.`dbt_hdumon`.`events`
WHERE event_date <= FORMAT_DATE("%Y%m%d", DATE_SUB(DATE_TRUNC(CURRENT_DATE(), WEEK), INTERVAL 1 WEEK))
      AND event_date > FORMAT_DATE("%Y%m%d", DATE_SUB(DATE_TRUNC(CURRENT_DATE(), WEEK), INTERVAL 2 WEEK))
      and event_timestamp = user_first_touch_timestamp
group by geo.country, app_info.id)


select lwu.country, struct(lwu.id) as app_info, ynu.yesterday_new_users, pdnu.prev_day_new_users, tdnu.three_day_ago_new_users ,lwu.last_week_users, pwu.prev_week_users
from last_week_users lwu
left join yesterday_new_users ynu
on lwu.country = ynu.country
and lwu.id = ynu.id
left join prev_day_new_users pdnu
on lwu.country = pdnu.country
and lwu.id = pdnu.id
left join three_day_ago_new_users tdnu
on lwu.country = tdnu.country
and lwu.id = tdnu.id
left join previous_week_users pwu
on lwu.country = pwu.country
and lwu.id = pwu.id
limit 100
2020-09-27 15:20:57.663013 (Thread-47): handling poll request
2020-09-27 15:20:57.661474 (Thread-1): Unhandled error while running:
with yesterday_new_users as 
(
select geo.country as country, app_info.id, count(distinct user_pseudo_id) yesterday_new_users
FROM `bamboodata-project`.`dbt_hdumon`.`events`
WHERE event_date = FORMAT_DATE("%Y%m%d", DATE_SUB(CURRENT_DATE(), INTERVAL 1 DAY))
      and event_timestamp = user_first_touch_timestamp
group by geo.country, app_info.id
),

prev_day_new_users as
(
select geo.country as country, app_info.id, count(distinct user_pseudo_id) prev_day_new_users
FROM `bamboodata-project`.`dbt_hdumon`.`events`
WHERE event_date = FORMAT_DATE("%Y%m%d", DATE_SUB(CURRENT_DATE(), INTERVAL 2 DAY))
      and event_timestamp = user_first_touch_timestamp
group by geo.country, app_info.id
),

three_day_ago_new_users as
(
select geo.country as country, app_info.id, count(distinct user_pseudo_id) three_day_ago_new_users
FROM `bamboodata-project`.`dbt_hdumon`.`events`
WHERE event_date = FORMAT_DATE("%Y%m%d", DATE_SUB(CURRENT_DATE(), INTERVAL 3 DAY))
      and event_timestamp = user_first_touch_timestamp
group by geo.country, app_info.id
),

last_week_users as
(
select geo.country as country, app_info.id, count(distinct user_pseudo_id) last_week_users
FROM `bamboodata-project`.`dbt_hdumon`.`events`
WHERE event_date <= FORMAT_DATE("%Y%m%d", DATE_TRUNC(CURRENT_DATE(), WEEK))
      AND event_date > FORMAT_DATE("%Y%m%d", DATE_SUB(DATE_TRUNC(CURRENT_DATE(), WEEK), INTERVAL 1 WEEK))
      and event_timestamp = user_first_touch_timestamp
group by geo.country,app_info.id),

previous_week_users as
(
select geo.country as country, app_info.id, count(distinct user_pseudo_id) prev_week_users
FROM `bamboodata-project`.`dbt_hdumon`.`events`
WHERE event_date <= FORMAT_DATE("%Y%m%d", DATE_SUB(DATE_TRUNC(CURRENT_DATE(), WEEK), INTERVAL 1 WEEK))
      AND event_date > FORMAT_DATE("%Y%m%d", DATE_SUB(DATE_TRUNC(CURRENT_DATE(), WEEK), INTERVAL 2 WEEK))
      and event_timestamp = user_first_touch_timestamp
group by geo.country, app_info.id)


select lwu.country, struct(lwu.id) as app_info, ynu.yesterday_new_users, pdnu.prev_day_new_users, tdnu.three_day_ago_new_users ,lwu.last_week_users, pwu.prev_week_users
from last_week_users lwu
left join yesterday_new_users ynu
on lwu.country = ynu.country
and lwu.id = ynu.id
left join prev_day_new_users pdnu
on lwu.country = pdnu.country
and lwu.id = pdnu.id
left join three_day_ago_new_users tdnu
on lwu.country = tdnu.country
and lwu.id = tdnu.id
left join previous_week_users pwu
on lwu.country = pwu.country
and lwu.id = pwu.id
limit 100
2020-09-27 15:20:57.663854 (Thread-47): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '27e7380c-b0a4-40fa-a943-feae0a06616b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa5075bd0f0>]}
2020-09-27 15:20:57.666598 (Thread-47): sending response (<Response 8183 bytes [200 OK]>) to 10.0.17.64
2020-09-27 15:20:57.661712 (Thread-1): finished collecting timing info
2020-09-27 15:20:57.662070 (Thread-1): Got an exception: Runtime Error
  404 Not found: Dataset bamboodata-project:dbt_hdumon was not found in location US
  
  (job ID: 08820a71-1c4e-4773-b50d-24a17bd3a841)
Traceback (most recent call last):
  File "/usr/local/lib/python3.6/dist-packages/dbt/adapters/bigquery/connections.py", line 85, in exception_handler
    yield
  File "/usr/local/lib/python3.6/dist-packages/dbt/adapters/bigquery/connections.py", line 364, in _retry_and_handle
    deadline=None)
  File "/usr/local/lib/python3.6/dist-packages/google/api_core/retry.py", line 184, in retry_target
    return target()
  File "/usr/local/lib/python3.6/dist-packages/dbt/adapters/bigquery/connections.py", line 226, in fn
    return self._query_and_results(client, sql, conn, job_params)
  File "/usr/local/lib/python3.6/dist-packages/dbt/adapters/bigquery/connections.py", line 353, in _query_and_results
    iterator = query_job.result(timeout=timeout)
  File "/usr/local/lib/python3.6/dist-packages/google/cloud/bigquery/job.py", line 3196, in result
    super(QueryJob, self).result(retry=retry, timeout=timeout)
  File "/usr/local/lib/python3.6/dist-packages/google/cloud/bigquery/job.py", line 818, in result
    return super(_AsyncJob, self).result(timeout=timeout)
  File "/usr/local/lib/python3.6/dist-packages/google/api_core/future/polling.py", line 130, in result
    raise self._exception
google.api_core.exceptions.NotFound: 404 Not found: Dataset bamboodata-project:dbt_hdumon was not found in location US

(job ID: 08820a71-1c4e-4773-b50d-24a17bd3a841)

                                                                       -----Query Job SQL Follows-----                                                                       

    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |
   1:with yesterday_new_users as 
   2:(
   3:select geo.country as country, app_info.id, count(distinct user_pseudo_id) yesterday_new_users
   4:FROM `bamboodata-project`.`dbt_hdumon`.`events`
   5:WHERE event_date = FORMAT_DATE("%Y%m%d", DATE_SUB(CURRENT_DATE(), INTERVAL 1 DAY))
   6:      and event_timestamp = user_first_touch_timestamp
   7:group by geo.country, app_info.id
   8:),
   9:
  10:prev_day_new_users as
  11:(
  12:select geo.country as country, app_info.id, count(distinct user_pseudo_id) prev_day_new_users
  13:FROM `bamboodata-project`.`dbt_hdumon`.`events`
  14:WHERE event_date = FORMAT_DATE("%Y%m%d", DATE_SUB(CURRENT_DATE(), INTERVAL 2 DAY))
  15:      and event_timestamp = user_first_touch_timestamp
  16:group by geo.country, app_info.id
  17:),
  18:
  19:three_day_ago_new_users as
  20:(
  21:select geo.country as country, app_info.id, count(distinct user_pseudo_id) three_day_ago_new_users
  22:FROM `bamboodata-project`.`dbt_hdumon`.`events`
  23:WHERE event_date = FORMAT_DATE("%Y%m%d", DATE_SUB(CURRENT_DATE(), INTERVAL 3 DAY))
  24:      and event_timestamp = user_first_touch_timestamp
  25:group by geo.country, app_info.id
  26:),
  27:
  28:last_week_users as
  29:(
  30:select geo.country as country, app_info.id, count(distinct user_pseudo_id) last_week_users
  31:FROM `bamboodata-project`.`dbt_hdumon`.`events`
  32:WHERE event_date <= FORMAT_DATE("%Y%m%d", DATE_TRUNC(CURRENT_DATE(), WEEK))
  33:      AND event_date > FORMAT_DATE("%Y%m%d", DATE_SUB(DATE_TRUNC(CURRENT_DATE(), WEEK), INTERVAL 1 WEEK))
  34:      and event_timestamp = user_first_touch_timestamp
  35:group by geo.country,app_info.id),
  36:
  37:previous_week_users as
  38:(
  39:select geo.country as country, app_info.id, count(distinct user_pseudo_id) prev_week_users
  40:FROM `bamboodata-project`.`dbt_hdumon`.`events`
  41:WHERE event_date <= FORMAT_DATE("%Y%m%d", DATE_SUB(DATE_TRUNC(CURRENT_DATE(), WEEK), INTERVAL 1 WEEK))
  42:      AND event_date > FORMAT_DATE("%Y%m%d", DATE_SUB(DATE_TRUNC(CURRENT_DATE(), WEEK), INTERVAL 2 WEEK))
  43:      and event_timestamp = user_first_touch_timestamp
  44:group by geo.country, app_info.id)
  45:
  46:
  47:select lwu.country, struct(lwu.id) as app_info, ynu.yesterday_new_users, pdnu.prev_day_new_users, tdnu.three_day_ago_new_users ,lwu.last_week_users, pwu.prev_week_users
  48:from last_week_users lwu
  49:left join yesterday_new_users ynu
  50:on lwu.country = ynu.country
  51:and lwu.id = ynu.id
  52:left join prev_day_new_users pdnu
  53:on lwu.country = pdnu.country
  54:and lwu.id = pdnu.id
  55:left join three_day_ago_new_users tdnu
  56:on lwu.country = tdnu.country
  57:and lwu.id = tdnu.id
  58:left join previous_week_users pwu
  59:on lwu.country = pwu.country
  60:and lwu.id = pwu.id
  61:limit 100
    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/usr/local/lib/python3.6/dist-packages/dbt/node_runners.py", line 228, in safe_run
    result = self.compile_and_execute(manifest, ctx)
  File "/usr/local/lib/python3.6/dist-packages/dbt/node_runners.py", line 171, in compile_and_execute
    result = self.run(ctx.node, manifest)
  File "/usr/local/lib/python3.6/dist-packages/dbt/node_runners.py", line 273, in run
    return self.execute(compiled_node, manifest)
  File "/usr/local/lib/python3.6/dist-packages/dbt/rpc/node_runners.py", line 86, in execute
    compiled_node.injected_sql, fetch=True
  File "/usr/local/lib/python3.6/dist-packages/dbt/adapters/base/impl.py", line 228, in execute
    fetch=fetch
  File "/usr/local/lib/python3.6/dist-packages/dbt/adapters/bigquery/connections.py", line 235, in execute
    query_job, iterator = self.raw_execute(sql, fetch=fetch)
  File "/usr/local/lib/python3.6/dist-packages/dbt/adapters/bigquery/connections.py", line 228, in raw_execute
    query_job, iterator = self._retry_and_handle(msg=sql, conn=conn, fn=fn)
  File "/usr/local/lib/python3.6/dist-packages/dbt/adapters/bigquery/connections.py", line 364, in _retry_and_handle
    deadline=None)
  File "/usr/lib/python3.6/contextlib.py", line 99, in __exit__
    self.gen.throw(type, value, traceback)
  File "/usr/local/lib/python3.6/dist-packages/dbt/adapters/bigquery/connections.py", line 108, in exception_handler
    raise RuntimeException(exc_message)
dbt.exceptions.RuntimeException: Runtime Error
  404 Not found: Dataset bamboodata-project:dbt_hdumon was not found in location US
  
  (job ID: 08820a71-1c4e-4773-b50d-24a17bd3a841)
2020-09-27 15:20:57.665590 (Thread-1): Got exception RPCException(10001, Runtime error, {'type': 'RuntimeException', 'message': 'Runtime Error in rpc request (from remote system)\n  404 Not found: Dataset bamboodata-project:dbt_hdumon was not found in location US\n  \n  (job ID: 08820a71-1c4e-4773-b50d-24a17bd3a841)', 'raw_sql': 'with yesterday_new_users as \r\n(\r\nselect geo.country as country, app_info.id, count(distinct user_pseudo_id) yesterday_new_users\r\nFROM {{ ref(\'events\') }}\r\nWHERE event_date = FORMAT_DATE("%Y%m%d", DATE_SUB(CURRENT_DATE(), INTERVAL 1 DAY))\r\n      and event_timestamp = user_first_touch_timestamp\r\ngroup by geo.country, app_info.id\r\n),\r\n\r\nprev_day_new_users as\r\n(\r\nselect geo.country as country, app_info.id, count(distinct user_pseudo_id) prev_day_new_users\r\nFROM {{ ref(\'events\') }}\r\nWHERE event_date = FORMAT_DATE("%Y%m%d", DATE_SUB(CURRENT_DATE(), INTERVAL 2 DAY))\r\n      and event_timestamp = user_first_touch_timestamp\r\ngroup by geo.country, app_info.id\r\n),\r\n\r\nthree_day_ago_new_users as\r\n(\r\nselect geo.country as country, app_info.id, count(distinct user_pseudo_id) three_day_ago_new_users\r\nFROM {{ ref(\'events\') }}\r\nWHERE event_date = FORMAT_DATE("%Y%m%d", DATE_SUB(CURRENT_DATE(), INTERVAL 3 DAY))\r\n      and event_timestamp = user_first_touch_timestamp\r\ngroup by geo.country, app_info.id\r\n),\r\n\r\nlast_week_users as\r\n(\r\nselect geo.country as country, app_info.id, count(distinct user_pseudo_id) last_week_users\r\nFROM {{ ref(\'events\') }}\r\nWHERE event_date <= FORMAT_DATE("%Y%m%d", DATE_TRUNC(CURRENT_DATE(), WEEK))\r\n      AND event_date > FORMAT_DATE("%Y%m%d", DATE_SUB(DATE_TRUNC(CURRENT_DATE(), WEEK), INTERVAL 1 WEEK))\r\n      and event_timestamp = user_first_touch_timestamp\r\ngroup by geo.country,app_info.id),\r\n\r\nprevious_week_users as\r\n(\r\nselect geo.country as country, app_info.id, count(distinct user_pseudo_id) prev_week_users\r\nFROM {{ ref(\'events\') }}\r\nWHERE event_date <= FORMAT_DATE("%Y%m%d", DATE_SUB(DATE_TRUNC(CURRENT_DATE(), WEEK), INTERVAL 1 WEEK))\r\n      AND event_date > FORMAT_DATE("%Y%m%d", DATE_SUB(DATE_TRUNC(CURRENT_DATE(), WEEK), INTERVAL 2 WEEK))\r\n      and event_timestamp = user_first_touch_timestamp\r\ngroup by geo.country, app_info.id)\r\n\r\n\r\nselect lwu.country, struct(lwu.id) as app_info, ynu.yesterday_new_users, pdnu.prev_day_new_users, tdnu.three_day_ago_new_users ,lwu.last_week_users, pwu.prev_week_users\r\nfrom last_week_users lwu\r\nleft join yesterday_new_users ynu\r\non lwu.country = ynu.country\r\nand lwu.id = ynu.id\r\nleft join prev_day_new_users pdnu\r\non lwu.country = pdnu.country\r\nand lwu.id = pdnu.id\r\nleft join three_day_ago_new_users tdnu\r\non lwu.country = tdnu.country\r\nand lwu.id = tdnu.id\r\nleft join previous_week_users pwu\r\non lwu.country = pwu.country\r\nand lwu.id = pwu.id\nlimit 100', 'compiled_sql': 'with yesterday_new_users as \n(\nselect geo.country as country, app_info.id, count(distinct user_pseudo_id) yesterday_new_users\nFROM `bamboodata-project`.`dbt_hdumon`.`events`\nWHERE event_date = FORMAT_DATE("%Y%m%d", DATE_SUB(CURRENT_DATE(), INTERVAL 1 DAY))\n      and event_timestamp = user_first_touch_timestamp\ngroup by geo.country, app_info.id\n),\n\nprev_day_new_users as\n(\nselect geo.country as country, app_info.id, count(distinct user_pseudo_id) prev_day_new_users\nFROM `bamboodata-project`.`dbt_hdumon`.`events`\nWHERE event_date = FORMAT_DATE("%Y%m%d", DATE_SUB(CURRENT_DATE(), INTERVAL 2 DAY))\n      and event_timestamp = user_first_touch_timestamp\ngroup by geo.country, app_info.id\n),\n\nthree_day_ago_new_users as\n(\nselect geo.country as country, app_info.id, count(distinct user_pseudo_id) three_day_ago_new_users\nFROM `bamboodata-project`.`dbt_hdumon`.`events`\nWHERE event_date = FORMAT_DATE("%Y%m%d", DATE_SUB(CURRENT_DATE(), INTERVAL 3 DAY))\n      and event_timestamp = user_first_touch_timestamp\ngroup by geo.country, app_info.id\n),\n\nlast_week_users as\n(\nselect geo.country as country, app_info.id, count(distinct user_pseudo_id) last_week_users\nFROM `bamboodata-project`.`dbt_hdumon`.`events`\nWHERE event_date <= FORMAT_DATE("%Y%m%d", DATE_TRUNC(CURRENT_DATE(), WEEK))\n      AND event_date > FORMAT_DATE("%Y%m%d", DATE_SUB(DATE_TRUNC(CURRENT_DATE(), WEEK), INTERVAL 1 WEEK))\n      and event_timestamp = user_first_touch_timestamp\ngroup by geo.country,app_info.id),\n\nprevious_week_users as\n(\nselect geo.country as country, app_info.id, count(distinct user_pseudo_id) prev_week_users\nFROM `bamboodata-project`.`dbt_hdumon`.`events`\nWHERE event_date <= FORMAT_DATE("%Y%m%d", DATE_SUB(DATE_TRUNC(CURRENT_DATE(), WEEK), INTERVAL 1 WEEK))\n      AND event_date > FORMAT_DATE("%Y%m%d", DATE_SUB(DATE_TRUNC(CURRENT_DATE(), WEEK), INTERVAL 2 WEEK))\n      and event_timestamp = user_first_touch_timestamp\ngroup by geo.country, app_info.id)\n\n\nselect lwu.country, struct(lwu.id) as app_info, ynu.yesterday_new_users, pdnu.prev_day_new_users, tdnu.three_day_ago_new_users ,lwu.last_week_users, pwu.prev_week_users\nfrom last_week_users lwu\nleft join yesterday_new_users ynu\non lwu.country = ynu.country\nand lwu.id = ynu.id\nleft join prev_day_new_users pdnu\non lwu.country = pdnu.country\nand lwu.id = pdnu.id\nleft join three_day_ago_new_users tdnu\non lwu.country = tdnu.country\nand lwu.id = tdnu.id\nleft join previous_week_users pwu\non lwu.country = pwu.country\nand lwu.id = pwu.id\nlimit 100', 'tags': None}, None)
Traceback (most recent call last):
  File "/usr/local/lib/python3.6/dist-packages/dbt/task/rpc/sql_commands.py", line 165, in _in_thread
    self.node_results.append(runner.safe_run(self.manifest))
  File "/usr/local/lib/python3.6/dist-packages/dbt/node_runners.py", line 244, in safe_run
    result = self.error_result(ctx.node, error, started, [])
  File "/usr/local/lib/python3.6/dist-packages/dbt/rpc/node_runners.py", line 53, in error_result
    raise error
dbt.rpc.error.RPCException: RPCException(10001, Runtime error, {'type': 'RuntimeException', 'message': 'Runtime Error in rpc request (from remote system)\n  404 Not found: Dataset bamboodata-project:dbt_hdumon was not found in location US\n  \n  (job ID: 08820a71-1c4e-4773-b50d-24a17bd3a841)', 'raw_sql': 'with yesterday_new_users as \r\n(\r\nselect geo.country as country, app_info.id, count(distinct user_pseudo_id) yesterday_new_users\r\nFROM {{ ref(\'events\') }}\r\nWHERE event_date = FORMAT_DATE("%Y%m%d", DATE_SUB(CURRENT_DATE(), INTERVAL 1 DAY))\r\n      and event_timestamp = user_first_touch_timestamp\r\ngroup by geo.country, app_info.id\r\n),\r\n\r\nprev_day_new_users as\r\n(\r\nselect geo.country as country, app_info.id, count(distinct user_pseudo_id) prev_day_new_users\r\nFROM {{ ref(\'events\') }}\r\nWHERE event_date = FORMAT_DATE("%Y%m%d", DATE_SUB(CURRENT_DATE(), INTERVAL 2 DAY))\r\n      and event_timestamp = user_first_touch_timestamp\r\ngroup by geo.country, app_info.id\r\n),\r\n\r\nthree_day_ago_new_users as\r\n(\r\nselect geo.country as country, app_info.id, count(distinct user_pseudo_id) three_day_ago_new_users\r\nFROM {{ ref(\'events\') }}\r\nWHERE event_date = FORMAT_DATE("%Y%m%d", DATE_SUB(CURRENT_DATE(), INTERVAL 3 DAY))\r\n      and event_timestamp = user_first_touch_timestamp\r\ngroup by geo.country, app_info.id\r\n),\r\n\r\nlast_week_users as\r\n(\r\nselect geo.country as country, app_info.id, count(distinct user_pseudo_id) last_week_users\r\nFROM {{ ref(\'events\') }}\r\nWHERE event_date <= FORMAT_DATE("%Y%m%d", DATE_TRUNC(CURRENT_DATE(), WEEK))\r\n      AND event_date > FORMAT_DATE("%Y%m%d", DATE_SUB(DATE_TRUNC(CURRENT_DATE(), WEEK), INTERVAL 1 WEEK))\r\n      and event_timestamp = user_first_touch_timestamp\r\ngroup by geo.country,app_info.id),\r\n\r\nprevious_week_users as\r\n(\r\nselect geo.country as country, app_info.id, count(distinct user_pseudo_id) prev_week_users\r\nFROM {{ ref(\'events\') }}\r\nWHERE event_date <= FORMAT_DATE("%Y%m%d", DATE_SUB(DATE_TRUNC(CURRENT_DATE(), WEEK), INTERVAL 1 WEEK))\r\n      AND event_date > FORMAT_DATE("%Y%m%d", DATE_SUB(DATE_TRUNC(CURRENT_DATE(), WEEK), INTERVAL 2 WEEK))\r\n      and event_timestamp = user_first_touch_timestamp\r\ngroup by geo.country, app_info.id)\r\n\r\n\r\nselect lwu.country, struct(lwu.id) as app_info, ynu.yesterday_new_users, pdnu.prev_day_new_users, tdnu.three_day_ago_new_users ,lwu.last_week_users, pwu.prev_week_users\r\nfrom last_week_users lwu\r\nleft join yesterday_new_users ynu\r\non lwu.country = ynu.country\r\nand lwu.id = ynu.id\r\nleft join prev_day_new_users pdnu\r\non lwu.country = pdnu.country\r\nand lwu.id = pdnu.id\r\nleft join three_day_ago_new_users tdnu\r\non lwu.country = tdnu.country\r\nand lwu.id = tdnu.id\r\nleft join previous_week_users pwu\r\non lwu.country = pwu.country\r\nand lwu.id = pwu.id\nlimit 100', 'compiled_sql': 'with yesterday_new_users as \n(\nselect geo.country as country, app_info.id, count(distinct user_pseudo_id) yesterday_new_users\nFROM `bamboodata-project`.`dbt_hdumon`.`events`\nWHERE event_date = FORMAT_DATE("%Y%m%d", DATE_SUB(CURRENT_DATE(), INTERVAL 1 DAY))\n      and event_timestamp = user_first_touch_timestamp\ngroup by geo.country, app_info.id\n),\n\nprev_day_new_users as\n(\nselect geo.country as country, app_info.id, count(distinct user_pseudo_id) prev_day_new_users\nFROM `bamboodata-project`.`dbt_hdumon`.`events`\nWHERE event_date = FORMAT_DATE("%Y%m%d", DATE_SUB(CURRENT_DATE(), INTERVAL 2 DAY))\n      and event_timestamp = user_first_touch_timestamp\ngroup by geo.country, app_info.id\n),\n\nthree_day_ago_new_users as\n(\nselect geo.country as country, app_info.id, count(distinct user_pseudo_id) three_day_ago_new_users\nFROM `bamboodata-project`.`dbt_hdumon`.`events`\nWHERE event_date = FORMAT_DATE("%Y%m%d", DATE_SUB(CURRENT_DATE(), INTERVAL 3 DAY))\n      and event_timestamp = user_first_touch_timestamp\ngroup by geo.country, app_info.id\n),\n\nlast_week_users as\n(\nselect geo.country as country, app_info.id, count(distinct user_pseudo_id) last_week_users\nFROM `bamboodata-project`.`dbt_hdumon`.`events`\nWHERE event_date <= FORMAT_DATE("%Y%m%d", DATE_TRUNC(CURRENT_DATE(), WEEK))\n      AND event_date > FORMAT_DATE("%Y%m%d", DATE_SUB(DATE_TRUNC(CURRENT_DATE(), WEEK), INTERVAL 1 WEEK))\n      and event_timestamp = user_first_touch_timestamp\ngroup by geo.country,app_info.id),\n\nprevious_week_users as\n(\nselect geo.country as country, app_info.id, count(distinct user_pseudo_id) prev_week_users\nFROM `bamboodata-project`.`dbt_hdumon`.`events`\nWHERE event_date <= FORMAT_DATE("%Y%m%d", DATE_SUB(DATE_TRUNC(CURRENT_DATE(), WEEK), INTERVAL 1 WEEK))\n      AND event_date > FORMAT_DATE("%Y%m%d", DATE_SUB(DATE_TRUNC(CURRENT_DATE(), WEEK), INTERVAL 2 WEEK))\n      and event_timestamp = user_first_touch_timestamp\ngroup by geo.country, app_info.id)\n\n\nselect lwu.country, struct(lwu.id) as app_info, ynu.yesterday_new_users, pdnu.prev_day_new_users, tdnu.three_day_ago_new_users ,lwu.last_week_users, pwu.prev_week_users\nfrom last_week_users lwu\nleft join yesterday_new_users ynu\non lwu.country = ynu.country\nand lwu.id = ynu.id\nleft join prev_day_new_users pdnu\non lwu.country = pdnu.country\nand lwu.id = pdnu.id\nleft join three_day_ago_new_users tdnu\non lwu.country = tdnu.country\nand lwu.id = tdnu.id\nleft join previous_week_users pwu\non lwu.country = pwu.country\nand lwu.id = pwu.id\nlimit 100', 'tags': None}, None)
2020-09-27 15:20:59.193285 (Thread-48): handling poll request
2020-09-27 15:20:59.193773 (Thread-48): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '27e7380c-b0a4-40fa-a943-feae0a06616b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa5075bdc18>]}
2020-09-27 15:20:59.195460 (Thread-48): sending response (<Response 32745 bytes [200 OK]>) to 10.0.18.102
2020-09-27 15:24:43.710029 (Thread-49): handling ps request
2020-09-27 15:24:43.710537 (Thread-49): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '27e7380c-b0a4-40fa-a943-feae0a06616b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa5073f86a0>]}
2020-09-27 15:24:43.713884 (Thread-49): sending response (<Response 2301 bytes [200 OK]>) to 10.0.24.187
2020-09-27 15:24:43.781849 (Thread-50): handling status request
2020-09-27 15:24:43.782340 (Thread-50): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '27e7380c-b0a4-40fa-a943-feae0a06616b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa5073f8550>]}
2020-09-27 15:24:43.783592 (Thread-50): sending response (<Response 1448 bytes [200 OK]>) to 10.0.36.169
2020-09-27 15:24:44.189726 (Thread-51): handling poll request
2020-09-27 15:24:44.190209 (Thread-51): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '27e7380c-b0a4-40fa-a943-feae0a06616b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa5067120b8>]}
2020-09-27 15:24:44.195037 (Thread-51): sending response (<Response 11095 bytes [200 OK]>) to 10.0.36.169
2020-09-27 15:24:44.643557 (Thread-52): handling status request
2020-09-27 15:24:44.644214 (Thread-52): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '27e7380c-b0a4-40fa-a943-feae0a06616b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa506725a90>]}
2020-09-27 15:24:44.645880 (Thread-52): sending response (<Response 1448 bytes [200 OK]>) to 10.0.12.156
2020-09-27 15:27:41.445480 (MainThread): Running with dbt=0.17.2
2020-09-27 15:27:41.702263 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.rpc.server.RPCServerTask'>, debug=False, exclude=None, host='0.0.0.0', log_cache_events=False, log_format='default', models=None, partial_parse=True, port=8580, profile='user', profiles_dir='/usr/src/develop/.dbt', project_dir=None, record_timing_info=None, rpc_method=None, single_threaded=False, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, vars='{}', version_check=True, warn_error=False, which='rpc', write_json=True)
2020-09-27 15:27:41.716671 (MainThread): Tracking: tracking
2020-09-27 15:27:41.726423 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1498ff2e80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f14987b4240>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f14987b4b38>]}
2020-09-27 15:27:41.726833 (MainThread): Serving RPC server at 0.0.0.0:8580, pid=13
2020-09-27 15:27:41.727270 (MainThread): Supported methods: ['cli_args', 'compile', 'compile_sql', 'deps', 'docs.generate', 'gc', 'get-manifest', 'kill', 'poll', 'ps', 'run', 'run-operation', 'run_sql', 'seed', 'snapshot', 'snapshot-freshness', 'status', 'test']
2020-09-27 15:27:41.727587 (MainThread): Send requests to http://localhost:8580/jsonrpc
2020-09-27 15:27:41.731363 (Thread-1): Parsing macros/core.sql
2020-09-27 15:27:41.736121 (Thread-1): Parsing macros/materializations/helpers.sql
2020-09-27 15:27:41.744422 (Thread-1): Parsing macros/materializations/common/merge.sql
2020-09-27 15:27:41.758955 (Thread-1): Parsing macros/materializations/table/table.sql
2020-09-27 15:27:41.766037 (Thread-1): Parsing macros/materializations/view/create_or_replace_view.sql
2020-09-27 15:27:41.771077 (Thread-1): Parsing macros/materializations/view/view.sql
2020-09-27 15:27:41.779350 (Thread-1): Parsing macros/materializations/snapshot/snapshot.sql
2020-09-27 15:27:41.808858 (Thread-1): Parsing macros/materializations/snapshot/strategies.sql
2020-09-27 15:27:41.825939 (Thread-1): Parsing macros/materializations/snapshot/snapshot_merge.sql
2020-09-27 15:27:41.827786 (Thread-1): Parsing macros/materializations/seed/seed.sql
2020-09-27 15:27:41.850298 (Thread-1): Parsing macros/materializations/incremental/incremental.sql
2020-09-27 15:27:41.856753 (Thread-1): Parsing macros/materializations/incremental/helpers.sql
2020-09-27 15:27:41.858767 (Thread-1): Parsing macros/etc/query.sql
2020-09-27 15:27:41.859886 (Thread-1): Parsing macros/etc/get_custom_schema.sql
2020-09-27 15:27:41.862102 (Thread-1): Parsing macros/etc/get_custom_alias.sql
2020-09-27 15:27:41.863253 (Thread-1): Parsing macros/etc/datetime.sql
2020-09-27 15:27:41.873074 (Thread-1): Parsing macros/etc/get_custom_database.sql
2020-09-27 15:27:41.874859 (Thread-1): Parsing macros/etc/is_incremental.sql
2020-09-27 15:27:41.876660 (Thread-1): Parsing macros/adapters/common.sql
2020-09-27 15:27:41.928780 (Thread-1): Parsing macros/schema_tests/relationships.sql
2020-09-27 15:27:41.930308 (Thread-1): Parsing macros/schema_tests/unique.sql
2020-09-27 15:27:41.935467 (Thread-1): Parsing macros/schema_tests/accepted_values.sql
2020-09-27 15:27:41.937669 (Thread-1): Parsing macros/schema_tests/not_null.sql
2020-09-27 15:27:41.938978 (Thread-1): Parsing macros/adapters.sql
2020-09-27 15:27:41.955875 (Thread-1): Parsing macros/catalog.sql
2020-09-27 15:27:41.961926 (Thread-1): Parsing macros/etc.sql
2020-09-27 15:27:41.962654 (Thread-1): Parsing macros/materializations/incremental.sql
2020-09-27 15:27:41.976236 (Thread-1): Parsing macros/materializations/snapshot.sql
2020-09-27 15:27:41.978247 (Thread-1): Parsing macros/materializations/seed.sql
2020-09-27 15:27:41.981034 (Thread-1): Parsing macros/materializations/table.sql
2020-09-27 15:27:41.991344 (Thread-1): Parsing macros/materializations/view.sql
2020-09-27 15:27:42.067857 (Thread-1): Acquiring new bigquery connection "model.bamboodata.bbd_country_user_progress".
2020-09-27 15:27:42.068019 (Thread-1): Opening a new connection, currently in state init
2020-09-27 15:27:42.099837 (Thread-1): Acquiring new bigquery connection "model.bamboodata.events".
2020-09-27 15:27:42.099982 (Thread-1): Opening a new connection, currently in state closed
2020-09-27 15:27:42.250608 (Thread-1): WARNING: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.base
- models.output

2020-09-27 15:27:45.169978 (Thread-2): handling status request
2020-09-27 15:27:45.172481 (Thread-2): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'a48143b7-69f2-44ce-9c93-64a5ba3d81a4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1498568e10>]}
2020-09-27 15:27:45.177831 (Thread-2): sending response (<Response 10200 bytes [200 OK]>) to 10.0.5.150
2020-09-27 15:28:12.939488 (MainThread): writing 1 spans (enabled:True), 82 additional messages skipped
2020-09-27 15:28:12.941234 (MainThread): 
      name jinja2.compile
        id 17933030129895874069
  trace_id 9824891995249550546
 parent_id None
   service None
  resource <memory>
      type template
     start 1601220492.938764
       end 1601220492.9393
  duration 0.000536s
     error 0
      tags 
           jinja2.template_name:<memory>
           runtime-id:8671c46a3c914bbfa95f40976d37c7bc, 114 additional messages skipped
2020-09-27 15:28:12.982156 (AgentWriter): reported 7 traces in 0.03286s, 2 additional messages skipped
2020-09-27 15:28:12.988321 (AgentWriter): initialized RateSampler, sample 100% of traces, 95 additional messages skipped
2020-09-27 15:28:13.008652 (Thread-3): Got an acceptable cached parse result
2020-09-27 15:28:13.045683 (Thread-3): Acquiring new bigquery connection "model.bamboodata.bbd_country_user_progress".
2020-09-27 15:28:13.045816 (Thread-3): Opening a new connection, currently in state closed
2020-09-27 15:28:13.202897 (Thread-3): WARNING: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.base
- models.output

2020-09-27 15:28:13.374343 (Thread-4): handling status request
2020-09-27 15:28:13.374822 (Thread-4): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'a48143b7-69f2-44ce-9c93-64a5ba3d81a4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f14986977f0>]}
2020-09-27 15:28:13.376033 (Thread-4): sending response (<Response 1463 bytes [200 OK]>) to 10.0.3.121
2020-09-27 15:28:22.919275 (Thread-5): Got an acceptable cached parse result
2020-09-27 15:28:22.960937 (Thread-5): Acquiring new bigquery connection "model.bamboodata.events".
2020-09-27 15:28:22.961088 (Thread-5): Opening a new connection, currently in state closed
2020-09-27 15:28:23.219733 (Thread-5): WARNING: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.base
- models.output

2020-09-27 15:28:23.353553 (Thread-6): handling status request
2020-09-27 15:28:23.354033 (Thread-6): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'a48143b7-69f2-44ce-9c93-64a5ba3d81a4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f14987e3b38>]}
2020-09-27 15:28:23.355259 (Thread-6): sending response (<Response 1444 bytes [200 OK]>) to 10.0.36.169
2020-09-27 15:28:25.508312 (Thread-7): handling status request
2020-09-27 15:28:25.508802 (Thread-7): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'a48143b7-69f2-44ce-9c93-64a5ba3d81a4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f14982fe898>]}
2020-09-27 15:28:25.510030 (Thread-7): sending response (<Response 1444 bytes [200 OK]>) to 10.0.44.9
2020-09-27 15:28:25.938303 (Thread-8): handling run_sql request
2020-09-27 15:28:25.938786 (Thread-8): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'a48143b7-69f2-44ce-9c93-64a5ba3d81a4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f14984fcc88>]}
2020-09-27 15:28:25.942262 (Thread-8): Connection 'model.bamboodata.events' was properly closed.
2020-09-27 15:28:26.876208 (Thread-8): sending response (<Response 137 bytes [200 OK]>) to 10.0.2.56
2020-09-27 15:28:26.897442 (MainThread): Acquiring new bigquery connection "rpc.bamboodata.request".
2020-09-27 15:28:26.897863 (MainThread): Opening a new connection, currently in state init
2020-09-27 15:28:26.924346 (MainThread): Found 2 models, 0 tests, 0 snapshots, 0 analyses, 147 macros, 0 operations, 0 seed files, 0 sources
2020-09-27 15:28:26.925038 (Thread-1): Acquiring new bigquery connection "rpc.bamboodata.request".
2020-09-27 15:28:26.925180 (Thread-1): Opening a new connection, currently in state init
2020-09-27 15:28:26.925267 (Thread-1): Compiling rpc.bamboodata.request
2020-09-27 15:28:26.938932 (Thread-1): finished collecting timing info
2020-09-27 15:28:26.939758 (Thread-1): On rpc.bamboodata.request: SELECT format_date( "%Y%m%d" ,date_add(PARSE_DATE("%Y%m%d",event_date), interval (select date_diff(current_date, PARSE_DATE("%Y%m%d",max(event_date)),day) FROM `bamboodata-project.analytics_220006363.events_an_purchases`) day)) event_date, 
       event_timestamp + (select date_diff(current_date, PARSE_DATE("%Y%m%d",max(event_date)),day) FROM `bamboodata-project.analytics_220006363.events_an_purchases`) * 3600*24*1000000 as event_timestamp,
       user_first_touch_timestamp + (select date_diff(current_date, PARSE_DATE("%Y%m%d",max(event_date)),day) FROM `bamboodata-project.analytics_220006363.events_an_purchases`) * 3600*24*1000000 as user_first_touch_timestamp,

* EXCEPT(event_date, event_timestamp, user_first_touch_timestamp)
FROM `bamboodata-project.events_an_purchases`
order by event_timestamp desc


limit 100
2020-09-27 15:28:27.196546 (Thread-9): handling poll request
2020-09-27 15:28:27.197078 (Thread-9): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'a48143b7-69f2-44ce-9c93-64a5ba3d81a4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f14987e3b38>]}
2020-09-27 15:28:27.200945 (Thread-9): sending response (<Response 3643 bytes [200 OK]>) to 10.0.38.179
2020-09-27 15:28:27.632315 (Thread-1): Unhandled error while running:
SELECT format_date( "%Y%m%d" ,date_add(PARSE_DATE("%Y%m%d",event_date), interval (select date_diff(current_date, PARSE_DATE("%Y%m%d",max(event_date)),day) FROM `bamboodata-project.analytics_220006363.events_an_purchases`) day)) event_date, 
       event_timestamp + (select date_diff(current_date, PARSE_DATE("%Y%m%d",max(event_date)),day) FROM `bamboodata-project.analytics_220006363.events_an_purchases`) * 3600*24*1000000 as event_timestamp,
       user_first_touch_timestamp + (select date_diff(current_date, PARSE_DATE("%Y%m%d",max(event_date)),day) FROM `bamboodata-project.analytics_220006363.events_an_purchases`) * 3600*24*1000000 as user_first_touch_timestamp,

* EXCEPT(event_date, event_timestamp, user_first_touch_timestamp)
FROM `bamboodata-project.events_an_purchases`
order by event_timestamp desc


limit 100
2020-09-27 15:28:27.632552 (Thread-1): finished collecting timing info
2020-09-27 15:28:27.632900 (Thread-1): Got an exception: Runtime Error
  404 Not found: Dataset bamboodata-project:bamboodata-project was not found in location US
  
  (job ID: 1d6f1cc2-9ef5-4bc4-a30f-db06783694d7)
Traceback (most recent call last):
  File "/usr/local/lib/python3.6/dist-packages/dbt/adapters/bigquery/connections.py", line 85, in exception_handler
    yield
  File "/usr/local/lib/python3.6/dist-packages/dbt/adapters/bigquery/connections.py", line 364, in _retry_and_handle
    deadline=None)
  File "/usr/local/lib/python3.6/dist-packages/google/api_core/retry.py", line 184, in retry_target
    return target()
  File "/usr/local/lib/python3.6/dist-packages/dbt/adapters/bigquery/connections.py", line 226, in fn
    return self._query_and_results(client, sql, conn, job_params)
  File "/usr/local/lib/python3.6/dist-packages/dbt/adapters/bigquery/connections.py", line 353, in _query_and_results
    iterator = query_job.result(timeout=timeout)
  File "/usr/local/lib/python3.6/dist-packages/google/cloud/bigquery/job.py", line 3196, in result
    super(QueryJob, self).result(retry=retry, timeout=timeout)
  File "/usr/local/lib/python3.6/dist-packages/google/cloud/bigquery/job.py", line 818, in result
    return super(_AsyncJob, self).result(timeout=timeout)
  File "/usr/local/lib/python3.6/dist-packages/google/api_core/future/polling.py", line 130, in result
    raise self._exception
google.api_core.exceptions.NotFound: 404 Not found: Dataset bamboodata-project:bamboodata-project was not found in location US

(job ID: 1d6f1cc2-9ef5-4bc4-a30f-db06783694d7)

                                                                                                           -----Query Job SQL Follows-----                                                                                                           

    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |
   1:SELECT format_date( "%Y%m%d" ,date_add(PARSE_DATE("%Y%m%d",event_date), interval (select date_diff(current_date, PARSE_DATE("%Y%m%d",max(event_date)),day) FROM `bamboodata-project.analytics_220006363.events_an_purchases`) day)) event_date, 
   2:       event_timestamp + (select date_diff(current_date, PARSE_DATE("%Y%m%d",max(event_date)),day) FROM `bamboodata-project.analytics_220006363.events_an_purchases`) * 3600*24*1000000 as event_timestamp,
   3:       user_first_touch_timestamp + (select date_diff(current_date, PARSE_DATE("%Y%m%d",max(event_date)),day) FROM `bamboodata-project.analytics_220006363.events_an_purchases`) * 3600*24*1000000 as user_first_touch_timestamp,
   4:
   5:* EXCEPT(event_date, event_timestamp, user_first_touch_timestamp)
   6:FROM `bamboodata-project.events_an_purchases`
   7:order by event_timestamp desc
   8:
   9:
  10:limit 100
    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/usr/local/lib/python3.6/dist-packages/dbt/node_runners.py", line 228, in safe_run
    result = self.compile_and_execute(manifest, ctx)
  File "/usr/local/lib/python3.6/dist-packages/dbt/node_runners.py", line 171, in compile_and_execute
    result = self.run(ctx.node, manifest)
  File "/usr/local/lib/python3.6/dist-packages/dbt/node_runners.py", line 273, in run
    return self.execute(compiled_node, manifest)
  File "/usr/local/lib/python3.6/dist-packages/dbt/rpc/node_runners.py", line 86, in execute
    compiled_node.injected_sql, fetch=True
  File "/usr/local/lib/python3.6/dist-packages/dbt/adapters/base/impl.py", line 228, in execute
    fetch=fetch
  File "/usr/local/lib/python3.6/dist-packages/dbt/adapters/bigquery/connections.py", line 235, in execute
    query_job, iterator = self.raw_execute(sql, fetch=fetch)
  File "/usr/local/lib/python3.6/dist-packages/dbt/adapters/bigquery/connections.py", line 228, in raw_execute
    query_job, iterator = self._retry_and_handle(msg=sql, conn=conn, fn=fn)
  File "/usr/local/lib/python3.6/dist-packages/dbt/adapters/bigquery/connections.py", line 364, in _retry_and_handle
    deadline=None)
  File "/usr/lib/python3.6/contextlib.py", line 99, in __exit__
    self.gen.throw(type, value, traceback)
  File "/usr/local/lib/python3.6/dist-packages/dbt/adapters/bigquery/connections.py", line 108, in exception_handler
    raise RuntimeException(exc_message)
dbt.exceptions.RuntimeException: Runtime Error
  404 Not found: Dataset bamboodata-project:bamboodata-project was not found in location US
  
  (job ID: 1d6f1cc2-9ef5-4bc4-a30f-db06783694d7)
2020-09-27 15:28:27.635731 (Thread-1): Got exception RPCException(10001, Runtime error, {'type': 'RuntimeException', 'message': 'Runtime Error in rpc request (from remote system)\n  404 Not found: Dataset bamboodata-project:bamboodata-project was not found in location US\n  \n  (job ID: 1d6f1cc2-9ef5-4bc4-a30f-db06783694d7)', 'raw_sql': 'SELECT format_date( "%Y%m%d" ,date_add(PARSE_DATE("%Y%m%d",event_date), interval (select date_diff(current_date, PARSE_DATE("%Y%m%d",max(event_date)),day) FROM `bamboodata-project.analytics_220006363.events_an_purchases`) day)) event_date, \r\n       event_timestamp + (select date_diff(current_date, PARSE_DATE("%Y%m%d",max(event_date)),day) FROM `bamboodata-project.analytics_220006363.events_an_purchases`) * 3600*24*1000000 as event_timestamp,\r\n       user_first_touch_timestamp + (select date_diff(current_date, PARSE_DATE("%Y%m%d",max(event_date)),day) FROM `bamboodata-project.analytics_220006363.events_an_purchases`) * 3600*24*1000000 as user_first_touch_timestamp,\r\n\r\n* EXCEPT(event_date, event_timestamp, user_first_touch_timestamp)\r\nFROM `{{target.project}}.events_an_purchases`\r\norder by event_timestamp desc\r\n\r\n\nlimit 100', 'compiled_sql': 'SELECT format_date( "%Y%m%d" ,date_add(PARSE_DATE("%Y%m%d",event_date), interval (select date_diff(current_date, PARSE_DATE("%Y%m%d",max(event_date)),day) FROM `bamboodata-project.analytics_220006363.events_an_purchases`) day)) event_date, \n       event_timestamp + (select date_diff(current_date, PARSE_DATE("%Y%m%d",max(event_date)),day) FROM `bamboodata-project.analytics_220006363.events_an_purchases`) * 3600*24*1000000 as event_timestamp,\n       user_first_touch_timestamp + (select date_diff(current_date, PARSE_DATE("%Y%m%d",max(event_date)),day) FROM `bamboodata-project.analytics_220006363.events_an_purchases`) * 3600*24*1000000 as user_first_touch_timestamp,\n\n* EXCEPT(event_date, event_timestamp, user_first_touch_timestamp)\nFROM `bamboodata-project.events_an_purchases`\norder by event_timestamp desc\n\n\nlimit 100', 'tags': None}, None)
Traceback (most recent call last):
  File "/usr/local/lib/python3.6/dist-packages/dbt/task/rpc/sql_commands.py", line 165, in _in_thread
    self.node_results.append(runner.safe_run(self.manifest))
  File "/usr/local/lib/python3.6/dist-packages/dbt/node_runners.py", line 244, in safe_run
    result = self.error_result(ctx.node, error, started, [])
  File "/usr/local/lib/python3.6/dist-packages/dbt/rpc/node_runners.py", line 53, in error_result
    raise error
dbt.rpc.error.RPCException: RPCException(10001, Runtime error, {'type': 'RuntimeException', 'message': 'Runtime Error in rpc request (from remote system)\n  404 Not found: Dataset bamboodata-project:bamboodata-project was not found in location US\n  \n  (job ID: 1d6f1cc2-9ef5-4bc4-a30f-db06783694d7)', 'raw_sql': 'SELECT format_date( "%Y%m%d" ,date_add(PARSE_DATE("%Y%m%d",event_date), interval (select date_diff(current_date, PARSE_DATE("%Y%m%d",max(event_date)),day) FROM `bamboodata-project.analytics_220006363.events_an_purchases`) day)) event_date, \r\n       event_timestamp + (select date_diff(current_date, PARSE_DATE("%Y%m%d",max(event_date)),day) FROM `bamboodata-project.analytics_220006363.events_an_purchases`) * 3600*24*1000000 as event_timestamp,\r\n       user_first_touch_timestamp + (select date_diff(current_date, PARSE_DATE("%Y%m%d",max(event_date)),day) FROM `bamboodata-project.analytics_220006363.events_an_purchases`) * 3600*24*1000000 as user_first_touch_timestamp,\r\n\r\n* EXCEPT(event_date, event_timestamp, user_first_touch_timestamp)\r\nFROM `{{target.project}}.events_an_purchases`\r\norder by event_timestamp desc\r\n\r\n\nlimit 100', 'compiled_sql': 'SELECT format_date( "%Y%m%d" ,date_add(PARSE_DATE("%Y%m%d",event_date), interval (select date_diff(current_date, PARSE_DATE("%Y%m%d",max(event_date)),day) FROM `bamboodata-project.analytics_220006363.events_an_purchases`) day)) event_date, \n       event_timestamp + (select date_diff(current_date, PARSE_DATE("%Y%m%d",max(event_date)),day) FROM `bamboodata-project.analytics_220006363.events_an_purchases`) * 3600*24*1000000 as event_timestamp,\n       user_first_touch_timestamp + (select date_diff(current_date, PARSE_DATE("%Y%m%d",max(event_date)),day) FROM `bamboodata-project.analytics_220006363.events_an_purchases`) * 3600*24*1000000 as user_first_touch_timestamp,\n\n* EXCEPT(event_date, event_timestamp, user_first_touch_timestamp)\nFROM `bamboodata-project.events_an_purchases`\norder by event_timestamp desc\n\n\nlimit 100', 'tags': None}, None)
2020-09-27 15:28:28.617241 (Thread-10): handling poll request
2020-09-27 15:28:28.617770 (Thread-10): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'a48143b7-69f2-44ce-9c93-64a5ba3d81a4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f149843b1d0>]}
2020-09-27 15:28:28.619011 (Thread-10): sending response (<Response 17019 bytes [200 OK]>) to 10.0.27.68
2020-09-27 15:30:03.332164 (MainThread): writing 1 spans (enabled:True), 73 additional messages skipped
2020-09-27 15:30:03.333500 (MainThread): 
      name jinja2.compile
        id 11941143881506813144
  trace_id 16799747893737043812
 parent_id None
   service None
  resource <memory>
      type template
     start 1601220603.3311381
       end 1601220603.331916
  duration 0.000778s
     error 0
      tags 
           jinja2.template_name:<memory>
           runtime-id:8671c46a3c914bbfa95f40976d37c7bc, 73 additional messages skipped
2020-09-27 15:30:03.401377 (Thread-11): Got an acceptable cached parse result
2020-09-27 15:30:03.443718 (Thread-11): Acquiring new bigquery connection "model.bamboodata.events".
2020-09-27 15:30:03.443871 (Thread-11): Opening a new connection, currently in state init
2020-09-27 15:30:03.602536 (Thread-11): WARNING: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.base
- models.output

2020-09-27 15:30:04.106484 (Thread-12): handling status request
2020-09-27 15:30:04.106966 (Thread-12): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'a48143b7-69f2-44ce-9c93-64a5ba3d81a4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f14986729b0>]}
2020-09-27 15:30:04.108188 (Thread-12): sending response (<Response 1446 bytes [200 OK]>) to 10.0.38.179
2020-09-27 15:30:04.122452 (AgentWriter): reported 38 traces in 0.00513s, 2 additional messages skipped
2020-09-27 15:30:04.122674 (AgentWriter): initialized RateSampler, sample 100% of traces, 95 additional messages skipped
2020-09-27 15:30:04.519345 (Thread-13): handling status request
2020-09-27 15:30:04.519825 (Thread-13): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'a48143b7-69f2-44ce-9c93-64a5ba3d81a4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f14987b49b0>]}
2020-09-27 15:30:04.521033 (Thread-13): sending response (<Response 1446 bytes [200 OK]>) to 10.0.3.121
2020-09-27 15:30:04.840923 (Thread-14): handling run_sql request
2020-09-27 15:30:04.841442 (Thread-14): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'a48143b7-69f2-44ce-9c93-64a5ba3d81a4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1498356da0>]}
2020-09-27 15:30:04.842807 (Thread-14): Connection 'model.bamboodata.events' was properly closed.
2020-09-27 15:30:05.781571 (Thread-14): sending response (<Response 137 bytes [200 OK]>) to 10.0.47.163
2020-09-27 15:30:05.802112 (MainThread): Acquiring new bigquery connection "rpc.bamboodata.request".
2020-09-27 15:30:05.802521 (MainThread): Opening a new connection, currently in state init
2020-09-27 15:30:05.828936 (MainThread): Found 2 models, 0 tests, 0 snapshots, 0 analyses, 147 macros, 0 operations, 0 seed files, 0 sources
2020-09-27 15:30:05.829632 (Thread-1): Acquiring new bigquery connection "rpc.bamboodata.request".
2020-09-27 15:30:05.829731 (Thread-1): Opening a new connection, currently in state init
2020-09-27 15:30:05.829811 (Thread-1): Compiling rpc.bamboodata.request
2020-09-27 15:30:05.843498 (Thread-1): finished collecting timing info
2020-09-27 15:30:05.844301 (Thread-1): On rpc.bamboodata.request: SELECT format_date( "%Y%m%d" ,date_add(PARSE_DATE("%Y%m%d",event_date), interval (select date_diff(current_date, PARSE_DATE("%Y%m%d",max(event_date)),day) FROM `bamboodata-project.analytics_220006363.events_an_purchases`) day)) event_date, 
       event_timestamp + (select date_diff(current_date, PARSE_DATE("%Y%m%d",max(event_date)),day) FROM `bamboodata-project.analytics_220006363.events_an_purchases`) * 3600*24*1000000 as event_timestamp,
       user_first_touch_timestamp + (select date_diff(current_date, PARSE_DATE("%Y%m%d",max(event_date)),day) FROM `bamboodata-project.analytics_220006363.events_an_purchases`) * 3600*24*1000000 as user_first_touch_timestamp,

* EXCEPT(event_date, event_timestamp, user_first_touch_timestamp)
FROM `bamboodata-project.analytics_220006363.events_an_purchases`
order by event_timestamp desc


limit 100
2020-09-27 15:30:06.272042 (Thread-15): handling poll request
2020-09-27 15:30:06.272592 (Thread-15): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'a48143b7-69f2-44ce-9c93-64a5ba3d81a4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f149842e940>]}
2020-09-27 15:30:06.277079 (Thread-15): sending response (<Response 3663 bytes [200 OK]>) to 10.0.17.64
2020-09-27 15:30:07.585968 (Thread-16): handling poll request
2020-09-27 15:30:07.586455 (Thread-16): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'a48143b7-69f2-44ce-9c93-64a5ba3d81a4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1499057748>]}
2020-09-27 15:30:07.587430 (Thread-16): sending response (<Response 384 bytes [200 OK]>) to 10.0.12.102
2020-09-27 15:30:09.046490 (Thread-17): handling poll request
2020-09-27 15:30:09.048322 (Thread-17): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'a48143b7-69f2-44ce-9c93-64a5ba3d81a4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1499057748>]}
2020-09-27 15:30:09.049362 (Thread-17): sending response (<Response 384 bytes [200 OK]>) to 10.0.44.9
2020-09-27 15:30:10.585973 (Thread-18): handling poll request
2020-09-27 15:30:10.586466 (Thread-18): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'a48143b7-69f2-44ce-9c93-64a5ba3d81a4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1498672cf8>]}
2020-09-27 15:30:10.587445 (Thread-18): sending response (<Response 383 bytes [200 OK]>) to 10.0.17.64
2020-09-27 15:30:12.046809 (Thread-19): handling poll request
2020-09-27 15:30:12.047299 (Thread-19): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'a48143b7-69f2-44ce-9c93-64a5ba3d81a4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f14986a85c0>]}
2020-09-27 15:30:12.048261 (Thread-19): sending response (<Response 384 bytes [200 OK]>) to 10.0.38.51
2020-09-27 15:30:12.292544 (Thread-1): finished collecting timing info
2020-09-27 15:30:13.359452 (Thread-20): handling poll request
2020-09-27 15:30:13.359947 (Thread-20): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'a48143b7-69f2-44ce-9c93-64a5ba3d81a4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f14986a85c0>]}
2020-09-27 15:30:13.366828 (Thread-20): sending response (<Response 233658 bytes [200 OK]>) to 10.0.38.51
2020-09-27 15:30:27.230650 (Thread-21): Got an acceptable cached parse result
2020-09-27 15:30:27.428544 (Thread-21): WARNING: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.base
- models.output

2020-09-27 15:30:27.715909 (Thread-22): handling status request
2020-09-27 15:30:27.716388 (Thread-22): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'a48143b7-69f2-44ce-9c93-64a5ba3d81a4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f149846ec18>]}
2020-09-27 15:30:27.717442 (Thread-22): sending response (<Response 873 bytes [200 OK]>) to 10.0.44.9
2020-09-27 15:31:07.507713 (MainThread): writing 1 spans (enabled:True), 73 additional messages skipped
2020-09-27 15:31:07.509364 (MainThread): 
      name jinja2.compile
        id 12200295166038922174
  trace_id 17791096359242539100
 parent_id None
   service None
  resource <memory>
      type template
     start 1601220667.506766
       end 1601220667.5074751
  duration 0.000709s
     error 0
      tags 
           jinja2.template_name:<memory>
           runtime-id:8671c46a3c914bbfa95f40976d37c7bc, 73 additional messages skipped
2020-09-27 15:31:07.597023 (Thread-23): Got an acceptable cached parse result
2020-09-27 15:31:07.635959 (Thread-23): Acquiring new bigquery connection "model.bamboodata.bbd_country_user_progress".
2020-09-27 15:31:07.636117 (Thread-23): Opening a new connection, currently in state init
2020-09-27 15:31:07.845660 (Thread-23): WARNING: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.base
- models.output

2020-09-27 15:31:07.972441 (Thread-24): handling status request
2020-09-27 15:31:07.972932 (Thread-24): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'a48143b7-69f2-44ce-9c93-64a5ba3d81a4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1498657438>]}
2020-09-27 15:31:07.974204 (Thread-24): sending response (<Response 1465 bytes [200 OK]>) to 10.0.5.150
2020-09-27 15:31:08.142510 (AgentWriter): reported 38 traces in 0.00538s, 1 additional messages skipped
2020-09-27 15:31:08.142832 (AgentWriter): initialized RateSampler, sample 100% of traces, 63 additional messages skipped
2020-09-27 15:31:10.512030 (Thread-25): handling status request
2020-09-27 15:31:10.512635 (Thread-25): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'a48143b7-69f2-44ce-9c93-64a5ba3d81a4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1498657438>]}
2020-09-27 15:31:10.514123 (Thread-25): sending response (<Response 1465 bytes [200 OK]>) to 10.0.44.9
2020-09-27 15:31:10.823807 (Thread-26): handling run_sql request
2020-09-27 15:31:10.824390 (Thread-26): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'a48143b7-69f2-44ce-9c93-64a5ba3d81a4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f149875e518>]}
2020-09-27 15:31:10.826006 (Thread-26): Connection 'model.bamboodata.bbd_country_user_progress' was properly closed.
2020-09-27 15:31:11.917540 (Thread-26): sending response (<Response 137 bytes [200 OK]>) to 10.0.17.64
2020-09-27 15:31:11.944904 (MainThread): Acquiring new bigquery connection "rpc.bamboodata.request".
2020-09-27 15:31:11.945405 (MainThread): Opening a new connection, currently in state init
2020-09-27 15:31:11.998052 (MainThread): Found 2 models, 0 tests, 0 snapshots, 0 analyses, 147 macros, 0 operations, 0 seed files, 0 sources
2020-09-27 15:31:11.999053 (Thread-1): Acquiring new bigquery connection "rpc.bamboodata.request".
2020-09-27 15:31:11.999153 (Thread-1): Opening a new connection, currently in state init
2020-09-27 15:31:11.999239 (Thread-1): Compiling rpc.bamboodata.request
2020-09-27 15:31:12.020445 (Thread-1): finished collecting timing info
2020-09-27 15:31:12.021366 (Thread-1): On rpc.bamboodata.request: with yesterday_new_users as 
(
select geo.country as country, app_info.id, count(distinct user_pseudo_id) yesterday_new_users
FROM `bamboodata-project`.`dbt_hdumon`.`events`
WHERE event_date = FORMAT_DATE("%Y%m%d", DATE_SUB(CURRENT_DATE(), INTERVAL 1 DAY))
      and event_timestamp = user_first_touch_timestamp
group by geo.country, app_info.id
),

prev_day_new_users as
(
select geo.country as country, app_info.id, count(distinct user_pseudo_id) prev_day_new_users
FROM `bamboodata-project`.`dbt_hdumon`.`events`
WHERE event_date = FORMAT_DATE("%Y%m%d", DATE_SUB(CURRENT_DATE(), INTERVAL 2 DAY))
      and event_timestamp = user_first_touch_timestamp
group by geo.country, app_info.id
),

three_day_ago_new_users as
(
select geo.country as country, app_info.id, count(distinct user_pseudo_id) three_day_ago_new_users
FROM `bamboodata-project`.`dbt_hdumon`.`events`
WHERE event_date = FORMAT_DATE("%Y%m%d", DATE_SUB(CURRENT_DATE(), INTERVAL 3 DAY))
      and event_timestamp = user_first_touch_timestamp
group by geo.country, app_info.id
),

last_week_users as
(
select geo.country as country, app_info.id, count(distinct user_pseudo_id) last_week_users
FROM `bamboodata-project`.`dbt_hdumon`.`events`
WHERE event_date <= FORMAT_DATE("%Y%m%d", DATE_TRUNC(CURRENT_DATE(), WEEK))
      AND event_date > FORMAT_DATE("%Y%m%d", DATE_SUB(DATE_TRUNC(CURRENT_DATE(), WEEK), INTERVAL 1 WEEK))
      and event_timestamp = user_first_touch_timestamp
group by geo.country,app_info.id),

previous_week_users as
(
select geo.country as country, app_info.id, count(distinct user_pseudo_id) prev_week_users
FROM `bamboodata-project`.`dbt_hdumon`.`events`
WHERE event_date <= FORMAT_DATE("%Y%m%d", DATE_SUB(DATE_TRUNC(CURRENT_DATE(), WEEK), INTERVAL 1 WEEK))
      AND event_date > FORMAT_DATE("%Y%m%d", DATE_SUB(DATE_TRUNC(CURRENT_DATE(), WEEK), INTERVAL 2 WEEK))
      and event_timestamp = user_first_touch_timestamp
group by geo.country, app_info.id)


select lwu.country, struct(lwu.id) as app_info, ynu.yesterday_new_users, pdnu.prev_day_new_users, tdnu.three_day_ago_new_users ,lwu.last_week_users, pwu.prev_week_users
from last_week_users lwu
left join yesterday_new_users ynu
on lwu.country = ynu.country
and lwu.id = ynu.id
left join prev_day_new_users pdnu
on lwu.country = pdnu.country
and lwu.id = pdnu.id
left join three_day_ago_new_users tdnu
on lwu.country = tdnu.country
and lwu.id = tdnu.id
left join previous_week_users pwu
on lwu.country = pwu.country
and lwu.id = pwu.id
limit 100
2020-09-27 15:31:12.380349 (Thread-1): Unhandled error while running:
with yesterday_new_users as 
(
select geo.country as country, app_info.id, count(distinct user_pseudo_id) yesterday_new_users
FROM `bamboodata-project`.`dbt_hdumon`.`events`
WHERE event_date = FORMAT_DATE("%Y%m%d", DATE_SUB(CURRENT_DATE(), INTERVAL 1 DAY))
      and event_timestamp = user_first_touch_timestamp
group by geo.country, app_info.id
),

prev_day_new_users as
(
select geo.country as country, app_info.id, count(distinct user_pseudo_id) prev_day_new_users
FROM `bamboodata-project`.`dbt_hdumon`.`events`
WHERE event_date = FORMAT_DATE("%Y%m%d", DATE_SUB(CURRENT_DATE(), INTERVAL 2 DAY))
      and event_timestamp = user_first_touch_timestamp
group by geo.country, app_info.id
),

three_day_ago_new_users as
(
select geo.country as country, app_info.id, count(distinct user_pseudo_id) three_day_ago_new_users
FROM `bamboodata-project`.`dbt_hdumon`.`events`
WHERE event_date = FORMAT_DATE("%Y%m%d", DATE_SUB(CURRENT_DATE(), INTERVAL 3 DAY))
      and event_timestamp = user_first_touch_timestamp
group by geo.country, app_info.id
),

last_week_users as
(
select geo.country as country, app_info.id, count(distinct user_pseudo_id) last_week_users
FROM `bamboodata-project`.`dbt_hdumon`.`events`
WHERE event_date <= FORMAT_DATE("%Y%m%d", DATE_TRUNC(CURRENT_DATE(), WEEK))
      AND event_date > FORMAT_DATE("%Y%m%d", DATE_SUB(DATE_TRUNC(CURRENT_DATE(), WEEK), INTERVAL 1 WEEK))
      and event_timestamp = user_first_touch_timestamp
group by geo.country,app_info.id),

previous_week_users as
(
select geo.country as country, app_info.id, count(distinct user_pseudo_id) prev_week_users
FROM `bamboodata-project`.`dbt_hdumon`.`events`
WHERE event_date <= FORMAT_DATE("%Y%m%d", DATE_SUB(DATE_TRUNC(CURRENT_DATE(), WEEK), INTERVAL 1 WEEK))
      AND event_date > FORMAT_DATE("%Y%m%d", DATE_SUB(DATE_TRUNC(CURRENT_DATE(), WEEK), INTERVAL 2 WEEK))
      and event_timestamp = user_first_touch_timestamp
group by geo.country, app_info.id)


select lwu.country, struct(lwu.id) as app_info, ynu.yesterday_new_users, pdnu.prev_day_new_users, tdnu.three_day_ago_new_users ,lwu.last_week_users, pwu.prev_week_users
from last_week_users lwu
left join yesterday_new_users ynu
on lwu.country = ynu.country
and lwu.id = ynu.id
left join prev_day_new_users pdnu
on lwu.country = pdnu.country
and lwu.id = pdnu.id
left join three_day_ago_new_users tdnu
on lwu.country = tdnu.country
and lwu.id = tdnu.id
left join previous_week_users pwu
on lwu.country = pwu.country
and lwu.id = pwu.id
limit 100
2020-09-27 15:31:12.380584 (Thread-1): finished collecting timing info
2020-09-27 15:31:12.380925 (Thread-1): Got an exception: Runtime Error
  404 Not found: Dataset bamboodata-project:dbt_hdumon was not found in location US
  
  (job ID: 3ad7bb27-6202-447b-ab12-b5dbcccadd67)
Traceback (most recent call last):
  File "/usr/local/lib/python3.6/dist-packages/dbt/adapters/bigquery/connections.py", line 85, in exception_handler
    yield
  File "/usr/local/lib/python3.6/dist-packages/dbt/adapters/bigquery/connections.py", line 364, in _retry_and_handle
    deadline=None)
  File "/usr/local/lib/python3.6/dist-packages/google/api_core/retry.py", line 184, in retry_target
    return target()
  File "/usr/local/lib/python3.6/dist-packages/dbt/adapters/bigquery/connections.py", line 226, in fn
    return self._query_and_results(client, sql, conn, job_params)
  File "/usr/local/lib/python3.6/dist-packages/dbt/adapters/bigquery/connections.py", line 353, in _query_and_results
    iterator = query_job.result(timeout=timeout)
  File "/usr/local/lib/python3.6/dist-packages/google/cloud/bigquery/job.py", line 3196, in result
    super(QueryJob, self).result(retry=retry, timeout=timeout)
  File "/usr/local/lib/python3.6/dist-packages/google/cloud/bigquery/job.py", line 818, in result
    return super(_AsyncJob, self).result(timeout=timeout)
  File "/usr/local/lib/python3.6/dist-packages/google/api_core/future/polling.py", line 130, in result
    raise self._exception
google.api_core.exceptions.NotFound: 404 Not found: Dataset bamboodata-project:dbt_hdumon was not found in location US

(job ID: 3ad7bb27-6202-447b-ab12-b5dbcccadd67)

                                                                       -----Query Job SQL Follows-----                                                                       

    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |
   1:with yesterday_new_users as 
   2:(
   3:select geo.country as country, app_info.id, count(distinct user_pseudo_id) yesterday_new_users
   4:FROM `bamboodata-project`.`dbt_hdumon`.`events`
   5:WHERE event_date = FORMAT_DATE("%Y%m%d", DATE_SUB(CURRENT_DATE(), INTERVAL 1 DAY))
   6:      and event_timestamp = user_first_touch_timestamp
   7:group by geo.country, app_info.id
   8:),
   9:
  10:prev_day_new_users as
  11:(
  12:select geo.country as country, app_info.id, count(distinct user_pseudo_id) prev_day_new_users
  13:FROM `bamboodata-project`.`dbt_hdumon`.`events`
  14:WHERE event_date = FORMAT_DATE("%Y%m%d", DATE_SUB(CURRENT_DATE(), INTERVAL 2 DAY))
  15:      and event_timestamp = user_first_touch_timestamp
  16:group by geo.country, app_info.id
  17:),
  18:
  19:three_day_ago_new_users as
  20:(
  21:select geo.country as country, app_info.id, count(distinct user_pseudo_id) three_day_ago_new_users
  22:FROM `bamboodata-project`.`dbt_hdumon`.`events`
  23:WHERE event_date = FORMAT_DATE("%Y%m%d", DATE_SUB(CURRENT_DATE(), INTERVAL 3 DAY))
  24:      and event_timestamp = user_first_touch_timestamp
  25:group by geo.country, app_info.id
  26:),
  27:
  28:last_week_users as
  29:(
  30:select geo.country as country, app_info.id, count(distinct user_pseudo_id) last_week_users
  31:FROM `bamboodata-project`.`dbt_hdumon`.`events`
  32:WHERE event_date <= FORMAT_DATE("%Y%m%d", DATE_TRUNC(CURRENT_DATE(), WEEK))
  33:      AND event_date > FORMAT_DATE("%Y%m%d", DATE_SUB(DATE_TRUNC(CURRENT_DATE(), WEEK), INTERVAL 1 WEEK))
  34:      and event_timestamp = user_first_touch_timestamp
  35:group by geo.country,app_info.id),
  36:
  37:previous_week_users as
  38:(
  39:select geo.country as country, app_info.id, count(distinct user_pseudo_id) prev_week_users
  40:FROM `bamboodata-project`.`dbt_hdumon`.`events`
  41:WHERE event_date <= FORMAT_DATE("%Y%m%d", DATE_SUB(DATE_TRUNC(CURRENT_DATE(), WEEK), INTERVAL 1 WEEK))
  42:      AND event_date > FORMAT_DATE("%Y%m%d", DATE_SUB(DATE_TRUNC(CURRENT_DATE(), WEEK), INTERVAL 2 WEEK))
  43:      and event_timestamp = user_first_touch_timestamp
  44:group by geo.country, app_info.id)
  45:
  46:
  47:select lwu.country, struct(lwu.id) as app_info, ynu.yesterday_new_users, pdnu.prev_day_new_users, tdnu.three_day_ago_new_users ,lwu.last_week_users, pwu.prev_week_users
  48:from last_week_users lwu
  49:left join yesterday_new_users ynu
  50:on lwu.country = ynu.country
  51:and lwu.id = ynu.id
  52:left join prev_day_new_users pdnu
  53:on lwu.country = pdnu.country
  54:and lwu.id = pdnu.id
  55:left join three_day_ago_new_users tdnu
  56:on lwu.country = tdnu.country
  57:and lwu.id = tdnu.id
  58:left join previous_week_users pwu
  59:on lwu.country = pwu.country
  60:and lwu.id = pwu.id
  61:limit 100
    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/usr/local/lib/python3.6/dist-packages/dbt/node_runners.py", line 228, in safe_run
    result = self.compile_and_execute(manifest, ctx)
  File "/usr/local/lib/python3.6/dist-packages/dbt/node_runners.py", line 171, in compile_and_execute
    result = self.run(ctx.node, manifest)
  File "/usr/local/lib/python3.6/dist-packages/dbt/node_runners.py", line 273, in run
    return self.execute(compiled_node, manifest)
  File "/usr/local/lib/python3.6/dist-packages/dbt/rpc/node_runners.py", line 86, in execute
    compiled_node.injected_sql, fetch=True
  File "/usr/local/lib/python3.6/dist-packages/dbt/adapters/base/impl.py", line 228, in execute
    fetch=fetch
  File "/usr/local/lib/python3.6/dist-packages/dbt/adapters/bigquery/connections.py", line 235, in execute
    query_job, iterator = self.raw_execute(sql, fetch=fetch)
  File "/usr/local/lib/python3.6/dist-packages/dbt/adapters/bigquery/connections.py", line 228, in raw_execute
    query_job, iterator = self._retry_and_handle(msg=sql, conn=conn, fn=fn)
  File "/usr/local/lib/python3.6/dist-packages/dbt/adapters/bigquery/connections.py", line 364, in _retry_and_handle
    deadline=None)
  File "/usr/lib/python3.6/contextlib.py", line 99, in __exit__
    self.gen.throw(type, value, traceback)
  File "/usr/local/lib/python3.6/dist-packages/dbt/adapters/bigquery/connections.py", line 108, in exception_handler
    raise RuntimeException(exc_message)
dbt.exceptions.RuntimeException: Runtime Error
  404 Not found: Dataset bamboodata-project:dbt_hdumon was not found in location US
  
  (job ID: 3ad7bb27-6202-447b-ab12-b5dbcccadd67)
2020-09-27 15:31:12.384461 (Thread-1): Got exception RPCException(10001, Runtime error, {'type': 'RuntimeException', 'message': 'Runtime Error in rpc request (from remote system)\n  404 Not found: Dataset bamboodata-project:dbt_hdumon was not found in location US\n  \n  (job ID: 3ad7bb27-6202-447b-ab12-b5dbcccadd67)', 'raw_sql': 'with yesterday_new_users as \r\n(\r\nselect geo.country as country, app_info.id, count(distinct user_pseudo_id) yesterday_new_users\r\nFROM {{ref(\'events\')}}\r\nWHERE event_date = FORMAT_DATE("%Y%m%d", DATE_SUB(CURRENT_DATE(), INTERVAL 1 DAY))\r\n      and event_timestamp = user_first_touch_timestamp\r\ngroup by geo.country, app_info.id\r\n),\r\n\r\nprev_day_new_users as\r\n(\r\nselect geo.country as country, app_info.id, count(distinct user_pseudo_id) prev_day_new_users\r\nFROM {{ref(\'events\')}}\r\nWHERE event_date = FORMAT_DATE("%Y%m%d", DATE_SUB(CURRENT_DATE(), INTERVAL 2 DAY))\r\n      and event_timestamp = user_first_touch_timestamp\r\ngroup by geo.country, app_info.id\r\n),\r\n\r\nthree_day_ago_new_users as\r\n(\r\nselect geo.country as country, app_info.id, count(distinct user_pseudo_id) three_day_ago_new_users\r\nFROM {{ref(\'events\')}}\r\nWHERE event_date = FORMAT_DATE("%Y%m%d", DATE_SUB(CURRENT_DATE(), INTERVAL 3 DAY))\r\n      and event_timestamp = user_first_touch_timestamp\r\ngroup by geo.country, app_info.id\r\n),\r\n\r\nlast_week_users as\r\n(\r\nselect geo.country as country, app_info.id, count(distinct user_pseudo_id) last_week_users\r\nFROM {{ref(\'events\')}}\r\nWHERE event_date <= FORMAT_DATE("%Y%m%d", DATE_TRUNC(CURRENT_DATE(), WEEK))\r\n      AND event_date > FORMAT_DATE("%Y%m%d", DATE_SUB(DATE_TRUNC(CURRENT_DATE(), WEEK), INTERVAL 1 WEEK))\r\n      and event_timestamp = user_first_touch_timestamp\r\ngroup by geo.country,app_info.id),\r\n\r\nprevious_week_users as\r\n(\r\nselect geo.country as country, app_info.id, count(distinct user_pseudo_id) prev_week_users\r\nFROM {{ref(\'events\')}}\r\nWHERE event_date <= FORMAT_DATE("%Y%m%d", DATE_SUB(DATE_TRUNC(CURRENT_DATE(), WEEK), INTERVAL 1 WEEK))\r\n      AND event_date > FORMAT_DATE("%Y%m%d", DATE_SUB(DATE_TRUNC(CURRENT_DATE(), WEEK), INTERVAL 2 WEEK))\r\n      and event_timestamp = user_first_touch_timestamp\r\ngroup by geo.country, app_info.id)\r\n\r\n\r\nselect lwu.country, struct(lwu.id) as app_info, ynu.yesterday_new_users, pdnu.prev_day_new_users, tdnu.three_day_ago_new_users ,lwu.last_week_users, pwu.prev_week_users\r\nfrom last_week_users lwu\r\nleft join yesterday_new_users ynu\r\non lwu.country = ynu.country\r\nand lwu.id = ynu.id\r\nleft join prev_day_new_users pdnu\r\non lwu.country = pdnu.country\r\nand lwu.id = pdnu.id\r\nleft join three_day_ago_new_users tdnu\r\non lwu.country = tdnu.country\r\nand lwu.id = tdnu.id\r\nleft join previous_week_users pwu\r\non lwu.country = pwu.country\r\nand lwu.id = pwu.id\nlimit 100', 'compiled_sql': 'with yesterday_new_users as \n(\nselect geo.country as country, app_info.id, count(distinct user_pseudo_id) yesterday_new_users\nFROM `bamboodata-project`.`dbt_hdumon`.`events`\nWHERE event_date = FORMAT_DATE("%Y%m%d", DATE_SUB(CURRENT_DATE(), INTERVAL 1 DAY))\n      and event_timestamp = user_first_touch_timestamp\ngroup by geo.country, app_info.id\n),\n\nprev_day_new_users as\n(\nselect geo.country as country, app_info.id, count(distinct user_pseudo_id) prev_day_new_users\nFROM `bamboodata-project`.`dbt_hdumon`.`events`\nWHERE event_date = FORMAT_DATE("%Y%m%d", DATE_SUB(CURRENT_DATE(), INTERVAL 2 DAY))\n      and event_timestamp = user_first_touch_timestamp\ngroup by geo.country, app_info.id\n),\n\nthree_day_ago_new_users as\n(\nselect geo.country as country, app_info.id, count(distinct user_pseudo_id) three_day_ago_new_users\nFROM `bamboodata-project`.`dbt_hdumon`.`events`\nWHERE event_date = FORMAT_DATE("%Y%m%d", DATE_SUB(CURRENT_DATE(), INTERVAL 3 DAY))\n      and event_timestamp = user_first_touch_timestamp\ngroup by geo.country, app_info.id\n),\n\nlast_week_users as\n(\nselect geo.country as country, app_info.id, count(distinct user_pseudo_id) last_week_users\nFROM `bamboodata-project`.`dbt_hdumon`.`events`\nWHERE event_date <= FORMAT_DATE("%Y%m%d", DATE_TRUNC(CURRENT_DATE(), WEEK))\n      AND event_date > FORMAT_DATE("%Y%m%d", DATE_SUB(DATE_TRUNC(CURRENT_DATE(), WEEK), INTERVAL 1 WEEK))\n      and event_timestamp = user_first_touch_timestamp\ngroup by geo.country,app_info.id),\n\nprevious_week_users as\n(\nselect geo.country as country, app_info.id, count(distinct user_pseudo_id) prev_week_users\nFROM `bamboodata-project`.`dbt_hdumon`.`events`\nWHERE event_date <= FORMAT_DATE("%Y%m%d", DATE_SUB(DATE_TRUNC(CURRENT_DATE(), WEEK), INTERVAL 1 WEEK))\n      AND event_date > FORMAT_DATE("%Y%m%d", DATE_SUB(DATE_TRUNC(CURRENT_DATE(), WEEK), INTERVAL 2 WEEK))\n      and event_timestamp = user_first_touch_timestamp\ngroup by geo.country, app_info.id)\n\n\nselect lwu.country, struct(lwu.id) as app_info, ynu.yesterday_new_users, pdnu.prev_day_new_users, tdnu.three_day_ago_new_users ,lwu.last_week_users, pwu.prev_week_users\nfrom last_week_users lwu\nleft join yesterday_new_users ynu\non lwu.country = ynu.country\nand lwu.id = ynu.id\nleft join prev_day_new_users pdnu\non lwu.country = pdnu.country\nand lwu.id = pdnu.id\nleft join three_day_ago_new_users tdnu\non lwu.country = tdnu.country\nand lwu.id = tdnu.id\nleft join previous_week_users pwu\non lwu.country = pwu.country\nand lwu.id = pwu.id\nlimit 100', 'tags': None}, None)
Traceback (most recent call last):
  File "/usr/local/lib/python3.6/dist-packages/dbt/task/rpc/sql_commands.py", line 165, in _in_thread
    self.node_results.append(runner.safe_run(self.manifest))
  File "/usr/local/lib/python3.6/dist-packages/dbt/node_runners.py", line 244, in safe_run
    result = self.error_result(ctx.node, error, started, [])
  File "/usr/local/lib/python3.6/dist-packages/dbt/rpc/node_runners.py", line 53, in error_result
    raise error
dbt.rpc.error.RPCException: RPCException(10001, Runtime error, {'type': 'RuntimeException', 'message': 'Runtime Error in rpc request (from remote system)\n  404 Not found: Dataset bamboodata-project:dbt_hdumon was not found in location US\n  \n  (job ID: 3ad7bb27-6202-447b-ab12-b5dbcccadd67)', 'raw_sql': 'with yesterday_new_users as \r\n(\r\nselect geo.country as country, app_info.id, count(distinct user_pseudo_id) yesterday_new_users\r\nFROM {{ref(\'events\')}}\r\nWHERE event_date = FORMAT_DATE("%Y%m%d", DATE_SUB(CURRENT_DATE(), INTERVAL 1 DAY))\r\n      and event_timestamp = user_first_touch_timestamp\r\ngroup by geo.country, app_info.id\r\n),\r\n\r\nprev_day_new_users as\r\n(\r\nselect geo.country as country, app_info.id, count(distinct user_pseudo_id) prev_day_new_users\r\nFROM {{ref(\'events\')}}\r\nWHERE event_date = FORMAT_DATE("%Y%m%d", DATE_SUB(CURRENT_DATE(), INTERVAL 2 DAY))\r\n      and event_timestamp = user_first_touch_timestamp\r\ngroup by geo.country, app_info.id\r\n),\r\n\r\nthree_day_ago_new_users as\r\n(\r\nselect geo.country as country, app_info.id, count(distinct user_pseudo_id) three_day_ago_new_users\r\nFROM {{ref(\'events\')}}\r\nWHERE event_date = FORMAT_DATE("%Y%m%d", DATE_SUB(CURRENT_DATE(), INTERVAL 3 DAY))\r\n      and event_timestamp = user_first_touch_timestamp\r\ngroup by geo.country, app_info.id\r\n),\r\n\r\nlast_week_users as\r\n(\r\nselect geo.country as country, app_info.id, count(distinct user_pseudo_id) last_week_users\r\nFROM {{ref(\'events\')}}\r\nWHERE event_date <= FORMAT_DATE("%Y%m%d", DATE_TRUNC(CURRENT_DATE(), WEEK))\r\n      AND event_date > FORMAT_DATE("%Y%m%d", DATE_SUB(DATE_TRUNC(CURRENT_DATE(), WEEK), INTERVAL 1 WEEK))\r\n      and event_timestamp = user_first_touch_timestamp\r\ngroup by geo.country,app_info.id),\r\n\r\nprevious_week_users as\r\n(\r\nselect geo.country as country, app_info.id, count(distinct user_pseudo_id) prev_week_users\r\nFROM {{ref(\'events\')}}\r\nWHERE event_date <= FORMAT_DATE("%Y%m%d", DATE_SUB(DATE_TRUNC(CURRENT_DATE(), WEEK), INTERVAL 1 WEEK))\r\n      AND event_date > FORMAT_DATE("%Y%m%d", DATE_SUB(DATE_TRUNC(CURRENT_DATE(), WEEK), INTERVAL 2 WEEK))\r\n      and event_timestamp = user_first_touch_timestamp\r\ngroup by geo.country, app_info.id)\r\n\r\n\r\nselect lwu.country, struct(lwu.id) as app_info, ynu.yesterday_new_users, pdnu.prev_day_new_users, tdnu.three_day_ago_new_users ,lwu.last_week_users, pwu.prev_week_users\r\nfrom last_week_users lwu\r\nleft join yesterday_new_users ynu\r\non lwu.country = ynu.country\r\nand lwu.id = ynu.id\r\nleft join prev_day_new_users pdnu\r\non lwu.country = pdnu.country\r\nand lwu.id = pdnu.id\r\nleft join three_day_ago_new_users tdnu\r\non lwu.country = tdnu.country\r\nand lwu.id = tdnu.id\r\nleft join previous_week_users pwu\r\non lwu.country = pwu.country\r\nand lwu.id = pwu.id\nlimit 100', 'compiled_sql': 'with yesterday_new_users as \n(\nselect geo.country as country, app_info.id, count(distinct user_pseudo_id) yesterday_new_users\nFROM `bamboodata-project`.`dbt_hdumon`.`events`\nWHERE event_date = FORMAT_DATE("%Y%m%d", DATE_SUB(CURRENT_DATE(), INTERVAL 1 DAY))\n      and event_timestamp = user_first_touch_timestamp\ngroup by geo.country, app_info.id\n),\n\nprev_day_new_users as\n(\nselect geo.country as country, app_info.id, count(distinct user_pseudo_id) prev_day_new_users\nFROM `bamboodata-project`.`dbt_hdumon`.`events`\nWHERE event_date = FORMAT_DATE("%Y%m%d", DATE_SUB(CURRENT_DATE(), INTERVAL 2 DAY))\n      and event_timestamp = user_first_touch_timestamp\ngroup by geo.country, app_info.id\n),\n\nthree_day_ago_new_users as\n(\nselect geo.country as country, app_info.id, count(distinct user_pseudo_id) three_day_ago_new_users\nFROM `bamboodata-project`.`dbt_hdumon`.`events`\nWHERE event_date = FORMAT_DATE("%Y%m%d", DATE_SUB(CURRENT_DATE(), INTERVAL 3 DAY))\n      and event_timestamp = user_first_touch_timestamp\ngroup by geo.country, app_info.id\n),\n\nlast_week_users as\n(\nselect geo.country as country, app_info.id, count(distinct user_pseudo_id) last_week_users\nFROM `bamboodata-project`.`dbt_hdumon`.`events`\nWHERE event_date <= FORMAT_DATE("%Y%m%d", DATE_TRUNC(CURRENT_DATE(), WEEK))\n      AND event_date > FORMAT_DATE("%Y%m%d", DATE_SUB(DATE_TRUNC(CURRENT_DATE(), WEEK), INTERVAL 1 WEEK))\n      and event_timestamp = user_first_touch_timestamp\ngroup by geo.country,app_info.id),\n\nprevious_week_users as\n(\nselect geo.country as country, app_info.id, count(distinct user_pseudo_id) prev_week_users\nFROM `bamboodata-project`.`dbt_hdumon`.`events`\nWHERE event_date <= FORMAT_DATE("%Y%m%d", DATE_SUB(DATE_TRUNC(CURRENT_DATE(), WEEK), INTERVAL 1 WEEK))\n      AND event_date > FORMAT_DATE("%Y%m%d", DATE_SUB(DATE_TRUNC(CURRENT_DATE(), WEEK), INTERVAL 2 WEEK))\n      and event_timestamp = user_first_touch_timestamp\ngroup by geo.country, app_info.id)\n\n\nselect lwu.country, struct(lwu.id) as app_info, ynu.yesterday_new_users, pdnu.prev_day_new_users, tdnu.three_day_ago_new_users ,lwu.last_week_users, pwu.prev_week_users\nfrom last_week_users lwu\nleft join yesterday_new_users ynu\non lwu.country = ynu.country\nand lwu.id = ynu.id\nleft join prev_day_new_users pdnu\non lwu.country = pdnu.country\nand lwu.id = pdnu.id\nleft join three_day_ago_new_users tdnu\non lwu.country = tdnu.country\nand lwu.id = tdnu.id\nleft join previous_week_users pwu\non lwu.country = pwu.country\nand lwu.id = pwu.id\nlimit 100', 'tags': None}, None)
2020-09-27 15:31:12.399809 (Thread-27): handling poll request
2020-09-27 15:31:12.400322 (Thread-27): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'a48143b7-69f2-44ce-9c93-64a5ba3d81a4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f14986311d0>]}
2020-09-27 15:31:12.403322 (Thread-27): sending response (<Response 27579 bytes [200 OK]>) to 10.0.34.126
2020-09-27 15:31:13.891232 (Thread-28): handling poll request
2020-09-27 15:31:13.893201 (Thread-28): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'a48143b7-69f2-44ce-9c93-64a5ba3d81a4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1498537710>]}
2020-09-27 15:31:13.894633 (Thread-28): sending response (<Response 32736 bytes [200 OK]>) to 10.0.38.179
2020-09-27 15:32:53.471434 (Thread-29): handling status request
2020-09-27 15:32:53.473301 (Thread-29): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'a48143b7-69f2-44ce-9c93-64a5ba3d81a4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1498631e10>]}
2020-09-27 15:32:53.474569 (Thread-29): sending response (<Response 1465 bytes [200 OK]>) to 10.0.38.51
2020-09-27 15:32:53.784699 (Thread-30): handling run_sql request
2020-09-27 15:32:53.785223 (Thread-30): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'a48143b7-69f2-44ce-9c93-64a5ba3d81a4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f14987382e8>]}
2020-09-27 15:32:54.725835 (Thread-30): sending response (<Response 137 bytes [200 OK]>) to 10.0.12.156
2020-09-27 15:32:54.747218 (MainThread): Acquiring new bigquery connection "rpc.bamboodata.request".
2020-09-27 15:32:54.747664 (MainThread): Opening a new connection, currently in state init
2020-09-27 15:32:54.779853 (MainThread): Found 2 models, 0 tests, 0 snapshots, 0 analyses, 147 macros, 0 operations, 0 seed files, 0 sources
2020-09-27 15:32:54.780511 (Thread-1): Acquiring new bigquery connection "rpc.bamboodata.request".
2020-09-27 15:32:54.780610 (Thread-1): Opening a new connection, currently in state init
2020-09-27 15:32:54.780693 (Thread-1): Compiling rpc.bamboodata.request
2020-09-27 15:32:54.794432 (Thread-1): finished collecting timing info
2020-09-27 15:32:54.795424 (Thread-1): On rpc.bamboodata.request: 

SELECT format_date( "%Y%m%d" ,date_add(PARSE_DATE("%Y%m%d",event_date), interval (select date_diff(current_date, PARSE_DATE("%Y%m%d",max(event_date)),day) FROM `bamboodata-project.analytics_220006363.events_an_purchases`) day)) event_date 
       ,event_timestamp + (select date_diff(current_date, PARSE_DATE("%Y%m%d",max(event_date)),day) FROM `bamboodata-project.analytics_220006363.events_an_purchases`) * 3600*24*1000000 as event_timestamp
       ,user_first_touch_timestamp + (select date_diff(current_date, PARSE_DATE("%Y%m%d",max(event_date)),day) FROM `bamboodata-project.analytics_220006363.events_an_purchases`) * 3600*24*1000000 as user_first_touch_timestamp,

* EXCEPT(event_date, event_timestamp, user_first_touch_timestamp)
FROM `bamboodata-project.analytics_220006363.events_an_purchases`
order by event_timestamp desc


limit 100
2020-09-27 15:32:55.147032 (Thread-31): handling poll request
2020-09-27 15:32:55.147543 (Thread-31): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'a48143b7-69f2-44ce-9c93-64a5ba3d81a4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1498738ef0>]}
2020-09-27 15:32:55.150590 (Thread-31): sending response (<Response 3667 bytes [200 OK]>) to 10.0.27.68
2020-09-27 15:32:56.438424 (Thread-32): handling poll request
2020-09-27 15:32:56.438910 (Thread-32): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'a48143b7-69f2-44ce-9c93-64a5ba3d81a4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f149c8e8d30>]}
2020-09-27 15:32:56.439890 (Thread-32): sending response (<Response 383 bytes [200 OK]>) to 10.0.17.64
2020-09-27 15:32:57.769294 (Thread-33): handling poll request
2020-09-27 15:32:57.771113 (Thread-33): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'a48143b7-69f2-44ce-9c93-64a5ba3d81a4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1498631a58>]}
2020-09-27 15:32:57.772147 (Thread-33): sending response (<Response 384 bytes [200 OK]>) to 10.0.3.121
2020-09-27 15:32:59.226109 (Thread-34): handling poll request
2020-09-27 15:32:59.226787 (Thread-34): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'a48143b7-69f2-44ce-9c93-64a5ba3d81a4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1498631b38>]}
2020-09-27 15:32:59.228199 (Thread-34): sending response (<Response 384 bytes [200 OK]>) to 10.0.34.126
2020-09-27 15:33:00.505600 (Thread-35): handling poll request
2020-09-27 15:33:00.506097 (Thread-35): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'a48143b7-69f2-44ce-9c93-64a5ba3d81a4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1498631cf8>]}
2020-09-27 15:33:00.510085 (Thread-35): Checking header 'user-agent' tracing in whitelist set(), 44 additional messages skipped
2020-09-27 15:33:00.532092 (Thread-35): writing 1 spans (enabled:True), 37 additional messages skipped
2020-09-27 15:33:00.532310 (Thread-35): 
      name requests.request
        id 17768691474596350117
  trace_id 17999270670041699307
 parent_id None
   service requests
  resource requests.request
      type http
     start 1601220780.509488
       end 1601220780.531975
  duration 0.022487s
     error 0
      tags 
           http.method:POST
           http.status_code:200
           http.url:https://fishtownanalytics.sinter-collect.com/com.snowplowanalytics.snowplow/tp2
           runtime-id:8671c46a3c914bbfa95f40976d37c7bc, 37 additional messages skipped
2020-09-27 15:33:00.534520 (Thread-35): sending response (<Response 384 bytes [200 OK]>) to 10.0.27.68
2020-09-27 15:33:01.045565 (Thread-1): finished collecting timing info
2020-09-27 15:33:01.162052 (AgentWriter): reported 1 traces in 0.00443s
2020-09-27 15:33:01.162300 (AgentWriter): initialized RateSampler, sample 100% of traces, 31 additional messages skipped
2020-09-27 15:33:01.992274 (Thread-36): handling poll request
2020-09-27 15:33:01.992773 (Thread-36): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'a48143b7-69f2-44ce-9c93-64a5ba3d81a4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1498393b70>]}
2020-09-27 15:33:01.999416 (Thread-36): sending response (<Response 233687 bytes [200 OK]>) to 10.0.44.9
2020-09-27 15:33:09.519632 (Thread-37): Got an acceptable cached parse result
2020-09-27 15:33:09.670336 (Thread-37): Acquiring new bigquery connection "model.bamboodata.events".
2020-09-27 15:33:09.670493 (Thread-37): Opening a new connection, currently in state init
2020-09-27 15:33:09.822353 (Thread-37): WARNING: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.base
- models.output

2020-09-27 15:33:10.047370 (Thread-38): handling status request
2020-09-27 15:33:10.047857 (Thread-38): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'a48143b7-69f2-44ce-9c93-64a5ba3d81a4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1498446e10>]}
2020-09-27 15:33:10.049063 (Thread-38): sending response (<Response 1446 bytes [200 OK]>) to 10.0.18.102
2020-09-27 15:33:22.045786 (Thread-39): handling status request
2020-09-27 15:33:22.047569 (Thread-39): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'a48143b7-69f2-44ce-9c93-64a5ba3d81a4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f149869c208>]}
2020-09-27 15:33:22.048775 (Thread-39): sending response (<Response 1446 bytes [200 OK]>) to 10.0.47.163
2020-09-27 15:33:22.375020 (Thread-40): handling run_sql request
2020-09-27 15:33:22.375496 (Thread-40): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'a48143b7-69f2-44ce-9c93-64a5ba3d81a4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f14983ac9e8>]}
2020-09-27 15:33:22.376762 (Thread-40): Connection 'model.bamboodata.events' was properly closed.
2020-09-27 15:33:23.315322 (Thread-40): sending response (<Response 137 bytes [200 OK]>) to 10.0.2.56
2020-09-27 15:33:23.338133 (MainThread): Acquiring new bigquery connection "rpc.bamboodata.request".
2020-09-27 15:33:23.338677 (MainThread): Opening a new connection, currently in state init
2020-09-27 15:33:23.377472 (MainThread): Found 2 models, 0 tests, 0 snapshots, 0 analyses, 147 macros, 0 operations, 0 seed files, 0 sources
2020-09-27 15:33:23.381278 (Thread-1): Acquiring new bigquery connection "rpc.bamboodata.request".
2020-09-27 15:33:23.381427 (Thread-1): Opening a new connection, currently in state init
2020-09-27 15:33:23.381534 (Thread-1): Compiling rpc.bamboodata.request
2020-09-27 15:33:23.413486 (Thread-1): finished collecting timing info
2020-09-27 15:33:23.414654 (Thread-1): On rpc.bamboodata.request: with yesterday_new_users as 
(
select geo.country as country, app_info.id, count(distinct user_pseudo_id) yesterday_new_users
FROM `bamboodata-project`.`dbt_hdumon`.`events`
WHERE event_date = FORMAT_DATE("%Y%m%d", DATE_SUB(CURRENT_DATE(), INTERVAL 1 DAY))
      and event_timestamp = user_first_touch_timestamp
group by geo.country, app_info.id
),

prev_day_new_users as
(
select geo.country as country, app_info.id, count(distinct user_pseudo_id) prev_day_new_users
FROM `bamboodata-project`.`dbt_hdumon`.`events`
WHERE event_date = FORMAT_DATE("%Y%m%d", DATE_SUB(CURRENT_DATE(), INTERVAL 2 DAY))
      and event_timestamp = user_first_touch_timestamp
group by geo.country, app_info.id
),

three_day_ago_new_users as
(
select geo.country as country, app_info.id, count(distinct user_pseudo_id) three_day_ago_new_users
FROM `bamboodata-project`.`dbt_hdumon`.`events`
WHERE event_date = FORMAT_DATE("%Y%m%d", DATE_SUB(CURRENT_DATE(), INTERVAL 3 DAY))
      and event_timestamp = user_first_touch_timestamp
group by geo.country, app_info.id
),

last_week_users as
(
select geo.country as country, app_info.id, count(distinct user_pseudo_id) last_week_users
FROM `bamboodata-project`.`dbt_hdumon`.`events`
WHERE event_date <= FORMAT_DATE("%Y%m%d", DATE_TRUNC(CURRENT_DATE(), WEEK))
      AND event_date > FORMAT_DATE("%Y%m%d", DATE_SUB(DATE_TRUNC(CURRENT_DATE(), WEEK), INTERVAL 1 WEEK))
      and event_timestamp = user_first_touch_timestamp
group by geo.country,app_info.id),

previous_week_users as
(
select geo.country as country, app_info.id, count(distinct user_pseudo_id) prev_week_users
FROM `bamboodata-project`.`dbt_hdumon`.`events`
WHERE event_date <= FORMAT_DATE("%Y%m%d", DATE_SUB(DATE_TRUNC(CURRENT_DATE(), WEEK), INTERVAL 1 WEEK))
      AND event_date > FORMAT_DATE("%Y%m%d", DATE_SUB(DATE_TRUNC(CURRENT_DATE(), WEEK), INTERVAL 2 WEEK))
      and event_timestamp = user_first_touch_timestamp
group by geo.country, app_info.id)


select lwu.country, struct(lwu.id) as app_info, ynu.yesterday_new_users, pdnu.prev_day_new_users, tdnu.three_day_ago_new_users ,lwu.last_week_users, pwu.prev_week_users
from last_week_users lwu
left join yesterday_new_users ynu
on lwu.country = ynu.country
and lwu.id = ynu.id
left join prev_day_new_users pdnu
on lwu.country = pdnu.country
and lwu.id = pdnu.id
left join three_day_ago_new_users tdnu
on lwu.country = tdnu.country
and lwu.id = tdnu.id
left join previous_week_users pwu
on lwu.country = pwu.country
and lwu.id = pwu.id
limit 100
2020-09-27 15:33:23.854144 (Thread-1): Unhandled error while running:
with yesterday_new_users as 
(
select geo.country as country, app_info.id, count(distinct user_pseudo_id) yesterday_new_users
FROM `bamboodata-project`.`dbt_hdumon`.`events`
WHERE event_date = FORMAT_DATE("%Y%m%d", DATE_SUB(CURRENT_DATE(), INTERVAL 1 DAY))
      and event_timestamp = user_first_touch_timestamp
group by geo.country, app_info.id
),

prev_day_new_users as
(
select geo.country as country, app_info.id, count(distinct user_pseudo_id) prev_day_new_users
FROM `bamboodata-project`.`dbt_hdumon`.`events`
WHERE event_date = FORMAT_DATE("%Y%m%d", DATE_SUB(CURRENT_DATE(), INTERVAL 2 DAY))
      and event_timestamp = user_first_touch_timestamp
group by geo.country, app_info.id
),

three_day_ago_new_users as
(
select geo.country as country, app_info.id, count(distinct user_pseudo_id) three_day_ago_new_users
FROM `bamboodata-project`.`dbt_hdumon`.`events`
WHERE event_date = FORMAT_DATE("%Y%m%d", DATE_SUB(CURRENT_DATE(), INTERVAL 3 DAY))
      and event_timestamp = user_first_touch_timestamp
group by geo.country, app_info.id
),

last_week_users as
(
select geo.country as country, app_info.id, count(distinct user_pseudo_id) last_week_users
FROM `bamboodata-project`.`dbt_hdumon`.`events`
WHERE event_date <= FORMAT_DATE("%Y%m%d", DATE_TRUNC(CURRENT_DATE(), WEEK))
      AND event_date > FORMAT_DATE("%Y%m%d", DATE_SUB(DATE_TRUNC(CURRENT_DATE(), WEEK), INTERVAL 1 WEEK))
      and event_timestamp = user_first_touch_timestamp
group by geo.country,app_info.id),

previous_week_users as
(
select geo.country as country, app_info.id, count(distinct user_pseudo_id) prev_week_users
FROM `bamboodata-project`.`dbt_hdumon`.`events`
WHERE event_date <= FORMAT_DATE("%Y%m%d", DATE_SUB(DATE_TRUNC(CURRENT_DATE(), WEEK), INTERVAL 1 WEEK))
      AND event_date > FORMAT_DATE("%Y%m%d", DATE_SUB(DATE_TRUNC(CURRENT_DATE(), WEEK), INTERVAL 2 WEEK))
      and event_timestamp = user_first_touch_timestamp
group by geo.country, app_info.id)


select lwu.country, struct(lwu.id) as app_info, ynu.yesterday_new_users, pdnu.prev_day_new_users, tdnu.three_day_ago_new_users ,lwu.last_week_users, pwu.prev_week_users
from last_week_users lwu
left join yesterday_new_users ynu
on lwu.country = ynu.country
and lwu.id = ynu.id
left join prev_day_new_users pdnu
on lwu.country = pdnu.country
and lwu.id = pdnu.id
left join three_day_ago_new_users tdnu
on lwu.country = tdnu.country
and lwu.id = tdnu.id
left join previous_week_users pwu
on lwu.country = pwu.country
and lwu.id = pwu.id
limit 100
2020-09-27 15:33:23.854400 (Thread-1): finished collecting timing info
2020-09-27 15:33:23.854760 (Thread-1): Got an exception: Runtime Error
  404 Not found: Dataset bamboodata-project:dbt_hdumon was not found in location US
  
  (job ID: 5b453f78-ef01-4b18-90c3-b735a57a540b)
Traceback (most recent call last):
  File "/usr/local/lib/python3.6/dist-packages/dbt/adapters/bigquery/connections.py", line 85, in exception_handler
    yield
  File "/usr/local/lib/python3.6/dist-packages/dbt/adapters/bigquery/connections.py", line 364, in _retry_and_handle
    deadline=None)
  File "/usr/local/lib/python3.6/dist-packages/google/api_core/retry.py", line 184, in retry_target
    return target()
  File "/usr/local/lib/python3.6/dist-packages/dbt/adapters/bigquery/connections.py", line 226, in fn
    return self._query_and_results(client, sql, conn, job_params)
  File "/usr/local/lib/python3.6/dist-packages/dbt/adapters/bigquery/connections.py", line 353, in _query_and_results
    iterator = query_job.result(timeout=timeout)
  File "/usr/local/lib/python3.6/dist-packages/google/cloud/bigquery/job.py", line 3196, in result
    super(QueryJob, self).result(retry=retry, timeout=timeout)
  File "/usr/local/lib/python3.6/dist-packages/google/cloud/bigquery/job.py", line 818, in result
    return super(_AsyncJob, self).result(timeout=timeout)
  File "/usr/local/lib/python3.6/dist-packages/google/api_core/future/polling.py", line 130, in result
    raise self._exception
google.api_core.exceptions.NotFound: 404 Not found: Dataset bamboodata-project:dbt_hdumon was not found in location US

(job ID: 5b453f78-ef01-4b18-90c3-b735a57a540b)

                                                                       -----Query Job SQL Follows-----                                                                       

    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |
   1:with yesterday_new_users as 
   2:(
   3:select geo.country as country, app_info.id, count(distinct user_pseudo_id) yesterday_new_users
   4:FROM `bamboodata-project`.`dbt_hdumon`.`events`
   5:WHERE event_date = FORMAT_DATE("%Y%m%d", DATE_SUB(CURRENT_DATE(), INTERVAL 1 DAY))
   6:      and event_timestamp = user_first_touch_timestamp
   7:group by geo.country, app_info.id
   8:),
   9:
  10:prev_day_new_users as
  11:(
  12:select geo.country as country, app_info.id, count(distinct user_pseudo_id) prev_day_new_users
  13:FROM `bamboodata-project`.`dbt_hdumon`.`events`
  14:WHERE event_date = FORMAT_DATE("%Y%m%d", DATE_SUB(CURRENT_DATE(), INTERVAL 2 DAY))
  15:      and event_timestamp = user_first_touch_timestamp
  16:group by geo.country, app_info.id
  17:),
  18:
  19:three_day_ago_new_users as
  20:(
  21:select geo.country as country, app_info.id, count(distinct user_pseudo_id) three_day_ago_new_users
  22:FROM `bamboodata-project`.`dbt_hdumon`.`events`
  23:WHERE event_date = FORMAT_DATE("%Y%m%d", DATE_SUB(CURRENT_DATE(), INTERVAL 3 DAY))
  24:      and event_timestamp = user_first_touch_timestamp
  25:group by geo.country, app_info.id
  26:),
  27:
  28:last_week_users as
  29:(
  30:select geo.country as country, app_info.id, count(distinct user_pseudo_id) last_week_users
  31:FROM `bamboodata-project`.`dbt_hdumon`.`events`
  32:WHERE event_date <= FORMAT_DATE("%Y%m%d", DATE_TRUNC(CURRENT_DATE(), WEEK))
  33:      AND event_date > FORMAT_DATE("%Y%m%d", DATE_SUB(DATE_TRUNC(CURRENT_DATE(), WEEK), INTERVAL 1 WEEK))
  34:      and event_timestamp = user_first_touch_timestamp
  35:group by geo.country,app_info.id),
  36:
  37:previous_week_users as
  38:(
  39:select geo.country as country, app_info.id, count(distinct user_pseudo_id) prev_week_users
  40:FROM `bamboodata-project`.`dbt_hdumon`.`events`
  41:WHERE event_date <= FORMAT_DATE("%Y%m%d", DATE_SUB(DATE_TRUNC(CURRENT_DATE(), WEEK), INTERVAL 1 WEEK))
  42:      AND event_date > FORMAT_DATE("%Y%m%d", DATE_SUB(DATE_TRUNC(CURRENT_DATE(), WEEK), INTERVAL 2 WEEK))
  43:      and event_timestamp = user_first_touch_timestamp
  44:group by geo.country, app_info.id)
  45:
  46:
  47:select lwu.country, struct(lwu.id) as app_info, ynu.yesterday_new_users, pdnu.prev_day_new_users, tdnu.three_day_ago_new_users ,lwu.last_week_users, pwu.prev_week_users
  48:from last_week_users lwu
  49:left join yesterday_new_users ynu
  50:on lwu.country = ynu.country
  51:and lwu.id = ynu.id
  52:left join prev_day_new_users pdnu
  53:on lwu.country = pdnu.country
  54:and lwu.id = pdnu.id
  55:left join three_day_ago_new_users tdnu
  56:on lwu.country = tdnu.country
  57:and lwu.id = tdnu.id
  58:left join previous_week_users pwu
  59:on lwu.country = pwu.country
  60:and lwu.id = pwu.id
  61:limit 100
    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/usr/local/lib/python3.6/dist-packages/dbt/node_runners.py", line 228, in safe_run
    result = self.compile_and_execute(manifest, ctx)
  File "/usr/local/lib/python3.6/dist-packages/dbt/node_runners.py", line 171, in compile_and_execute
    result = self.run(ctx.node, manifest)
  File "/usr/local/lib/python3.6/dist-packages/dbt/node_runners.py", line 273, in run
    return self.execute(compiled_node, manifest)
  File "/usr/local/lib/python3.6/dist-packages/dbt/rpc/node_runners.py", line 86, in execute
    compiled_node.injected_sql, fetch=True
  File "/usr/local/lib/python3.6/dist-packages/dbt/adapters/base/impl.py", line 228, in execute
    fetch=fetch
  File "/usr/local/lib/python3.6/dist-packages/dbt/adapters/bigquery/connections.py", line 235, in execute
    query_job, iterator = self.raw_execute(sql, fetch=fetch)
  File "/usr/local/lib/python3.6/dist-packages/dbt/adapters/bigquery/connections.py", line 228, in raw_execute
    query_job, iterator = self._retry_and_handle(msg=sql, conn=conn, fn=fn)
  File "/usr/local/lib/python3.6/dist-packages/dbt/adapters/bigquery/connections.py", line 364, in _retry_and_handle
    deadline=None)
  File "/usr/lib/python3.6/contextlib.py", line 99, in __exit__
    self.gen.throw(type, value, traceback)
  File "/usr/local/lib/python3.6/dist-packages/dbt/adapters/bigquery/connections.py", line 108, in exception_handler
    raise RuntimeException(exc_message)
dbt.exceptions.RuntimeException: Runtime Error
  404 Not found: Dataset bamboodata-project:dbt_hdumon was not found in location US
  
  (job ID: 5b453f78-ef01-4b18-90c3-b735a57a540b)
2020-09-27 15:33:23.858146 (Thread-1): Got exception RPCException(10001, Runtime error, {'type': 'RuntimeException', 'message': 'Runtime Error in rpc request (from remote system)\n  404 Not found: Dataset bamboodata-project:dbt_hdumon was not found in location US\n  \n  (job ID: 5b453f78-ef01-4b18-90c3-b735a57a540b)', 'raw_sql': 'with yesterday_new_users as \r\n(\r\nselect geo.country as country, app_info.id, count(distinct user_pseudo_id) yesterday_new_users\r\nFROM {{ref(\'events\')}}\r\nWHERE event_date = FORMAT_DATE("%Y%m%d", DATE_SUB(CURRENT_DATE(), INTERVAL 1 DAY))\r\n      and event_timestamp = user_first_touch_timestamp\r\ngroup by geo.country, app_info.id\r\n),\r\n\r\nprev_day_new_users as\r\n(\r\nselect geo.country as country, app_info.id, count(distinct user_pseudo_id) prev_day_new_users\r\nFROM {{ref(\'events\')}}\r\nWHERE event_date = FORMAT_DATE("%Y%m%d", DATE_SUB(CURRENT_DATE(), INTERVAL 2 DAY))\r\n      and event_timestamp = user_first_touch_timestamp\r\ngroup by geo.country, app_info.id\r\n),\r\n\r\nthree_day_ago_new_users as\r\n(\r\nselect geo.country as country, app_info.id, count(distinct user_pseudo_id) three_day_ago_new_users\r\nFROM {{ref(\'events\')}}\r\nWHERE event_date = FORMAT_DATE("%Y%m%d", DATE_SUB(CURRENT_DATE(), INTERVAL 3 DAY))\r\n      and event_timestamp = user_first_touch_timestamp\r\ngroup by geo.country, app_info.id\r\n),\r\n\r\nlast_week_users as\r\n(\r\nselect geo.country as country, app_info.id, count(distinct user_pseudo_id) last_week_users\r\nFROM {{ref(\'events\')}}\r\nWHERE event_date <= FORMAT_DATE("%Y%m%d", DATE_TRUNC(CURRENT_DATE(), WEEK))\r\n      AND event_date > FORMAT_DATE("%Y%m%d", DATE_SUB(DATE_TRUNC(CURRENT_DATE(), WEEK), INTERVAL 1 WEEK))\r\n      and event_timestamp = user_first_touch_timestamp\r\ngroup by geo.country,app_info.id),\r\n\r\nprevious_week_users as\r\n(\r\nselect geo.country as country, app_info.id, count(distinct user_pseudo_id) prev_week_users\r\nFROM {{ref(\'events\')}}\r\nWHERE event_date <= FORMAT_DATE("%Y%m%d", DATE_SUB(DATE_TRUNC(CURRENT_DATE(), WEEK), INTERVAL 1 WEEK))\r\n      AND event_date > FORMAT_DATE("%Y%m%d", DATE_SUB(DATE_TRUNC(CURRENT_DATE(), WEEK), INTERVAL 2 WEEK))\r\n      and event_timestamp = user_first_touch_timestamp\r\ngroup by geo.country, app_info.id)\r\n\r\n\r\nselect lwu.country, struct(lwu.id) as app_info, ynu.yesterday_new_users, pdnu.prev_day_new_users, tdnu.three_day_ago_new_users ,lwu.last_week_users, pwu.prev_week_users\r\nfrom last_week_users lwu\r\nleft join yesterday_new_users ynu\r\non lwu.country = ynu.country\r\nand lwu.id = ynu.id\r\nleft join prev_day_new_users pdnu\r\non lwu.country = pdnu.country\r\nand lwu.id = pdnu.id\r\nleft join three_day_ago_new_users tdnu\r\non lwu.country = tdnu.country\r\nand lwu.id = tdnu.id\r\nleft join previous_week_users pwu\r\non lwu.country = pwu.country\r\nand lwu.id = pwu.id\nlimit 100', 'compiled_sql': 'with yesterday_new_users as \n(\nselect geo.country as country, app_info.id, count(distinct user_pseudo_id) yesterday_new_users\nFROM `bamboodata-project`.`dbt_hdumon`.`events`\nWHERE event_date = FORMAT_DATE("%Y%m%d", DATE_SUB(CURRENT_DATE(), INTERVAL 1 DAY))\n      and event_timestamp = user_first_touch_timestamp\ngroup by geo.country, app_info.id\n),\n\nprev_day_new_users as\n(\nselect geo.country as country, app_info.id, count(distinct user_pseudo_id) prev_day_new_users\nFROM `bamboodata-project`.`dbt_hdumon`.`events`\nWHERE event_date = FORMAT_DATE("%Y%m%d", DATE_SUB(CURRENT_DATE(), INTERVAL 2 DAY))\n      and event_timestamp = user_first_touch_timestamp\ngroup by geo.country, app_info.id\n),\n\nthree_day_ago_new_users as\n(\nselect geo.country as country, app_info.id, count(distinct user_pseudo_id) three_day_ago_new_users\nFROM `bamboodata-project`.`dbt_hdumon`.`events`\nWHERE event_date = FORMAT_DATE("%Y%m%d", DATE_SUB(CURRENT_DATE(), INTERVAL 3 DAY))\n      and event_timestamp = user_first_touch_timestamp\ngroup by geo.country, app_info.id\n),\n\nlast_week_users as\n(\nselect geo.country as country, app_info.id, count(distinct user_pseudo_id) last_week_users\nFROM `bamboodata-project`.`dbt_hdumon`.`events`\nWHERE event_date <= FORMAT_DATE("%Y%m%d", DATE_TRUNC(CURRENT_DATE(), WEEK))\n      AND event_date > FORMAT_DATE("%Y%m%d", DATE_SUB(DATE_TRUNC(CURRENT_DATE(), WEEK), INTERVAL 1 WEEK))\n      and event_timestamp = user_first_touch_timestamp\ngroup by geo.country,app_info.id),\n\nprevious_week_users as\n(\nselect geo.country as country, app_info.id, count(distinct user_pseudo_id) prev_week_users\nFROM `bamboodata-project`.`dbt_hdumon`.`events`\nWHERE event_date <= FORMAT_DATE("%Y%m%d", DATE_SUB(DATE_TRUNC(CURRENT_DATE(), WEEK), INTERVAL 1 WEEK))\n      AND event_date > FORMAT_DATE("%Y%m%d", DATE_SUB(DATE_TRUNC(CURRENT_DATE(), WEEK), INTERVAL 2 WEEK))\n      and event_timestamp = user_first_touch_timestamp\ngroup by geo.country, app_info.id)\n\n\nselect lwu.country, struct(lwu.id) as app_info, ynu.yesterday_new_users, pdnu.prev_day_new_users, tdnu.three_day_ago_new_users ,lwu.last_week_users, pwu.prev_week_users\nfrom last_week_users lwu\nleft join yesterday_new_users ynu\non lwu.country = ynu.country\nand lwu.id = ynu.id\nleft join prev_day_new_users pdnu\non lwu.country = pdnu.country\nand lwu.id = pdnu.id\nleft join three_day_ago_new_users tdnu\non lwu.country = tdnu.country\nand lwu.id = tdnu.id\nleft join previous_week_users pwu\non lwu.country = pwu.country\nand lwu.id = pwu.id\nlimit 100', 'tags': None}, None)
Traceback (most recent call last):
  File "/usr/local/lib/python3.6/dist-packages/dbt/task/rpc/sql_commands.py", line 165, in _in_thread
    self.node_results.append(runner.safe_run(self.manifest))
  File "/usr/local/lib/python3.6/dist-packages/dbt/node_runners.py", line 244, in safe_run
    result = self.error_result(ctx.node, error, started, [])
  File "/usr/local/lib/python3.6/dist-packages/dbt/rpc/node_runners.py", line 53, in error_result
    raise error
dbt.rpc.error.RPCException: RPCException(10001, Runtime error, {'type': 'RuntimeException', 'message': 'Runtime Error in rpc request (from remote system)\n  404 Not found: Dataset bamboodata-project:dbt_hdumon was not found in location US\n  \n  (job ID: 5b453f78-ef01-4b18-90c3-b735a57a540b)', 'raw_sql': 'with yesterday_new_users as \r\n(\r\nselect geo.country as country, app_info.id, count(distinct user_pseudo_id) yesterday_new_users\r\nFROM {{ref(\'events\')}}\r\nWHERE event_date = FORMAT_DATE("%Y%m%d", DATE_SUB(CURRENT_DATE(), INTERVAL 1 DAY))\r\n      and event_timestamp = user_first_touch_timestamp\r\ngroup by geo.country, app_info.id\r\n),\r\n\r\nprev_day_new_users as\r\n(\r\nselect geo.country as country, app_info.id, count(distinct user_pseudo_id) prev_day_new_users\r\nFROM {{ref(\'events\')}}\r\nWHERE event_date = FORMAT_DATE("%Y%m%d", DATE_SUB(CURRENT_DATE(), INTERVAL 2 DAY))\r\n      and event_timestamp = user_first_touch_timestamp\r\ngroup by geo.country, app_info.id\r\n),\r\n\r\nthree_day_ago_new_users as\r\n(\r\nselect geo.country as country, app_info.id, count(distinct user_pseudo_id) three_day_ago_new_users\r\nFROM {{ref(\'events\')}}\r\nWHERE event_date = FORMAT_DATE("%Y%m%d", DATE_SUB(CURRENT_DATE(), INTERVAL 3 DAY))\r\n      and event_timestamp = user_first_touch_timestamp\r\ngroup by geo.country, app_info.id\r\n),\r\n\r\nlast_week_users as\r\n(\r\nselect geo.country as country, app_info.id, count(distinct user_pseudo_id) last_week_users\r\nFROM {{ref(\'events\')}}\r\nWHERE event_date <= FORMAT_DATE("%Y%m%d", DATE_TRUNC(CURRENT_DATE(), WEEK))\r\n      AND event_date > FORMAT_DATE("%Y%m%d", DATE_SUB(DATE_TRUNC(CURRENT_DATE(), WEEK), INTERVAL 1 WEEK))\r\n      and event_timestamp = user_first_touch_timestamp\r\ngroup by geo.country,app_info.id),\r\n\r\nprevious_week_users as\r\n(\r\nselect geo.country as country, app_info.id, count(distinct user_pseudo_id) prev_week_users\r\nFROM {{ref(\'events\')}}\r\nWHERE event_date <= FORMAT_DATE("%Y%m%d", DATE_SUB(DATE_TRUNC(CURRENT_DATE(), WEEK), INTERVAL 1 WEEK))\r\n      AND event_date > FORMAT_DATE("%Y%m%d", DATE_SUB(DATE_TRUNC(CURRENT_DATE(), WEEK), INTERVAL 2 WEEK))\r\n      and event_timestamp = user_first_touch_timestamp\r\ngroup by geo.country, app_info.id)\r\n\r\n\r\nselect lwu.country, struct(lwu.id) as app_info, ynu.yesterday_new_users, pdnu.prev_day_new_users, tdnu.three_day_ago_new_users ,lwu.last_week_users, pwu.prev_week_users\r\nfrom last_week_users lwu\r\nleft join yesterday_new_users ynu\r\non lwu.country = ynu.country\r\nand lwu.id = ynu.id\r\nleft join prev_day_new_users pdnu\r\non lwu.country = pdnu.country\r\nand lwu.id = pdnu.id\r\nleft join three_day_ago_new_users tdnu\r\non lwu.country = tdnu.country\r\nand lwu.id = tdnu.id\r\nleft join previous_week_users pwu\r\non lwu.country = pwu.country\r\nand lwu.id = pwu.id\nlimit 100', 'compiled_sql': 'with yesterday_new_users as \n(\nselect geo.country as country, app_info.id, count(distinct user_pseudo_id) yesterday_new_users\nFROM `bamboodata-project`.`dbt_hdumon`.`events`\nWHERE event_date = FORMAT_DATE("%Y%m%d", DATE_SUB(CURRENT_DATE(), INTERVAL 1 DAY))\n      and event_timestamp = user_first_touch_timestamp\ngroup by geo.country, app_info.id\n),\n\nprev_day_new_users as\n(\nselect geo.country as country, app_info.id, count(distinct user_pseudo_id) prev_day_new_users\nFROM `bamboodata-project`.`dbt_hdumon`.`events`\nWHERE event_date = FORMAT_DATE("%Y%m%d", DATE_SUB(CURRENT_DATE(), INTERVAL 2 DAY))\n      and event_timestamp = user_first_touch_timestamp\ngroup by geo.country, app_info.id\n),\n\nthree_day_ago_new_users as\n(\nselect geo.country as country, app_info.id, count(distinct user_pseudo_id) three_day_ago_new_users\nFROM `bamboodata-project`.`dbt_hdumon`.`events`\nWHERE event_date = FORMAT_DATE("%Y%m%d", DATE_SUB(CURRENT_DATE(), INTERVAL 3 DAY))\n      and event_timestamp = user_first_touch_timestamp\ngroup by geo.country, app_info.id\n),\n\nlast_week_users as\n(\nselect geo.country as country, app_info.id, count(distinct user_pseudo_id) last_week_users\nFROM `bamboodata-project`.`dbt_hdumon`.`events`\nWHERE event_date <= FORMAT_DATE("%Y%m%d", DATE_TRUNC(CURRENT_DATE(), WEEK))\n      AND event_date > FORMAT_DATE("%Y%m%d", DATE_SUB(DATE_TRUNC(CURRENT_DATE(), WEEK), INTERVAL 1 WEEK))\n      and event_timestamp = user_first_touch_timestamp\ngroup by geo.country,app_info.id),\n\nprevious_week_users as\n(\nselect geo.country as country, app_info.id, count(distinct user_pseudo_id) prev_week_users\nFROM `bamboodata-project`.`dbt_hdumon`.`events`\nWHERE event_date <= FORMAT_DATE("%Y%m%d", DATE_SUB(DATE_TRUNC(CURRENT_DATE(), WEEK), INTERVAL 1 WEEK))\n      AND event_date > FORMAT_DATE("%Y%m%d", DATE_SUB(DATE_TRUNC(CURRENT_DATE(), WEEK), INTERVAL 2 WEEK))\n      and event_timestamp = user_first_touch_timestamp\ngroup by geo.country, app_info.id)\n\n\nselect lwu.country, struct(lwu.id) as app_info, ynu.yesterday_new_users, pdnu.prev_day_new_users, tdnu.three_day_ago_new_users ,lwu.last_week_users, pwu.prev_week_users\nfrom last_week_users lwu\nleft join yesterday_new_users ynu\non lwu.country = ynu.country\nand lwu.id = ynu.id\nleft join prev_day_new_users pdnu\non lwu.country = pdnu.country\nand lwu.id = pdnu.id\nleft join three_day_ago_new_users tdnu\non lwu.country = tdnu.country\nand lwu.id = tdnu.id\nleft join previous_week_users pwu\non lwu.country = pwu.country\nand lwu.id = pwu.id\nlimit 100', 'tags': None}, None)
2020-09-27 15:33:23.891717 (Thread-41): handling poll request
2020-09-27 15:33:23.892234 (Thread-41): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'a48143b7-69f2-44ce-9c93-64a5ba3d81a4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1498462e10>]}
2020-09-27 15:33:23.895280 (Thread-41): sending response (<Response 27579 bytes [200 OK]>) to 10.0.44.9
2020-09-27 15:33:25.333411 (Thread-42): handling poll request
2020-09-27 15:33:25.333892 (Thread-42): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'a48143b7-69f2-44ce-9c93-64a5ba3d81a4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f149875ef98>]}
2020-09-27 15:33:25.334878 (Thread-42): sending response (<Response 32736 bytes [200 OK]>) to 10.0.2.56
2020-09-27 15:33:39.773578 (Thread-43): handling status request
2020-09-27 15:33:39.775455 (Thread-43): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'a48143b7-69f2-44ce-9c93-64a5ba3d81a4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f14987e9f60>]}
2020-09-27 15:33:39.776693 (Thread-43): sending response (<Response 1446 bytes [200 OK]>) to 10.0.2.56
2020-09-27 15:33:40.097802 (Thread-44): handling run_sql request
2020-09-27 15:33:40.098285 (Thread-44): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'a48143b7-69f2-44ce-9c93-64a5ba3d81a4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f149824d080>]}
2020-09-27 15:33:41.057564 (Thread-44): sending response (<Response 137 bytes [200 OK]>) to 10.0.12.156
2020-09-27 15:33:41.078873 (MainThread): Acquiring new bigquery connection "rpc.bamboodata.request".
2020-09-27 15:33:41.079307 (MainThread): Opening a new connection, currently in state init
2020-09-27 15:33:41.108276 (MainThread): Found 2 models, 0 tests, 0 snapshots, 0 analyses, 147 macros, 0 operations, 0 seed files, 0 sources
2020-09-27 15:33:41.108971 (Thread-1): Acquiring new bigquery connection "rpc.bamboodata.request".
2020-09-27 15:33:41.109075 (Thread-1): Opening a new connection, currently in state init
2020-09-27 15:33:41.109200 (Thread-1): Compiling rpc.bamboodata.request
2020-09-27 15:33:41.123705 (Thread-1): finished collecting timing info
2020-09-27 15:33:41.124608 (Thread-1): On rpc.bamboodata.request: 


SELECT format_date( "%Y%m%d" ,date_add(PARSE_DATE("%Y%m%d",event_date), interval (select date_diff(current_date, PARSE_DATE("%Y%m%d",max(event_date)),day) FROM `bamboodata-project.analytics_220006363.events_an_purchases`) day)) event_date 
       ,event_timestamp + (select date_diff(current_date, PARSE_DATE("%Y%m%d",max(event_date)),day) FROM `bamboodata-project.analytics_220006363.events_an_purchases`) * 3600*24*1000000 as event_timestamp
       ,user_first_touch_timestamp + (select date_diff(current_date, PARSE_DATE("%Y%m%d",max(event_date)),day) FROM `bamboodata-project.analytics_220006363.events_an_purchases`) * 3600*24*1000000 as user_first_touch_timestamp,

* EXCEPT(event_date, event_timestamp, user_first_touch_timestamp)
FROM `bamboodata-project.analytics_220006363.events_an_purchases`
order by event_timestamp desc


limit 100
2020-09-27 15:33:41.478035 (Thread-45): handling poll request
2020-09-27 15:33:41.478553 (Thread-45): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'a48143b7-69f2-44ce-9c93-64a5ba3d81a4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f149843b518>]}
2020-09-27 15:33:41.480861 (Thread-45): sending response (<Response 3669 bytes [200 OK]>) to 10.0.24.187
2020-09-27 15:33:42.974817 (Thread-46): handling poll request
2020-09-27 15:33:42.975290 (Thread-46): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'a48143b7-69f2-44ce-9c93-64a5ba3d81a4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1498680b00>]}
2020-09-27 15:33:42.976292 (Thread-46): sending response (<Response 383 bytes [200 OK]>) to 10.0.5.150
2020-09-27 15:33:44.298531 (Thread-47): handling poll request
2020-09-27 15:33:44.300882 (Thread-47): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'a48143b7-69f2-44ce-9c93-64a5ba3d81a4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f14986805f8>]}
2020-09-27 15:33:44.301927 (Thread-47): sending response (<Response 384 bytes [200 OK]>) to 10.0.36.169
2020-09-27 15:33:45.605640 (Thread-48): handling poll request
2020-09-27 15:33:45.606163 (Thread-48): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'a48143b7-69f2-44ce-9c93-64a5ba3d81a4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1498680f60>]}
2020-09-27 15:33:45.607140 (Thread-48): sending response (<Response 384 bytes [200 OK]>) to 10.0.5.150
2020-09-27 15:33:47.071130 (Thread-49): handling poll request
2020-09-27 15:33:47.071616 (Thread-49): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'a48143b7-69f2-44ce-9c93-64a5ba3d81a4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1498462cc0>]}
2020-09-27 15:33:47.072584 (Thread-49): sending response (<Response 384 bytes [200 OK]>) to 10.0.12.156
2020-09-27 15:33:47.701288 (Thread-1): finished collecting timing info
2020-09-27 15:33:48.398504 (Thread-50): handling poll request
2020-09-27 15:33:48.399011 (Thread-50): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'a48143b7-69f2-44ce-9c93-64a5ba3d81a4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f14986806a0>]}
2020-09-27 15:33:48.405799 (Thread-50): sending response (<Response 233767 bytes [200 OK]>) to 10.0.24.187
2020-09-27 15:34:49.193361 (Thread-51): handling status request
2020-09-27 15:34:49.195291 (Thread-51): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'a48143b7-69f2-44ce-9c93-64a5ba3d81a4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f14985689e8>]}
2020-09-27 15:34:49.196506 (Thread-51): sending response (<Response 1446 bytes [200 OK]>) to 10.0.27.68
2020-09-27 15:34:49.327661 (Thread-52): handling status request
2020-09-27 15:34:49.328127 (Thread-52): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'a48143b7-69f2-44ce-9c93-64a5ba3d81a4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1498568668>]}
2020-09-27 15:34:49.329501 (Thread-52): sending response (<Response 1446 bytes [200 OK]>) to 10.0.18.102
2020-09-27 15:34:49.607058 (Thread-53): handling cli_args request
2020-09-27 15:34:49.607582 (Thread-53): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'a48143b7-69f2-44ce-9c93-64a5ba3d81a4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1498568668>]}
2020-09-27 15:34:49.618655 (Thread-53): API Exception: {'type': 'TypeError', 'args': ('dbt: error: unrecognized arguments: -- models events\n',), 'message': 'dbt: error: unrecognized arguments: -- models events\n'}
Traceback (most recent call last):
  File "/usr/local/lib/python3.6/dist-packages/jsonrpc/manager.py", line 113, in _get_responses
    result = method(*request.args, **request.kwargs)
  File "/usr/local/lib/python3.6/dist-packages/dbt/rpc/task_handler.py", line 501, in __call__
    return self.handle(kwargs)
  File "/usr/local/lib/python3.6/dist-packages/dbt/rpc/task_handler.py", line 464, in handle
    self.task.set_args(self.task_params)
  File "/usr/local/lib/python3.6/dist-packages/dbt/task/rpc/cli.py", line 59, in set_args
    self.args = parse_args(split, RPCArgumentParser)
  File "/usr/local/lib/python3.6/dist-packages/dbt/main.py", line 905, in parse_args
    parsed = p.parse_args(args)
  File "/usr/lib/python3.6/argparse.py", line 1746, in parse_args
    self.error(msg % ' '.join(argv))
  File "/usr/lib/python3.6/argparse.py", line 2402, in error
    self.exit(2, _('%(prog)s: error: %(message)s\n') % args)
  File "/usr/local/lib/python3.6/dist-packages/dbt/main.py", line 73, in exit
    raise TypeError(message)
TypeError: dbt: error: unrecognized arguments: -- models events
2020-09-27 15:34:49.620052 (Thread-53): sending response (<Response 292 bytes [200 OK]>) to 10.0.24.187
2020-09-27 15:55:43.844271 (Thread-54): handling status request
2020-09-27 15:55:43.844770 (Thread-54): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'a48143b7-69f2-44ce-9c93-64a5ba3d81a4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1498342748>]}
2020-09-27 15:55:43.846040 (Thread-54): sending response (<Response 1446 bytes [200 OK]>) to 10.0.5.150
2020-09-27 15:55:43.849207 (Thread-55): handling ps request
2020-09-27 15:55:43.849574 (Thread-55): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'a48143b7-69f2-44ce-9c93-64a5ba3d81a4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f149853e1d0>]}
2020-09-27 15:55:43.853094 (Thread-55): sending response (<Response 3543 bytes [200 OK]>) to 10.0.12.156
2020-09-27 15:55:50.960894 (Thread-56): handling status request
2020-09-27 15:55:50.962884 (Thread-56): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'a48143b7-69f2-44ce-9c93-64a5ba3d81a4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f14984a1710>]}
2020-09-27 15:55:50.964075 (Thread-56): sending response (<Response 1446 bytes [200 OK]>) to 10.0.38.179
2020-09-27 15:55:51.066515 (Thread-57): handling status request
2020-09-27 15:55:51.066949 (Thread-57): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'a48143b7-69f2-44ce-9c93-64a5ba3d81a4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f14985c69e8>]}
2020-09-27 15:55:51.068112 (Thread-57): sending response (<Response 1446 bytes [200 OK]>) to 10.0.36.169
2020-09-27 15:55:51.391873 (Thread-58): handling cli_args request
2020-09-27 15:55:51.392354 (Thread-58): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'a48143b7-69f2-44ce-9c93-64a5ba3d81a4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f149875ef98>]}
2020-09-27 15:55:52.345035 (Thread-58): sending response (<Response 137 bytes [200 OK]>) to 10.0.27.68
2020-09-27 15:55:52.404888 (MainThread): Partial parsing not enabled
2020-09-27 15:55:52.406868 (MainThread): Parsing macros/core.sql
2020-09-27 15:55:52.411577 (MainThread): Parsing macros/materializations/helpers.sql
2020-09-27 15:55:52.419655 (MainThread): Parsing macros/materializations/common/merge.sql
2020-09-27 15:55:52.434120 (MainThread): Parsing macros/materializations/table/table.sql
2020-09-27 15:55:52.441003 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2020-09-27 15:55:52.446052 (MainThread): Parsing macros/materializations/view/view.sql
2020-09-27 15:55:52.452444 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2020-09-27 15:55:52.481025 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2020-09-27 15:55:52.498092 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2020-09-27 15:55:52.500023 (MainThread): Parsing macros/materializations/seed/seed.sql
2020-09-27 15:55:52.521646 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2020-09-27 15:55:52.528055 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2020-09-27 15:55:52.530043 (MainThread): Parsing macros/etc/query.sql
2020-09-27 15:55:52.531188 (MainThread): Parsing macros/etc/get_custom_schema.sql
2020-09-27 15:55:52.533430 (MainThread): Parsing macros/etc/get_custom_alias.sql
2020-09-27 15:55:52.534507 (MainThread): Parsing macros/etc/datetime.sql
2020-09-27 15:55:52.544058 (MainThread): Parsing macros/etc/get_custom_database.sql
2020-09-27 15:55:52.545892 (MainThread): Parsing macros/etc/is_incremental.sql
2020-09-27 15:55:52.547688 (MainThread): Parsing macros/adapters/common.sql
2020-09-27 15:55:52.597839 (MainThread): Parsing macros/schema_tests/relationships.sql
2020-09-27 15:55:52.599157 (MainThread): Parsing macros/schema_tests/unique.sql
2020-09-27 15:55:52.600351 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2020-09-27 15:55:52.602465 (MainThread): Parsing macros/schema_tests/not_null.sql
2020-09-27 15:55:52.603753 (MainThread): Parsing macros/adapters.sql
2020-09-27 15:55:52.620523 (MainThread): Parsing macros/catalog.sql
2020-09-27 15:55:52.626674 (MainThread): Parsing macros/etc.sql
2020-09-27 15:55:52.627403 (MainThread): Parsing macros/materializations/incremental.sql
2020-09-27 15:55:52.640602 (MainThread): Parsing macros/materializations/snapshot.sql
2020-09-27 15:55:52.642553 (MainThread): Parsing macros/materializations/seed.sql
2020-09-27 15:55:52.645394 (MainThread): Parsing macros/materializations/table.sql
2020-09-27 15:55:52.655610 (MainThread): Parsing macros/materializations/view.sql
2020-09-27 15:55:52.661662 (MainThread): Partial parsing not enabled
2020-09-27 15:55:52.706562 (MainThread): Acquiring new bigquery connection "model.bamboodata.bbd_country_user_progress".
2020-09-27 15:55:52.706674 (MainThread): Opening a new connection, currently in state init
2020-09-27 15:55:52.741746 (MainThread): Acquiring new bigquery connection "model.bamboodata.events".
2020-09-27 15:55:52.741854 (MainThread): Opening a new connection, currently in state closed
2020-09-27 15:55:52.792908 (Thread-59): handling poll request
2020-09-27 15:55:52.793452 (Thread-59): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'a48143b7-69f2-44ce-9c93-64a5ba3d81a4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1498508e80>]}
2020-09-27 15:55:52.798393 (Thread-59): sending response (<Response 10505 bytes [200 OK]>) to 10.0.3.121
2020-09-27 15:55:52.908589 (MainThread): WARNING: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.output
- models.base

2020-09-27 15:55:52.946066 (MainThread): Found 2 models, 0 tests, 0 snapshots, 0 analyses, 147 macros, 0 operations, 0 seed files, 0 sources
2020-09-27 15:55:52.946723 (MainThread): 
2020-09-27 15:55:52.947035 (MainThread): Acquiring new bigquery connection "master".
2020-09-27 15:55:52.947107 (MainThread): Opening a new connection, currently in state closed
2020-09-27 15:55:52.950396 (ThreadPoolExecutor-0_0): Acquiring new bigquery connection "list_bamboodata-project".
2020-09-27 15:55:52.950489 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2020-09-27 15:55:53.149829 (ThreadPoolExecutor-0_0): Acquiring new bigquery connection "create_bamboodata-project_dbt_hdumon".
2020-09-27 15:55:53.149961 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state closed
2020-09-27 15:55:53.150144 (ThreadPoolExecutor-0_0): Acquiring new bigquery connection "create_bamboodata-project_dbt_hdumon".
2020-09-27 15:55:53.150200 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state closed
2020-09-27 15:55:53.150251 (ThreadPoolExecutor-0_0): Creating schema "bamboodata-project.dbt_hdumon".
2020-09-27 15:55:53.150827 (ThreadPoolExecutor-0_0): Client.dataset is deprecated and will be removed in a future version. Use a string like 'my_project.my_dataset' or a cloud.google.bigquery.DatasetReference object, instead.
2020-09-27 15:55:53.453643 (MainThread): Connection 'master' was properly closed.
2020-09-27 15:55:53.453767 (MainThread): Connection 'create_bamboodata-project_dbt_hdumon' was properly closed.
2020-09-27 15:55:53.453829 (MainThread): dbt runtime exception
Traceback (most recent call last):
  File "/usr/local/lib/python3.6/dist-packages/dbt/adapters/bigquery/connections.py", line 85, in exception_handler
    yield
  File "/usr/local/lib/python3.6/dist-packages/dbt/adapters/bigquery/connections.py", line 364, in _retry_and_handle
    deadline=None)
  File "/usr/local/lib/python3.6/dist-packages/google/api_core/retry.py", line 184, in retry_target
    return target()
  File "/usr/local/lib/python3.6/dist-packages/dbt/adapters/bigquery/connections.py", line 345, in fn
    return client.create_dataset(dataset, exists_ok=True)
  File "/usr/local/lib/python3.6/dist-packages/google/cloud/bigquery/client.py", line 461, in create_dataset
    retry, method="POST", path=path, data=data, timeout=timeout
  File "/usr/local/lib/python3.6/dist-packages/google/cloud/bigquery/client.py", line 556, in _call_api
    return call()
  File "/usr/local/lib/python3.6/dist-packages/google/api_core/retry.py", line 286, in retry_wrapped_func
    on_error=on_error,
  File "/usr/local/lib/python3.6/dist-packages/google/api_core/retry.py", line 184, in retry_target
    return target()
  File "/usr/local/lib/python3.6/dist-packages/google/cloud/_http.py", line 423, in api_request
    raise exceptions.from_http_response(response)
google.api_core.exceptions.Forbidden: 403 POST https://bigquery.googleapis.com/bigquery/v2/projects/bamboodata-project/datasets: Access Denied: Project bamboodata-project: User does not have bigquery.datasets.create permission in project bamboodata-project.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/usr/local/lib/python3.6/dist-packages/dbt/rpc/task_handler.py", line 95, in task_exec
    result = self.task.handle_request()
  File "/usr/local/lib/python3.6/dist-packages/dbt/task/rpc/cli.py", line 110, in handle_request
    return self.real_task.handle_request()
  File "/usr/local/lib/python3.6/dist-packages/dbt/task/rpc/project_commands.py", line 54, in handle_request
    return self.run()
  File "/usr/local/lib/python3.6/dist-packages/dbt/task/runnable.py", line 410, in run
    result = self.execute_with_hooks(selected_uids)
  File "/usr/local/lib/python3.6/dist-packages/dbt/task/runnable.py", line 370, in execute_with_hooks
    self.before_run(adapter, selected_uids)
  File "/usr/local/lib/python3.6/dist-packages/dbt/task/run.py", line 203, in before_run
    self.create_schemas(adapter, selected_uids)
  File "/usr/local/lib/python3.6/dist-packages/dbt/task/runnable.py", line 514, in create_schemas
    create_future.result()
  File "/usr/lib/python3.6/concurrent/futures/_base.py", line 425, in result
    return self.__get_result()
  File "/usr/lib/python3.6/concurrent/futures/_base.py", line 384, in __get_result
    raise self._exception
  File "/usr/lib/python3.6/concurrent/futures/thread.py", line 56, in run
    result = self.fn(*self.args, **self.kwargs)
  File "/usr/local/lib/python3.6/dist-packages/dbt/utils.py", line 526, in connected
    return func(*args, **kwargs)
  File "/usr/local/lib/python3.6/dist-packages/dbt/task/runnable.py", line 476, in create_schema
    adapter.create_schema(relation)
  File "/usr/local/lib/python3.6/dist-packages/dbt/adapters/bigquery/impl.py", line 267, in create_schema
    self.connections.create_dataset(database, schema)
  File "/usr/local/lib/python3.6/dist-packages/dbt/adapters/bigquery/connections.py", line 346, in create_dataset
    self._retry_and_handle(msg='create dataset', conn=conn, fn=fn)
  File "/usr/local/lib/python3.6/dist-packages/dbt/adapters/bigquery/connections.py", line 364, in _retry_and_handle
    deadline=None)
  File "/usr/lib/python3.6/contextlib.py", line 99, in __exit__
    self.gen.throw(type, value, traceback)
  File "/usr/local/lib/python3.6/dist-packages/dbt/adapters/bigquery/connections.py", line 93, in exception_handler
    self.handle_error(e, message)
  File "/usr/local/lib/python3.6/dist-packages/dbt/adapters/bigquery/connections.py", line 77, in handle_error
    raise DatabaseException(error_msg)
dbt.exceptions.DatabaseException: Database Error
  Access Denied: Project bamboodata-project: User does not have bigquery.datasets.create permission in project bamboodata-project.
2020-09-27 15:55:54.248155 (Thread-60): handling poll request
2020-09-27 15:55:54.248634 (Thread-60): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'a48143b7-69f2-44ce-9c93-64a5ba3d81a4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f149846a5c0>]}
2020-09-27 15:55:54.249917 (Thread-60): sending response (<Response 18632 bytes [200 OK]>) to 10.0.38.179
2020-09-27 15:55:54.688258 (Thread-61): handling status request
2020-09-27 15:55:54.688738 (Thread-61): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'a48143b7-69f2-44ce-9c93-64a5ba3d81a4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f149847f278>]}
2020-09-27 15:55:54.690058 (Thread-61): sending response (<Response 1446 bytes [200 OK]>) to 10.0.3.121
2020-09-27 15:58:47.031555 (Thread-62): handling status request
2020-09-27 15:58:47.033821 (Thread-62): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'a48143b7-69f2-44ce-9c93-64a5ba3d81a4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f14985b1f60>]}
2020-09-27 15:58:47.035030 (Thread-62): sending response (<Response 1446 bytes [200 OK]>) to 10.0.5.150
2020-09-27 15:58:47.069041 (Thread-63): handling status request
2020-09-27 15:58:47.069541 (Thread-63): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'a48143b7-69f2-44ce-9c93-64a5ba3d81a4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f14985b1f60>]}
2020-09-27 15:58:47.070852 (Thread-63): sending response (<Response 1446 bytes [200 OK]>) to 10.0.38.179
2020-09-27 15:58:47.370432 (Thread-64): handling cli_args request
2020-09-27 15:58:47.370924 (Thread-64): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'a48143b7-69f2-44ce-9c93-64a5ba3d81a4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f14985b1828>]}
2020-09-27 15:58:48.341209 (Thread-64): sending response (<Response 137 bytes [200 OK]>) to 10.0.27.68
2020-09-27 15:58:48.399588 (MainThread): Partial parsing not enabled
2020-09-27 15:58:48.401572 (MainThread): Parsing macros/core.sql
2020-09-27 15:58:48.406308 (MainThread): Parsing macros/materializations/helpers.sql
2020-09-27 15:58:48.414367 (MainThread): Parsing macros/materializations/common/merge.sql
2020-09-27 15:58:48.428835 (MainThread): Parsing macros/materializations/table/table.sql
2020-09-27 15:58:48.435700 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2020-09-27 15:58:48.440726 (MainThread): Parsing macros/materializations/view/view.sql
2020-09-27 15:58:48.447146 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2020-09-27 15:58:48.475701 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2020-09-27 15:58:48.492495 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2020-09-27 15:58:48.494382 (MainThread): Parsing macros/materializations/seed/seed.sql
2020-09-27 15:58:48.515932 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2020-09-27 15:58:48.522347 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2020-09-27 15:58:48.524314 (MainThread): Parsing macros/etc/query.sql
2020-09-27 15:58:48.525517 (MainThread): Parsing macros/etc/get_custom_schema.sql
2020-09-27 15:58:48.527670 (MainThread): Parsing macros/etc/get_custom_alias.sql
2020-09-27 15:58:48.528716 (MainThread): Parsing macros/etc/datetime.sql
2020-09-27 15:58:48.537883 (MainThread): Parsing macros/etc/get_custom_database.sql
2020-09-27 15:58:48.539632 (MainThread): Parsing macros/etc/is_incremental.sql
2020-09-27 15:58:48.541424 (MainThread): Parsing macros/adapters/common.sql
2020-09-27 15:58:48.591385 (MainThread): Parsing macros/schema_tests/relationships.sql
2020-09-27 15:58:48.592726 (MainThread): Parsing macros/schema_tests/unique.sql
2020-09-27 15:58:48.593984 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2020-09-27 15:58:48.596057 (MainThread): Parsing macros/schema_tests/not_null.sql
2020-09-27 15:58:48.597383 (MainThread): Parsing macros/adapters.sql
2020-09-27 15:58:48.614119 (MainThread): Parsing macros/catalog.sql
2020-09-27 15:58:48.620244 (MainThread): Parsing macros/etc.sql
2020-09-27 15:58:48.620967 (MainThread): Parsing macros/materializations/incremental.sql
2020-09-27 15:58:48.634217 (MainThread): Parsing macros/materializations/snapshot.sql
2020-09-27 15:58:48.636174 (MainThread): Parsing macros/materializations/seed.sql
2020-09-27 15:58:48.638989 (MainThread): Parsing macros/materializations/table.sql
2020-09-27 15:58:48.649058 (MainThread): Parsing macros/materializations/view.sql
2020-09-27 15:58:48.654937 (MainThread): Partial parsing not enabled
2020-09-27 15:58:48.700408 (MainThread): Acquiring new bigquery connection "model.bamboodata.bbd_country_user_progress".
2020-09-27 15:58:48.700526 (MainThread): Opening a new connection, currently in state init
2020-09-27 15:58:48.735325 (MainThread): Acquiring new bigquery connection "model.bamboodata.events".
2020-09-27 15:58:48.735434 (MainThread): Opening a new connection, currently in state closed
2020-09-27 15:58:48.780827 (Thread-65): handling poll request
2020-09-27 15:58:48.781370 (Thread-65): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'a48143b7-69f2-44ce-9c93-64a5ba3d81a4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1498196390>]}
2020-09-27 15:58:48.786680 (Thread-65): sending response (<Response 10505 bytes [200 OK]>) to 10.0.12.102
2020-09-27 15:58:48.895070 (MainThread): WARNING: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.output
- models.base

2020-09-27 15:58:48.928364 (MainThread): Found 2 models, 0 tests, 0 snapshots, 0 analyses, 147 macros, 0 operations, 0 seed files, 0 sources
2020-09-27 15:58:48.928985 (MainThread): 
2020-09-27 15:58:48.929305 (MainThread): Acquiring new bigquery connection "master".
2020-09-27 15:58:48.929373 (MainThread): Opening a new connection, currently in state closed
2020-09-27 15:58:48.932509 (ThreadPoolExecutor-0_0): Acquiring new bigquery connection "list_bamboodata-project".
2020-09-27 15:58:48.932598 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2020-09-27 15:58:49.139228 (ThreadPoolExecutor-0_0): Acquiring new bigquery connection "create_bamboodata-project_dbt_hdumon".
2020-09-27 15:58:49.139362 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state closed
2020-09-27 15:58:49.139579 (ThreadPoolExecutor-0_0): Acquiring new bigquery connection "create_bamboodata-project_dbt_hdumon".
2020-09-27 15:58:49.139643 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state closed
2020-09-27 15:58:49.139697 (ThreadPoolExecutor-0_0): Creating schema "bamboodata-project.dbt_hdumon".
2020-09-27 15:58:49.140331 (ThreadPoolExecutor-0_0): Client.dataset is deprecated and will be removed in a future version. Use a string like 'my_project.my_dataset' or a cloud.google.bigquery.DatasetReference object, instead.
2020-09-27 15:58:49.649032 (ThreadPoolExecutor-1_0): Acquiring new bigquery connection "list_bamboodata-project_dbt_hdumon".
2020-09-27 15:58:49.649187 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state closed
2020-09-27 15:58:49.649648 (ThreadPoolExecutor-1_0): Client.dataset is deprecated and will be removed in a future version. Use a string like 'my_project.my_dataset' or a cloud.google.bigquery.DatasetReference object, instead.
2020-09-27 15:58:49.852617 (MainThread): 15:58:49 | Concurrency: 1 threads (target='default')
2020-09-27 15:58:49.852773 (MainThread): 15:58:49 | 
2020-09-27 15:58:49.854696 (Thread-1): Began running node model.bamboodata.events
2020-09-27 15:58:49.856044 (Thread-1): 15:58:49 | 1 of 2 START view model dbt_hdumon.events............................ [RUN]
2020-09-27 15:58:49.856338 (Thread-1): Acquiring new bigquery connection "model.bamboodata.events".
2020-09-27 15:58:49.856406 (Thread-1): Opening a new connection, currently in state closed
2020-09-27 15:58:49.856487 (Thread-1): Compiling model.bamboodata.events
2020-09-27 15:58:49.859040 (Thread-1): unclosed <socket.socket fd=5, family=AddressFamily.AF_INET, type=2049, proto=6, laddr=('10.0.7.225', 38314), raddr=('172.217.8.10', 443)>
2020-09-27 15:58:49.859297 (Thread-1): unclosed <socket.socket fd=9, family=AddressFamily.AF_INET, type=2049, proto=6, laddr=('10.0.7.225', 38320), raddr=('172.217.8.10', 443)>
2020-09-27 15:58:49.859503 (Thread-1): unclosed <socket.socket fd=7, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=6, laddr=('10.0.7.225', 53372), raddr=('172.217.13.234', 443)>
2020-09-27 15:58:49.859737 (Thread-1): unclosed <socket.socket fd=12, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=6, laddr=('10.0.7.225', 43664), raddr=('172.217.13.74', 443)>
2020-09-27 15:58:49.859947 (Thread-1): unclosed <socket.socket fd=10, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=6, laddr=('10.0.7.225', 53378), raddr=('172.217.13.234', 443)>
2020-09-27 15:58:49.860125 (Thread-1): unclosed <socket.socket fd=11, family=AddressFamily.AF_INET, type=2049, proto=6, laddr=('10.0.7.225', 38330), raddr=('172.217.8.10', 443)>
2020-09-27 15:58:49.872906 (Thread-1): Writing injected SQL for node "model.bamboodata.events"
2020-09-27 15:58:49.910426 (Thread-1): finished collecting timing info
2020-09-27 15:58:49.941321 (Thread-1): Writing runtime SQL for node "model.bamboodata.events"
2020-09-27 15:58:49.980474 (Thread-1): On model.bamboodata.events: /* {"app": "dbt", "dbt_version": "0.17.2", "profile_name": "user", "target_name": "default", "node_id": "model.bamboodata.events"} */


  create or replace view `bamboodata-project`.`dbt_hdumon`.`events`
  OPTIONS()
  as SELECT format_date( "%Y%m%d" ,date_add(PARSE_DATE("%Y%m%d",event_date), interval (select date_diff(current_date, PARSE_DATE("%Y%m%d",max(event_date)),day) FROM `bamboodata-project.analytics_220006363.events_an_purchases`) day)) event_date 
       ,event_timestamp + (select date_diff(current_date, PARSE_DATE("%Y%m%d",max(event_date)),day) FROM `bamboodata-project.analytics_220006363.events_an_purchases`) * 3600*24*1000000 as event_timestamp
       ,user_first_touch_timestamp + (select date_diff(current_date, PARSE_DATE("%Y%m%d",max(event_date)),day) FROM `bamboodata-project.analytics_220006363.events_an_purchases`) * 3600*24*1000000 as user_first_touch_timestamp,

* EXCEPT(event_date, event_timestamp, user_first_touch_timestamp)
FROM `bamboodata-project.analytics_220006363.events_an_purchases`
order by event_timestamp desc;


2020-09-27 15:58:50.238604 (Thread-66): handling poll request
2020-09-27 15:58:50.239082 (Thread-66): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'a48143b7-69f2-44ce-9c93-64a5ba3d81a4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1498336c18>]}
2020-09-27 15:58:50.241045 (Thread-66): Checking header 'user-agent' tracing in whitelist set(), 24 additional messages skipped
2020-09-27 15:58:50.262658 (Thread-66): writing 1 spans (enabled:True), 38 additional messages skipped
2020-09-27 15:58:50.262840 (Thread-66): 
      name requests.request
        id 13516306960482774990
  trace_id 3395259619193716
 parent_id None
   service requests
  resource requests.request
      type http
     start 1601222330.240563
       end 1601222330.262555
  duration 0.021992s
     error 0
      tags 
           http.method:POST
           http.status_code:200
           http.url:https://fishtownanalytics.sinter-collect.com/com.snowplowanalytics.snowplow/tp2
           runtime-id:8671c46a3c914bbfa95f40976d37c7bc, 38 additional messages skipped
2020-09-27 15:58:50.267170 (Thread-66): sending response (<Response 9601 bytes [200 OK]>) to 10.0.2.56
2020-09-27 15:58:50.352736 (AgentWriter): reported 1 traces in 0.00438s, 1 additional messages skipped
2020-09-27 15:58:50.352978 (AgentWriter): initialized RateSampler, sample 100% of traces, 63 additional messages skipped
2020-09-27 15:58:51.209949 (Thread-1): finished collecting timing info
2020-09-27 15:58:51.210714 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '13186ca3-9a43-425c-9549-e3eaff2686f4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3e97cc1a20>]}
2020-09-27 15:58:51.211816 (Thread-1): 15:58:51 | 1 of 2 OK created view model dbt_hdumon.events....................... [CREATE VIEW in 1.35s]
2020-09-27 15:58:51.211917 (Thread-1): Finished running node model.bamboodata.events
2020-09-27 15:58:51.212527 (Thread-1): Began running node model.bamboodata.bbd_country_user_progress
2020-09-27 15:58:51.213516 (Thread-1): 15:58:51 | 2 of 2 START view model dbt_hdumon.bbd_country_user_progress......... [RUN]
2020-09-27 15:58:51.213758 (Thread-1): Acquiring new bigquery connection "model.bamboodata.bbd_country_user_progress".
2020-09-27 15:58:51.213822 (Thread-1): Opening a new connection, currently in state closed
2020-09-27 15:58:51.213887 (Thread-1): Compiling model.bamboodata.bbd_country_user_progress
2020-09-27 15:58:51.225802 (Thread-1): Writing injected SQL for node "model.bamboodata.bbd_country_user_progress"
2020-09-27 15:58:51.244563 (Thread-1): finished collecting timing info
2020-09-27 15:58:51.249083 (Thread-1): Writing runtime SQL for node "model.bamboodata.bbd_country_user_progress"
2020-09-27 15:58:51.268832 (Thread-1): On model.bamboodata.bbd_country_user_progress: /* {"app": "dbt", "dbt_version": "0.17.2", "profile_name": "user", "target_name": "default", "node_id": "model.bamboodata.bbd_country_user_progress"} */


  create or replace view `bamboodata-project`.`dbt_hdumon`.`bbd_country_user_progress`
  OPTIONS()
  as with yesterday_new_users as 
(
select geo.country as country, app_info.id, count(distinct user_pseudo_id) yesterday_new_users
FROM `bamboodata-project`.`dbt_hdumon`.`events`
WHERE event_date = FORMAT_DATE("%Y%m%d", DATE_SUB(CURRENT_DATE(), INTERVAL 1 DAY))
      and event_timestamp = user_first_touch_timestamp
group by geo.country, app_info.id
),

prev_day_new_users as
(
select geo.country as country, app_info.id, count(distinct user_pseudo_id) prev_day_new_users
FROM `bamboodata-project`.`dbt_hdumon`.`events`
WHERE event_date = FORMAT_DATE("%Y%m%d", DATE_SUB(CURRENT_DATE(), INTERVAL 2 DAY))
      and event_timestamp = user_first_touch_timestamp
group by geo.country, app_info.id
),

three_day_ago_new_users as
(
select geo.country as country, app_info.id, count(distinct user_pseudo_id) three_day_ago_new_users
FROM `bamboodata-project`.`dbt_hdumon`.`events`
WHERE event_date = FORMAT_DATE("%Y%m%d", DATE_SUB(CURRENT_DATE(), INTERVAL 3 DAY))
      and event_timestamp = user_first_touch_timestamp
group by geo.country, app_info.id
),

last_week_users as
(
select geo.country as country, app_info.id, count(distinct user_pseudo_id) last_week_users
FROM `bamboodata-project`.`dbt_hdumon`.`events`
WHERE event_date <= FORMAT_DATE("%Y%m%d", DATE_TRUNC(CURRENT_DATE(), WEEK))
      AND event_date > FORMAT_DATE("%Y%m%d", DATE_SUB(DATE_TRUNC(CURRENT_DATE(), WEEK), INTERVAL 1 WEEK))
      and event_timestamp = user_first_touch_timestamp
group by geo.country,app_info.id),

previous_week_users as
(
select geo.country as country, app_info.id, count(distinct user_pseudo_id) prev_week_users
FROM `bamboodata-project`.`dbt_hdumon`.`events`
WHERE event_date <= FORMAT_DATE("%Y%m%d", DATE_SUB(DATE_TRUNC(CURRENT_DATE(), WEEK), INTERVAL 1 WEEK))
      AND event_date > FORMAT_DATE("%Y%m%d", DATE_SUB(DATE_TRUNC(CURRENT_DATE(), WEEK), INTERVAL 2 WEEK))
      and event_timestamp = user_first_touch_timestamp
group by geo.country, app_info.id)


select lwu.country, struct(lwu.id) as app_info, ynu.yesterday_new_users, pdnu.prev_day_new_users, tdnu.three_day_ago_new_users ,lwu.last_week_users, pwu.prev_week_users
from last_week_users lwu
left join yesterday_new_users ynu
on lwu.country = ynu.country
and lwu.id = ynu.id
left join prev_day_new_users pdnu
on lwu.country = pdnu.country
and lwu.id = pdnu.id
left join three_day_ago_new_users tdnu
on lwu.country = tdnu.country
and lwu.id = tdnu.id
left join previous_week_users pwu
on lwu.country = pwu.country
and lwu.id = pwu.id;


2020-09-27 15:58:51.755609 (Thread-67): handling poll request
2020-09-27 15:58:51.756094 (Thread-67): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'a48143b7-69f2-44ce-9c93-64a5ba3d81a4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f14987c0048>]}
2020-09-27 15:58:51.758427 (Thread-67): sending response (<Response 8630 bytes [200 OK]>) to 10.0.12.156
2020-09-27 15:58:52.377498 (Thread-1): finished collecting timing info
2020-09-27 15:58:52.378265 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '13186ca3-9a43-425c-9549-e3eaff2686f4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3e96e149e8>]}
2020-09-27 15:58:52.379348 (Thread-1): 15:58:52 | 2 of 2 OK created view model dbt_hdumon.bbd_country_user_progress.... [CREATE VIEW in 1.16s]
2020-09-27 15:58:52.379448 (Thread-1): Finished running node model.bamboodata.bbd_country_user_progress
2020-09-27 15:58:52.458380 (MainThread): Acquiring new bigquery connection "master".
2020-09-27 15:58:52.458506 (MainThread): Opening a new connection, currently in state closed
2020-09-27 15:58:52.458773 (MainThread): 15:58:52 | 
2020-09-27 15:58:52.458847 (MainThread): 15:58:52 | Finished running 2 view models in 3.53s.
2020-09-27 15:58:52.458910 (MainThread): Connection 'master' was properly closed.
2020-09-27 15:58:52.458956 (MainThread): Connection 'model.bamboodata.bbd_country_user_progress' was properly closed.
2020-09-27 15:58:52.460688 (MainThread): unclosed <socket.socket fd=9, family=AddressFamily.AF_INET, type=2049, proto=6, laddr=('10.0.7.225', 38384), raddr=('172.217.8.10', 443)>
2020-09-27 15:58:52.460955 (MainThread): unclosed <socket.socket fd=10, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=6, laddr=('10.0.7.225', 53444), raddr=('172.217.13.234', 443)>
2020-09-27 15:58:52.497390 (MainThread): 
2020-09-27 15:58:52.497535 (MainThread): Completed successfully
2020-09-27 15:58:52.497604 (MainThread): 
Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
2020-09-27 15:58:53.074303 (Thread-68): handling poll request
2020-09-27 15:58:53.074777 (Thread-68): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'a48143b7-69f2-44ce-9c93-64a5ba3d81a4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f14983cbef0>]}
2020-09-27 15:58:53.083502 (Thread-68): sending response (<Response 18366 bytes [200 OK]>) to 10.0.12.156
2020-09-27 15:58:53.546147 (Thread-69): handling status request
2020-09-27 15:58:53.546632 (Thread-69): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'a48143b7-69f2-44ce-9c93-64a5ba3d81a4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f149851e0b8>]}
2020-09-27 15:58:53.547855 (Thread-69): sending response (<Response 1446 bytes [200 OK]>) to 10.0.34.126
2020-09-27 16:00:51.875766 (MainThread): writing 1 spans (enabled:True)
2020-09-27 16:00:51.877226 (MainThread): 
      name jinja2.compile
        id 11837277054609977574
  trace_id 13258680372155467313
 parent_id None
   service None
  resource <memory>
      type template
     start 1601222451.8748958
       end 1601222451.8755898
  duration 0.000694s
     error 0
      tags 
           jinja2.template_name:<memory>
           runtime-id:8671c46a3c914bbfa95f40976d37c7bc
2020-09-27 16:00:51.944619 (Thread-70): Got an acceptable cached parse result
2020-09-27 16:00:52.146939 (Thread-70): WARNING: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.base
- models.output

2020-09-27 16:00:52.374815 (AgentWriter): reported 36 traces in 0.00411s
2020-09-27 16:00:52.375066 (AgentWriter): initialized RateSampler, sample 100% of traces, 31 additional messages skipped
2020-09-27 16:00:52.785625 (Thread-71): handling status request
2020-09-27 16:00:52.786260 (Thread-71): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'a48143b7-69f2-44ce-9c93-64a5ba3d81a4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f149853db70>]}
2020-09-27 16:00:52.787374 (Thread-71): sending response (<Response 873 bytes [200 OK]>) to 10.0.12.102
2020-09-27 16:00:59.170616 (Thread-72): Got an acceptable cached parse result
2020-09-27 16:00:59.224080 (Thread-72): Acquiring new bigquery connection "model.bamboodata.bbd_events_all_days_unnested".
2020-09-27 16:00:59.224243 (Thread-72): Opening a new connection, currently in state init
2020-09-27 16:00:59.454231 (Thread-72): WARNING: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.base
- models.output

2020-09-27 16:00:59.490693 (Thread-73): handling status request
2020-09-27 16:00:59.491379 (Thread-73): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'a48143b7-69f2-44ce-9c93-64a5ba3d81a4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f149847e470>]}
2020-09-27 16:00:59.493268 (Thread-73): sending response (<Response 1468 bytes [200 OK]>) to 10.0.27.68
2020-09-27 16:01:07.681676 (MainThread): writing 1 spans (enabled:True), 71 additional messages skipped
2020-09-27 16:01:07.683390 (MainThread): 
      name jinja2.compile
        id 12777251979512134065
  trace_id 8709210100490120093
 parent_id None
   service None
  resource <memory>
      type template
     start 1601222467.680737
       end 1601222467.681467
  duration 0.000730s
     error 0
      tags 
           jinja2.template_name:<memory>
           runtime-id:8671c46a3c914bbfa95f40976d37c7bc, 71 additional messages skipped
2020-09-27 16:01:07.768726 (Thread-74): Got an acceptable cached parse result
2020-09-27 16:01:07.811869 (Thread-74): Acquiring new bigquery connection "model.bamboodata.bbd_events_all_days_unnested".
2020-09-27 16:01:07.812025 (Thread-74): Opening a new connection, currently in state closed
2020-09-27 16:01:08.130476 (Thread-74): WARNING: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.base
- models.output

2020-09-27 16:01:08.448787 (AgentWriter): reported 36 traces in 0.00664s, 1 additional messages skipped
2020-09-27 16:01:08.449056 (AgentWriter): initialized RateSampler, sample 100% of traces, 63 additional messages skipped
2020-09-27 16:01:08.774652 (Thread-75): handling status request
2020-09-27 16:01:08.775187 (Thread-75): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'a48143b7-69f2-44ce-9c93-64a5ba3d81a4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f14987c0278>]}
2020-09-27 16:01:08.776410 (Thread-75): sending response (<Response 1470 bytes [200 OK]>) to 10.0.44.9
2020-09-27 16:01:24.617924 (Thread-76): Got an acceptable cached parse result
2020-09-27 16:01:24.668279 (Thread-76): Acquiring new bigquery connection "model.bamboodata.bbd_events_all_days_unnested".
2020-09-27 16:01:24.668453 (Thread-76): Opening a new connection, currently in state closed
2020-09-27 16:01:24.678104 (Thread-77): handling status request
2020-09-27 16:01:24.678577 (Thread-77): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'a48143b7-69f2-44ce-9c93-64a5ba3d81a4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f149868c128>]}
2020-09-27 16:01:24.679278 (Thread-77): sending response (<Response 184 bytes [200 OK]>) to 10.0.27.68
2020-09-27 16:01:24.848459 (Thread-76): WARNING: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.base
- models.output

2020-09-27 16:01:26.187770 (Thread-78): handling status request
2020-09-27 16:01:26.188256 (Thread-78): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'a48143b7-69f2-44ce-9c93-64a5ba3d81a4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1498656a58>]}
2020-09-27 16:01:26.189524 (Thread-78): sending response (<Response 1470 bytes [200 OK]>) to 10.0.12.156
2020-09-27 16:01:37.431171 (Thread-79): Got an acceptable cached parse result
2020-09-27 16:01:37.704548 (Thread-79): WARNING: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.base
- models.output

2020-09-27 16:01:38.122988 (Thread-80): handling status request
2020-09-27 16:01:38.123656 (Thread-80): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'a48143b7-69f2-44ce-9c93-64a5ba3d81a4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1498479da0>]}
2020-09-27 16:01:38.125226 (Thread-80): sending response (<Response 873 bytes [200 OK]>) to 10.0.5.150
2020-09-27 16:01:44.764436 (Thread-81): Got an acceptable cached parse result
2020-09-27 16:01:44.831575 (Thread-81): Acquiring new bigquery connection "model.bamboodata.bbd_events_all_days".
2020-09-27 16:01:44.831796 (Thread-81): Opening a new connection, currently in state closed
2020-09-27 16:01:45.205904 (Thread-81): WARNING: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.base
- models.output

2020-09-27 16:01:45.985818 (Thread-82): handling status request
2020-09-27 16:01:45.986622 (Thread-82): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'a48143b7-69f2-44ce-9c93-64a5ba3d81a4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1498737198>]}
2020-09-27 16:01:45.988471 (Thread-82): sending response (<Response 1461 bytes [200 OK]>) to 10.0.38.179
2020-09-27 16:02:43.365240 (MainThread): writing 1 spans (enabled:True), 145 additional messages skipped
2020-09-27 16:02:43.366972 (MainThread): 
      name jinja2.compile
        id 2003382555609004877
  trace_id 11458365277729996585
 parent_id None
   service None
  resource <memory>
      type template
     start 1601222563.364247
       end 1601222563.3649971
  duration 0.000750s
     error 0
      tags 
           jinja2.template_name:<memory>
           runtime-id:8671c46a3c914bbfa95f40976d37c7bc, 145 additional messages skipped
2020-09-27 16:02:43.467906 (Thread-83): Got an acceptable cached parse result
2020-09-27 16:02:43.531789 (Thread-83): Acquiring new bigquery connection "model.bamboodata.bbd_events_all_days_unnested".
2020-09-27 16:02:43.532043 (Thread-83): Opening a new connection, currently in state closed
2020-09-27 16:02:43.542231 (AgentWriter): reported 36 traces in 0.03330s, 4 additional messages skipped
2020-09-27 16:02:43.542696 (AgentWriter): initialized RateSampler, sample 100% of traces, 159 additional messages skipped
2020-09-27 16:02:43.799047 (Thread-83): WARNING: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.base
- models.output

2020-09-27 16:02:44.108161 (Thread-84): handling status request
2020-09-27 16:02:44.108894 (Thread-84): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'a48143b7-69f2-44ce-9c93-64a5ba3d81a4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f14986b76d8>]}
2020-09-27 16:02:44.110880 (Thread-84): sending response (<Response 1470 bytes [200 OK]>) to 10.0.3.121
2020-09-27 16:02:57.146787 (Thread-85): Got an acceptable cached parse result
2020-09-27 16:02:57.219520 (Thread-85): Acquiring new bigquery connection "model.bamboodata.bbd_events_all_days_unnested".
2020-09-27 16:02:57.219735 (Thread-85): Opening a new connection, currently in state closed
2020-09-27 16:02:57.925798 (Thread-86): handling status request
2020-09-27 16:02:57.926470 (Thread-86): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'a48143b7-69f2-44ce-9c93-64a5ba3d81a4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f14983e6630>]}
2020-09-27 16:02:57.928237 (Thread-86): sending response (<Response 1274 bytes [200 OK]>) to 10.0.38.179
2020-09-27 16:03:33.156185 (MainThread): writing 1 spans (enabled:True), 73 additional messages skipped
2020-09-27 16:03:33.157825 (MainThread): 
      name jinja2.compile
        id 2212744502238661163
  trace_id 10312875543050430688
 parent_id None
   service None
  resource <memory>
      type template
     start 1601222613.1552992
       end 1601222613.1559901
  duration 0.000691s
     error 0
      tags 
           jinja2.template_name:<memory>
           runtime-id:8671c46a3c914bbfa95f40976d37c7bc, 73 additional messages skipped
2020-09-27 16:03:33.236085 (Thread-87): Got an acceptable cached parse result
2020-09-27 16:03:33.282137 (Thread-87): Acquiring new bigquery connection "model.bamboodata.bbd_events_all_days_unnested".
2020-09-27 16:03:33.282295 (Thread-87): Opening a new connection, currently in state closed
2020-09-27 16:03:33.460640 (Thread-87): WARNING: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.base
- models.output

2020-09-27 16:03:33.614092 (Thread-88): handling status request
2020-09-27 16:03:33.614575 (Thread-88): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'a48143b7-69f2-44ce-9c93-64a5ba3d81a4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f149845e978>]}
2020-09-27 16:03:33.615817 (Thread-88): sending response (<Response 1470 bytes [200 OK]>) to 10.0.17.64
2020-09-27 16:03:33.635298 (AgentWriter): reported 38 traces in 0.00453s, 1 additional messages skipped
2020-09-27 16:03:33.635516 (AgentWriter): initialized RateSampler, sample 100% of traces, 63 additional messages skipped
2020-09-27 16:04:18.280570 (MainThread): writing 1 spans (enabled:True), 37 additional messages skipped
2020-09-27 16:04:18.282174 (MainThread): 
      name jinja2.compile
        id 13246576451972962436
  trace_id 4629333583967525746
 parent_id None
   service None
  resource <memory>
      type template
     start 1601222658.279857
       end 1601222658.280392
  duration 0.000535s
     error 0
      tags 
           jinja2.template_name:<memory>
           runtime-id:8671c46a3c914bbfa95f40976d37c7bc, 37 additional messages skipped
2020-09-27 16:04:18.349389 (Thread-89): Got an acceptable cached parse result
2020-09-27 16:04:18.388322 (Thread-89): Acquiring new bigquery connection "model.bamboodata.bbd_events_all_days".
2020-09-27 16:04:18.388488 (Thread-89): Opening a new connection, currently in state closed
2020-09-27 16:04:18.648715 (AgentWriter): reported 38 traces in 0.00449s
2020-09-27 16:04:18.649049 (AgentWriter): initialized RateSampler, sample 100% of traces, 31 additional messages skipped
2020-09-27 16:04:18.720608 (Thread-89): WARNING: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.base
- models.output

2020-09-27 16:04:19.030217 (Thread-90): handling status request
2020-09-27 16:04:19.030877 (Thread-90): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'a48143b7-69f2-44ce-9c93-64a5ba3d81a4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1493687b00>]}
2020-09-27 16:04:19.032198 (Thread-90): sending response (<Response 1461 bytes [200 OK]>) to 10.0.5.150
2020-09-27 16:05:19.305959 (MainThread): writing 1 spans (enabled:True), 37 additional messages skipped
2020-09-27 16:05:19.307353 (MainThread): 
      name jinja2.compile
        id 13302753218560139130
  trace_id 18312273487150664571
 parent_id None
   service None
  resource <memory>
      type template
     start 1601222719.3052428
       end 1601222719.3058007
  duration 0.000558s
     error 0
      tags 
           jinja2.template_name:<memory>
           runtime-id:8671c46a3c914bbfa95f40976d37c7bc, 37 additional messages skipped
2020-09-27 16:05:19.371683 (Thread-91): Got an acceptable cached parse result
2020-09-27 16:05:19.560103 (Thread-91): WARNING: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.base
- models.output

2020-09-27 16:05:19.661477 (AgentWriter): reported 36 traces in 0.00425s
2020-09-27 16:05:19.661785 (AgentWriter): initialized RateSampler, sample 100% of traces, 31 additional messages skipped
2020-09-27 16:05:20.002851 (Thread-92): handling status request
2020-09-27 16:05:20.003339 (Thread-92): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'a48143b7-69f2-44ce-9c93-64a5ba3d81a4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f14983afd30>]}
2020-09-27 16:05:20.004339 (Thread-92): sending response (<Response 873 bytes [200 OK]>) to 10.0.24.187
2020-09-27 16:05:31.542100 (Thread-93): Got an acceptable cached parse result
2020-09-27 16:05:31.747984 (Thread-93): WARNING: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.base
- models.output

2020-09-27 16:05:31.964472 (Thread-94): handling status request
2020-09-27 16:05:31.964960 (Thread-94): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'a48143b7-69f2-44ce-9c93-64a5ba3d81a4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1498446438>]}
2020-09-27 16:05:31.966043 (Thread-94): sending response (<Response 873 bytes [200 OK]>) to 10.0.17.64
2020-09-27 16:05:46.025536 (Thread-95): Got an acceptable cached parse result
2020-09-27 16:05:46.286972 (Thread-96): handling status request
2020-09-27 16:05:46.287478 (Thread-96): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'a48143b7-69f2-44ce-9c93-64a5ba3d81a4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f149822e978>]}
2020-09-27 16:05:46.288260 (Thread-96): sending response (<Response 184 bytes [200 OK]>) to 10.0.18.102
2020-09-27 16:05:46.340110 (Thread-95): WARNING: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.base
- models.output

2020-09-27 16:05:47.751733 (Thread-97): handling status request
2020-09-27 16:05:47.752250 (Thread-97): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'a48143b7-69f2-44ce-9c93-64a5ba3d81a4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f14983bef28>]}
2020-09-27 16:05:47.753332 (Thread-97): sending response (<Response 873 bytes [200 OK]>) to 10.0.36.169
2020-09-27 16:05:52.699990 (Thread-98): Got an acceptable cached parse result
2020-09-27 16:05:52.751773 (Thread-98): Acquiring new bigquery connection "model.bamboodata.bbd_week_on_week_retention_rate".
2020-09-27 16:05:52.751929 (Thread-98): Opening a new connection, currently in state closed
2020-09-27 16:05:52.932332 (Thread-98): WARNING: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.base
- models.output

2020-09-27 16:05:53.105426 (Thread-99): handling status request
2020-09-27 16:05:53.105904 (Thread-99): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'a48143b7-69f2-44ce-9c93-64a5ba3d81a4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f14983df940>]}
2020-09-27 16:05:53.107152 (Thread-99): sending response (<Response 1473 bytes [200 OK]>) to 10.0.36.169
2020-09-27 16:06:26.367972 (MainThread): writing 1 spans (enabled:True), 143 additional messages skipped
2020-09-27 16:06:26.369336 (MainThread): 
      name jinja2.compile
        id 14264824213996126213
  trace_id 2074868095727705087
 parent_id None
   service None
  resource <memory>
      type template
     start 1601222786.367143
       end 1601222786.367771
  duration 0.000628s
     error 0
      tags 
           jinja2.template_name:<memory>
           runtime-id:8671c46a3c914bbfa95f40976d37c7bc, 143 additional messages skipped
2020-09-27 16:06:26.455873 (Thread-100): Got an acceptable cached parse result
2020-09-27 16:06:26.496501 (Thread-100): Acquiring new bigquery connection "model.bamboodata.bbd_week_on_week_retention_rate".
2020-09-27 16:06:26.496652 (Thread-100): Opening a new connection, currently in state closed
2020-09-27 16:06:26.679404 (Thread-100): WARNING: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.base
- models.output

2020-09-27 16:06:26.705048 (AgentWriter): reported 38 traces in 0.00472s, 4 additional messages skipped
2020-09-27 16:06:26.705356 (AgentWriter): initialized RateSampler, sample 100% of traces, 159 additional messages skipped
2020-09-27 16:06:26.817288 (Thread-101): handling status request
2020-09-27 16:06:26.817775 (Thread-101): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'a48143b7-69f2-44ce-9c93-64a5ba3d81a4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f14985b1a58>]}
2020-09-27 16:06:26.818997 (Thread-101): sending response (<Response 1477 bytes [200 OK]>) to 10.0.12.156
2020-09-27 16:06:31.690000 (Thread-102): Got an acceptable cached parse result
2020-09-27 16:06:32.079902 (Thread-103): handling status request
2020-09-27 16:06:32.080420 (Thread-103): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'a48143b7-69f2-44ce-9c93-64a5ba3d81a4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f149821b748>]}
2020-09-27 16:06:32.081282 (Thread-103): sending response (<Response 184 bytes [200 OK]>) to 10.0.47.163
2020-09-27 16:06:32.229721 (Thread-102): WARNING: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.base
- models.output

2020-09-27 16:06:33.545943 (Thread-104): handling status request
2020-09-27 16:06:33.546472 (Thread-104): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'a48143b7-69f2-44ce-9c93-64a5ba3d81a4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f14983d4ba8>]}
2020-09-27 16:06:33.547594 (Thread-104): sending response (<Response 875 bytes [200 OK]>) to 10.0.38.51
2020-09-27 16:06:39.798640 (Thread-105): Got an acceptable cached parse result
2020-09-27 16:06:39.843574 (Thread-105): Acquiring new bigquery connection "model.bamboodata.bbd_week_on_week_retention_rate".
2020-09-27 16:06:39.843732 (Thread-105): Opening a new connection, currently in state closed
2020-09-27 16:06:40.027903 (Thread-105): WARNING: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.base
- models.output

2020-09-27 16:06:40.346451 (Thread-106): handling status request
2020-09-27 16:06:40.346923 (Thread-106): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'a48143b7-69f2-44ce-9c93-64a5ba3d81a4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f149831bef0>]}
2020-09-27 16:06:40.348115 (Thread-106): sending response (<Response 1477 bytes [200 OK]>) to 10.0.12.102
2020-09-27 16:06:59.265022 (Thread-107): Got an acceptable cached parse result
2020-09-27 16:06:59.546539 (Thread-107): WARNING: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.base
- models.output

2020-09-27 16:06:59.560409 (Thread-108): handling status request
2020-09-27 16:06:59.560865 (Thread-108): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'a48143b7-69f2-44ce-9c93-64a5ba3d81a4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f14985f1400>]}
2020-09-27 16:06:59.561944 (Thread-108): sending response (<Response 875 bytes [200 OK]>) to 10.0.34.126
2020-09-27 16:07:03.790650 (Thread-109): handling status request
2020-09-27 16:07:03.792605 (Thread-109): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'a48143b7-69f2-44ce-9c93-64a5ba3d81a4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f149855e9e8>]}
2020-09-27 16:07:03.793714 (Thread-109): sending response (<Response 875 bytes [200 OK]>) to 10.0.12.156
2020-09-27 16:07:03.799653 (Thread-110): handling status request
2020-09-27 16:07:03.800007 (Thread-110): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'a48143b7-69f2-44ce-9c93-64a5ba3d81a4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f149855e9e8>]}
2020-09-27 16:07:03.800942 (Thread-110): sending response (<Response 875 bytes [200 OK]>) to 10.0.5.150
2020-09-27 16:07:04.266373 (Thread-111): handling cli_args request
2020-09-27 16:07:04.267036 (Thread-111): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'a48143b7-69f2-44ce-9c93-64a5ba3d81a4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1498312668>]}
2020-09-27 16:07:04.280584 (Thread-111): Connection 'model.bamboodata.bbd_week_on_week_retention_rate' was properly closed.
2020-09-27 16:07:05.292958 (Thread-111): sending response (<Response 137 bytes [200 OK]>) to 10.0.38.179
2020-09-27 16:07:05.352529 (MainThread): Partial parsing not enabled
2020-09-27 16:07:05.354502 (MainThread): Parsing macros/core.sql
2020-09-27 16:07:05.359236 (MainThread): Parsing macros/materializations/helpers.sql
2020-09-27 16:07:05.367899 (MainThread): Parsing macros/materializations/common/merge.sql
2020-09-27 16:07:05.382555 (MainThread): Parsing macros/materializations/table/table.sql
2020-09-27 16:07:05.389535 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2020-09-27 16:07:05.394631 (MainThread): Parsing macros/materializations/view/view.sql
2020-09-27 16:07:05.401302 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2020-09-27 16:07:05.431289 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2020-09-27 16:07:05.449621 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2020-09-27 16:07:05.451963 (MainThread): Parsing macros/materializations/seed/seed.sql
2020-09-27 16:07:05.477173 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2020-09-27 16:07:05.483704 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2020-09-27 16:07:05.485806 (MainThread): Parsing macros/etc/query.sql
2020-09-27 16:07:05.486990 (MainThread): Parsing macros/etc/get_custom_schema.sql
2020-09-27 16:07:05.489225 (MainThread): Parsing macros/etc/get_custom_alias.sql
2020-09-27 16:07:05.490292 (MainThread): Parsing macros/etc/datetime.sql
2020-09-27 16:07:05.499558 (MainThread): Parsing macros/etc/get_custom_database.sql
2020-09-27 16:07:05.501385 (MainThread): Parsing macros/etc/is_incremental.sql
2020-09-27 16:07:05.503143 (MainThread): Parsing macros/adapters/common.sql
2020-09-27 16:07:05.556728 (MainThread): Parsing macros/schema_tests/relationships.sql
2020-09-27 16:07:05.558163 (MainThread): Parsing macros/schema_tests/unique.sql
2020-09-27 16:07:05.559378 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2020-09-27 16:07:05.561560 (MainThread): Parsing macros/schema_tests/not_null.sql
2020-09-27 16:07:05.562867 (MainThread): Parsing macros/adapters.sql
2020-09-27 16:07:05.580483 (MainThread): Parsing macros/catalog.sql
2020-09-27 16:07:05.586694 (MainThread): Parsing macros/etc.sql
2020-09-27 16:07:05.587440 (MainThread): Parsing macros/materializations/incremental.sql
2020-09-27 16:07:05.600832 (MainThread): Parsing macros/materializations/snapshot.sql
2020-09-27 16:07:05.602827 (MainThread): Parsing macros/materializations/seed.sql
2020-09-27 16:07:05.605714 (MainThread): Parsing macros/materializations/table.sql
2020-09-27 16:07:05.616016 (MainThread): Parsing macros/materializations/view.sql
2020-09-27 16:07:05.621592 (MainThread): Partial parsing not enabled
2020-09-27 16:07:05.666924 (MainThread): Acquiring new bigquery connection "model.bamboodata.bbd_events_all_days".
2020-09-27 16:07:05.667050 (MainThread): Opening a new connection, currently in state init
2020-09-27 16:07:05.698627 (Thread-112): handling poll request
2020-09-27 16:07:05.699204 (Thread-112): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'a48143b7-69f2-44ce-9c93-64a5ba3d81a4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f149c8e8d30>]}
2020-09-27 16:07:05.705062 (Thread-112): sending response (<Response 9919 bytes [200 OK]>) to 10.0.27.68
2020-09-27 16:07:05.699877 (MainThread): Acquiring new bigquery connection "model.bamboodata.bbd_week_on_week_retention_rate".
2020-09-27 16:07:05.700003 (MainThread): Opening a new connection, currently in state closed
2020-09-27 16:07:05.715854 (MainThread): Acquiring new bigquery connection "model.bamboodata.bbd_country_user_progress".
2020-09-27 16:07:05.715977 (MainThread): Opening a new connection, currently in state closed
2020-09-27 16:07:05.733707 (MainThread): Acquiring new bigquery connection "model.bamboodata.bbd_events_all_days_unnested".
2020-09-27 16:07:05.733817 (MainThread): Opening a new connection, currently in state closed
2020-09-27 16:07:05.747227 (MainThread): Acquiring new bigquery connection "model.bamboodata.events".
2020-09-27 16:07:05.747344 (MainThread): Opening a new connection, currently in state closed
2020-09-27 16:07:05.910909 (MainThread): WARNING: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.output
- models.base

2020-09-27 16:07:05.951534 (MainThread): Found 5 models, 0 tests, 0 snapshots, 0 analyses, 147 macros, 0 operations, 0 seed files, 0 sources
2020-09-27 16:07:05.952308 (MainThread): 
2020-09-27 16:07:05.952627 (MainThread): Acquiring new bigquery connection "master".
2020-09-27 16:07:05.952697 (MainThread): Opening a new connection, currently in state closed
2020-09-27 16:07:05.960385 (ThreadPoolExecutor-0_0): Acquiring new bigquery connection "list_bamboodata-project".
2020-09-27 16:07:05.960481 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2020-09-27 16:07:06.178089 (ThreadPoolExecutor-1_0): Acquiring new bigquery connection "list_bamboodata-project_dbt_hdumon".
2020-09-27 16:07:06.178216 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state closed
2020-09-27 16:07:06.178732 (ThreadPoolExecutor-1_0): Client.dataset is deprecated and will be removed in a future version. Use a string like 'my_project.my_dataset' or a cloud.google.bigquery.DatasetReference object, instead.
2020-09-27 16:07:06.427491 (MainThread): 16:07:06 | Concurrency: 1 threads (target='default')
2020-09-27 16:07:06.427628 (MainThread): 16:07:06 | 
2020-09-27 16:07:06.429613 (Thread-1): Began running node model.bamboodata.events
2020-09-27 16:07:06.430788 (Thread-1): 16:07:06 | 1 of 5 START view model dbt_hdumon.events............................ [RUN]
2020-09-27 16:07:06.431079 (Thread-1): Acquiring new bigquery connection "model.bamboodata.events".
2020-09-27 16:07:06.431146 (Thread-1): Opening a new connection, currently in state closed
2020-09-27 16:07:06.431224 (Thread-1): Compiling model.bamboodata.events
2020-09-27 16:07:06.445967 (Thread-1): Writing injected SQL for node "model.bamboodata.events"
2020-09-27 16:07:06.465350 (Thread-1): finished collecting timing info
2020-09-27 16:07:06.500129 (Thread-1): Writing runtime SQL for node "model.bamboodata.events"
2020-09-27 16:07:06.518084 (Thread-1): On model.bamboodata.events: /* {"app": "dbt", "dbt_version": "0.17.2", "profile_name": "user", "target_name": "default", "node_id": "model.bamboodata.events"} */


  create or replace view `bamboodata-project`.`dbt_hdumon`.`events`
  OPTIONS()
  as SELECT format_date( "%Y%m%d" ,date_add(PARSE_DATE("%Y%m%d",event_date), interval (select date_diff(current_date, PARSE_DATE("%Y%m%d",max(event_date)),day) FROM `bamboodata-project.analytics_220006363.events_an_purchases`) day)) event_date 
       ,event_timestamp + (select date_diff(current_date, PARSE_DATE("%Y%m%d",max(event_date)),day) FROM `bamboodata-project.analytics_220006363.events_an_purchases`) * 3600*24*1000000 as event_timestamp
       ,user_first_touch_timestamp + (select date_diff(current_date, PARSE_DATE("%Y%m%d",max(event_date)),day) FROM `bamboodata-project.analytics_220006363.events_an_purchases`) * 3600*24*1000000 as user_first_touch_timestamp,

* EXCEPT(event_date, event_timestamp, user_first_touch_timestamp)
FROM `bamboodata-project.analytics_220006363.events_an_purchases`
order by event_timestamp desc;


2020-09-27 16:07:07.046978 (Thread-113): handling poll request
2020-09-27 16:07:07.047466 (Thread-113): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'a48143b7-69f2-44ce-9c93-64a5ba3d81a4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f149832d160>]}
2020-09-27 16:07:07.051174 (Thread-113): sending response (<Response 10451 bytes [200 OK]>) to 10.0.36.169
2020-09-27 16:07:07.629783 (Thread-1): finished collecting timing info
2020-09-27 16:07:07.630794 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7b13c04b-af07-420c-949b-e4511ed3029a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc1880b24e0>]}
2020-09-27 16:07:07.632531 (Thread-1): 16:07:07 | 1 of 5 OK created view model dbt_hdumon.events....................... [CREATE VIEW in 1.20s]
2020-09-27 16:07:07.632683 (Thread-1): Finished running node model.bamboodata.events
2020-09-27 16:07:07.634110 (Thread-1): Began running node model.bamboodata.bbd_country_user_progress
2020-09-27 16:07:07.635503 (Thread-1): 16:07:07 | 2 of 5 START view model dbt_hdumon.bbd_country_user_progress......... [RUN]
2020-09-27 16:07:07.635868 (Thread-1): Acquiring new bigquery connection "model.bamboodata.bbd_country_user_progress".
2020-09-27 16:07:07.635964 (Thread-1): Opening a new connection, currently in state closed
2020-09-27 16:07:07.636057 (Thread-1): Compiling model.bamboodata.bbd_country_user_progress
2020-09-27 16:07:07.654525 (Thread-1): Writing injected SQL for node "model.bamboodata.bbd_country_user_progress"
2020-09-27 16:07:07.694220 (Thread-1): finished collecting timing info
2020-09-27 16:07:07.699134 (Thread-1): Writing runtime SQL for node "model.bamboodata.bbd_country_user_progress"
2020-09-27 16:07:07.716881 (Thread-1): On model.bamboodata.bbd_country_user_progress: /* {"app": "dbt", "dbt_version": "0.17.2", "profile_name": "user", "target_name": "default", "node_id": "model.bamboodata.bbd_country_user_progress"} */


  create or replace view `bamboodata-project`.`dbt_hdumon`.`bbd_country_user_progress`
  OPTIONS()
  as with yesterday_new_users as 
(
select geo.country as country, app_info.id, count(distinct user_pseudo_id) yesterday_new_users
FROM `bamboodata-project`.`dbt_hdumon`.`events`
WHERE event_date = FORMAT_DATE("%Y%m%d", DATE_SUB(CURRENT_DATE(), INTERVAL 1 DAY))
      and event_timestamp = user_first_touch_timestamp
group by geo.country, app_info.id
),

prev_day_new_users as
(
select geo.country as country, app_info.id, count(distinct user_pseudo_id) prev_day_new_users
FROM `bamboodata-project`.`dbt_hdumon`.`events`
WHERE event_date = FORMAT_DATE("%Y%m%d", DATE_SUB(CURRENT_DATE(), INTERVAL 2 DAY))
      and event_timestamp = user_first_touch_timestamp
group by geo.country, app_info.id
),

three_day_ago_new_users as
(
select geo.country as country, app_info.id, count(distinct user_pseudo_id) three_day_ago_new_users
FROM `bamboodata-project`.`dbt_hdumon`.`events`
WHERE event_date = FORMAT_DATE("%Y%m%d", DATE_SUB(CURRENT_DATE(), INTERVAL 3 DAY))
      and event_timestamp = user_first_touch_timestamp
group by geo.country, app_info.id
),

last_week_users as
(
select geo.country as country, app_info.id, count(distinct user_pseudo_id) last_week_users
FROM `bamboodata-project`.`dbt_hdumon`.`events`
WHERE event_date <= FORMAT_DATE("%Y%m%d", DATE_TRUNC(CURRENT_DATE(), WEEK))
      AND event_date > FORMAT_DATE("%Y%m%d", DATE_SUB(DATE_TRUNC(CURRENT_DATE(), WEEK), INTERVAL 1 WEEK))
      and event_timestamp = user_first_touch_timestamp
group by geo.country,app_info.id),

previous_week_users as
(
select geo.country as country, app_info.id, count(distinct user_pseudo_id) prev_week_users
FROM `bamboodata-project`.`dbt_hdumon`.`events`
WHERE event_date <= FORMAT_DATE("%Y%m%d", DATE_SUB(DATE_TRUNC(CURRENT_DATE(), WEEK), INTERVAL 1 WEEK))
      AND event_date > FORMAT_DATE("%Y%m%d", DATE_SUB(DATE_TRUNC(CURRENT_DATE(), WEEK), INTERVAL 2 WEEK))
      and event_timestamp = user_first_touch_timestamp
group by geo.country, app_info.id)


select lwu.country, struct(lwu.id) as app_info, ynu.yesterday_new_users, pdnu.prev_day_new_users, tdnu.three_day_ago_new_users ,lwu.last_week_users, pwu.prev_week_users
from last_week_users lwu
left join yesterday_new_users ynu
on lwu.country = ynu.country
and lwu.id = ynu.id
left join prev_day_new_users pdnu
on lwu.country = pdnu.country
and lwu.id = pdnu.id
left join three_day_ago_new_users tdnu
on lwu.country = tdnu.country
and lwu.id = tdnu.id
left join previous_week_users pwu
on lwu.country = pwu.country
and lwu.id = pwu.id;


2020-09-27 16:07:07.741656 (Thread-1): unclosed <socket.socket fd=5, family=AddressFamily.AF_INET, type=2049, proto=6, laddr=('10.0.7.225', 52018), raddr=('172.217.15.106', 443)>
2020-09-27 16:07:07.742041 (Thread-1): unclosed <socket.socket fd=7, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=6, laddr=('10.0.7.225', 39542), raddr=('172.217.2.106', 443)>
2020-09-27 16:07:07.742277 (Thread-1): unclosed <socket.socket fd=10, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=6, laddr=('10.0.7.225', 39582), raddr=('172.217.2.106', 443)>
2020-09-27 16:07:07.742496 (Thread-1): unclosed <socket.socket fd=9, family=AddressFamily.AF_INET, type=2049, proto=6, laddr=('10.0.7.225', 34964), raddr=('172.217.8.10', 443)>
2020-09-27 16:07:07.742735 (Thread-1): unclosed <socket.socket fd=11, family=AddressFamily.AF_INET, type=2049, proto=6, laddr=('10.0.7.225', 52122), raddr=('172.217.15.106', 443)>
2020-09-27 16:07:07.742928 (Thread-1): unclosed <socket.socket fd=12, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=6, laddr=('10.0.7.225', 39648), raddr=('172.217.2.106', 443)>
2020-09-27 16:07:08.497541 (Thread-114): handling poll request
2020-09-27 16:07:08.498018 (Thread-114): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'a48143b7-69f2-44ce-9c93-64a5ba3d81a4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1498344860>]}
2020-09-27 16:07:08.500273 (Thread-114): Checking header 'user-agent' tracing in whitelist set(), 24 additional messages skipped
2020-09-27 16:07:08.523318 (Thread-114): writing 1 spans (enabled:True), 147 additional messages skipped
2020-09-27 16:07:08.523541 (Thread-114): 
      name requests.request
        id 10544149810868294293
  trace_id 17345110872446045939
 parent_id None
   service requests
  resource requests.request
      type http
     start 1601222828.4997618
       end 1601222828.5232017
  duration 0.023440s
     error 0
      tags 
           http.method:POST
           http.status_code:200
           http.url:https://fishtownanalytics.sinter-collect.com/com.snowplowanalytics.snowplow/tp2
           runtime-id:8671c46a3c914bbfa95f40976d37c7bc, 147 additional messages skipped
2020-09-27 16:07:08.527226 (Thread-114): sending response (<Response 8630 bytes [200 OK]>) to 10.0.34.126
2020-09-27 16:07:08.694807 (Thread-1): finished collecting timing info
2020-09-27 16:07:08.695588 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7b13c04b-af07-420c-949b-e4511ed3029a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc180993630>]}
2020-09-27 16:07:08.696977 (Thread-1): 16:07:08 | 2 of 5 OK created view model dbt_hdumon.bbd_country_user_progress.... [CREATE VIEW in 1.06s]
2020-09-27 16:07:08.697080 (Thread-1): Finished running node model.bamboodata.bbd_country_user_progress
2020-09-27 16:07:08.697224 (Thread-1): Began running node model.bamboodata.bbd_events_all_days
2020-09-27 16:07:08.698156 (Thread-1): 16:07:08 | 3 of 5 START view model dbt_hdumon.bbd_events_all_days............... [RUN]
2020-09-27 16:07:08.698388 (Thread-1): Acquiring new bigquery connection "model.bamboodata.bbd_events_all_days".
2020-09-27 16:07:08.698453 (Thread-1): Opening a new connection, currently in state closed
2020-09-27 16:07:08.698517 (Thread-1): Compiling model.bamboodata.bbd_events_all_days
2020-09-27 16:07:08.706155 (Thread-1): Writing injected SQL for node "model.bamboodata.bbd_events_all_days"
2020-09-27 16:07:08.717082 (Thread-1): finished collecting timing info
2020-09-27 16:07:08.721603 (Thread-1): Writing runtime SQL for node "model.bamboodata.bbd_events_all_days"
2020-09-27 16:07:08.731215 (Thread-1): On model.bamboodata.bbd_events_all_days: /* {"app": "dbt", "dbt_version": "0.17.2", "profile_name": "user", "target_name": "default", "node_id": "model.bamboodata.bbd_events_all_days"} */


  create or replace view `bamboodata-project`.`dbt_hdumon`.`bbd_events_all_days`
  OPTIONS()
  as SELECT
  *,
  extract(hour from timestamp_micros(event_timestamp)) event_hour,
        case when extract(dayofweek from timestamp_micros(event_timestamp)) = 1 then '1. Monday'
             when extract(dayofweek from timestamp_micros(event_timestamp)) = 2 then '2. Tuesday'
             when extract(dayofweek from timestamp_micros(event_timestamp)) = 3 then '3. Wednesday'
             when extract(dayofweek from timestamp_micros(event_timestamp)) = 4 then '4. Thursday'
             when extract(dayofweek from timestamp_micros(event_timestamp)) = 5 then '5. Friday'
             when extract(dayofweek from timestamp_micros(event_timestamp)) = 6 then '6. Saturday'
             when extract(dayofweek from timestamp_micros(event_timestamp)) = 7 then '7. Sunday'
        end as event_weekday_name,
  case when traffic_source.name = '(direct)' or traffic_source.name = '(organic)' or traffic_source.name is null then 'Organic' else traffic_source.name end as acquisition_channel,
  FORMAT_TIMESTAMP("%Y-%m-%d %H:%M:%S",TIMESTAMP_MICROS(event_timestamp)) event_time,
  coalesce(device.vendor_id,
    device.advertising_id) vendor_advertising_id,
  DATE_DIFF(EXTRACT(DATE
    FROM
      TIMESTAMP_MICROS(event_timestamp)), EXTRACT(DATE
    FROM
      TIMESTAMP_MICROS(user_first_touch_timestamp)),DAY) AS days_since_first_touch,
  CASE
    WHEN MAX(CASE
      WHEN user_id IS NOT NULL THEN 1
    ELSE
    0
  END
    ) OVER (PARTITION BY user_pseudo_id) = 1 THEN 'Registered User'
  ELSE
  'Non Registered User'
END
  AS registered_user_flag,
  CASE
    WHEN MAX(CASE
      WHEN event_name = 'in_app_purchase' THEN 1
    ELSE
    0
  END
    ) OVER (PARTITION BY user_pseudo_id) = 1 THEN 'Paying User'
  ELSE
  'Non Paying User'
END
  AS paying_user_flag
FROM
  `bamboodata-project`.`dbt_hdumon`.`events`;


2020-09-27 16:07:08.781950 (AgentWriter): reported 1 traces in 0.00358s, 4 additional messages skipped
2020-09-27 16:07:08.782208 (AgentWriter): initialized RateSampler, sample 100% of traces, 159 additional messages skipped
2020-09-27 16:07:09.672741 (Thread-1): finished collecting timing info
2020-09-27 16:07:09.673888 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7b13c04b-af07-420c-949b-e4511ed3029a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc1809994a8>]}
2020-09-27 16:07:09.675695 (Thread-1): 16:07:09 | 3 of 5 OK created view model dbt_hdumon.bbd_events_all_days.......... [CREATE VIEW in 0.98s]
2020-09-27 16:07:09.675835 (Thread-1): Finished running node model.bamboodata.bbd_events_all_days
2020-09-27 16:07:09.676024 (Thread-1): Began running node model.bamboodata.bbd_events_all_days_unnested
2020-09-27 16:07:09.677555 (Thread-1): 16:07:09 | 4 of 5 START view model dbt_hdumon.bbd_events_all_days_unnested...... [RUN]
2020-09-27 16:07:09.677900 (Thread-1): Acquiring new bigquery connection "model.bamboodata.bbd_events_all_days_unnested".
2020-09-27 16:07:09.677997 (Thread-1): Opening a new connection, currently in state closed
2020-09-27 16:07:09.678096 (Thread-1): Compiling model.bamboodata.bbd_events_all_days_unnested
2020-09-27 16:07:09.689952 (Thread-1): Writing injected SQL for node "model.bamboodata.bbd_events_all_days_unnested"
2020-09-27 16:07:09.701578 (Thread-1): finished collecting timing info
2020-09-27 16:07:09.707680 (Thread-1): Writing runtime SQL for node "model.bamboodata.bbd_events_all_days_unnested"
2020-09-27 16:07:09.719940 (Thread-1): On model.bamboodata.bbd_events_all_days_unnested: /* {"app": "dbt", "dbt_version": "0.17.2", "profile_name": "user", "target_name": "default", "node_id": "model.bamboodata.bbd_events_all_days_unnested"} */


  create or replace view `bamboodata-project`.`dbt_hdumon`.`bbd_events_all_days_unnested`
  OPTIONS()
  as with data as
(
SELECT
  *,
  FORMAT_TIMESTAMP("%Y-%m-%d %H:%M:%S",TIMESTAMP_MICROS(event_timestamp)) event_time,
  coalesce(device.vendor_id,
    device.advertising_id) vendor_advertising_id,
  DATE_DIFF(EXTRACT(DATE
    FROM
      TIMESTAMP_MICROS(event_timestamp)), EXTRACT(DATE
    FROM
      TIMESTAMP_MICROS(user_first_touch_timestamp)),DAY) AS days_since_first_touch,
  CASE
    WHEN MAX(CASE
      WHEN user_id IS NOT NULL THEN 1
    ELSE
    0
  END
    ) OVER (PARTITION BY user_pseudo_id) = 1 THEN 'Registered User'
  ELSE
  'Non Registered User'
END
  AS registered_user_flag,
  CASE
    WHEN MAX(CASE
      WHEN event_name = 'in_app_purchase' THEN 1
    ELSE
    0
  END
    ) OVER (PARTITION BY user_pseudo_id) = 1 THEN 'Paying User'
  ELSE
  'Non Paying User'
END
  AS paying_user_flag
FROM
  `bamboodata-project`.`dbt_hdumon`.`events`
)

SELECT
  event_time, event_date, days_since_first_touch, event_timestamp, user_id, vendor_advertising_id, event_name, key, value.int_value, value.string_value
FROM
  data ,
  UNNEST(event_params);


2020-09-27 16:07:09.844819 (Thread-115): handling poll request
2020-09-27 16:07:09.845407 (Thread-115): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'a48143b7-69f2-44ce-9c93-64a5ba3d81a4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1498344630>]}
2020-09-27 16:07:09.849052 (Thread-115): sending response (<Response 14703 bytes [200 OK]>) to 10.0.5.150
2020-09-27 16:07:10.891271 (Thread-1): finished collecting timing info
2020-09-27 16:07:10.892018 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7b13c04b-af07-420c-949b-e4511ed3029a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc18006dcf8>]}
2020-09-27 16:07:10.893316 (Thread-1): 16:07:10 | 4 of 5 OK created view model dbt_hdumon.bbd_events_all_days_unnested. [CREATE VIEW in 1.21s]
2020-09-27 16:07:10.893417 (Thread-1): Finished running node model.bamboodata.bbd_events_all_days_unnested
2020-09-27 16:07:10.893550 (Thread-1): Began running node model.bamboodata.bbd_week_on_week_retention_rate
2020-09-27 16:07:10.894481 (Thread-1): 16:07:10 | 5 of 5 START view model dbt_hdumon.bbd_week_on_week_retention_rate... [RUN]
2020-09-27 16:07:10.894725 (Thread-1): Acquiring new bigquery connection "model.bamboodata.bbd_week_on_week_retention_rate".
2020-09-27 16:07:10.894791 (Thread-1): Opening a new connection, currently in state closed
2020-09-27 16:07:10.894855 (Thread-1): Compiling model.bamboodata.bbd_week_on_week_retention_rate
2020-09-27 16:07:10.895807 (Thread-1): unclosed <socket.socket fd=10, family=AddressFamily.AF_INET, type=2049, proto=6, laddr=('10.0.7.225', 35294), raddr=('172.217.8.10', 443)>
2020-09-27 16:07:10.896024 (Thread-1): unclosed <socket.socket fd=11, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=6, laddr=('10.0.7.225', 40626), raddr=('172.217.13.74', 443)>
2020-09-27 16:07:10.904697 (Thread-1): Writing injected SQL for node "model.bamboodata.bbd_week_on_week_retention_rate"
2020-09-27 16:07:10.928455 (Thread-1): finished collecting timing info
2020-09-27 16:07:10.932931 (Thread-1): Writing runtime SQL for node "model.bamboodata.bbd_week_on_week_retention_rate"
2020-09-27 16:07:10.961087 (Thread-1): On model.bamboodata.bbd_week_on_week_retention_rate: /* {"app": "dbt", "dbt_version": "0.17.2", "profile_name": "user", "target_name": "default", "node_id": "model.bamboodata.bbd_week_on_week_retention_rate"} */


  create or replace view `bamboodata-project`.`dbt_hdumon`.`bbd_week_on_week_retention_rate`
  OPTIONS()
  as WITH
  users AS ( 
  SELECT
    DISTINCT user_pseudo_id,
    geo.country
  FROM
    `bamboodata-project.analytics_220006363.events_` /* INSERT NAME OF YOUR EVENTS TABLE HERE */
  WHERE
    event_timestamp = user_first_touch_timestamp),
  registrations AS (
  SELECT
    DISTINCT user_pseudo_id,
    MAX(CASE
        WHEN user_id IS NOT NULL THEN 1
      ELSE
      0
    END
      ) OVER (PARTITION BY user_pseudo_id) AS registered_user_flag
  FROM
    `bamboodata-project`.`dbt_hdumon`.`events`), /* INSERT NAME OF YOUR EVENTS TABLE HERE */
  paying_users AS (
  SELECT
    DISTINCT user_pseudo_id,
    1 AS paying_user_flag
  FROM
    `bamboodata-project.analytics_220006363.events_` /* INSERT NAME OF YOUR EVENTS TABLE HERE */
  WHERE
    event_name = 'in_app_purchase'),
  by_week AS (
  SELECT
    DISTINCT TIMESTAMP_TRUNC(TIMESTAMP_MICROS(user_first_touch_timestamp), WEEK(MONDAY), 'UTC') AS first_touch_week,
    TIMESTAMP_TRUNC(TIMESTAMP_MICROS(event_timestamp), WEEK(MONDAY), 'UTC') AS event_week,
    event_name,
    device.category device_category,
    app_info.id app_info_id,
    user_pseudo_id
  FROM
    `bamboodata-project`.`dbt_hdumon`.`events` /* INSERT NAME OF YOUR EVENTS TABLE HERE */
--   WHERE
--    _TABLE_SUFFIX BETWEEN FORMAT_DATE("%Y%m%d", DATE_SUB(CURRENT_DATE(), INTERVAL 3 MONTH)) /* FILTER OUT EVENTS TABLES THAT ARE MORE THAN 3 MONTHS OLD */
--     AND FORMAT_DATE("%Y%m%d", DATE_SUB(CURRENT_DATE(), INTERVAL 1 DAY)) 
  GROUP BY
    first_touch_week,
    event_week,
    event_name,
    user_pseudo_id,
    device.category,
    app_info.id),
  with_week_number AS (
  SELECT
    bw.user_pseudo_id,
    CASE
      WHEN pu.paying_user_flag = 1 THEN 'Paying user'
    ELSE
    'Non paying user'
  END
    paying_user_flag,
    users.country,
    reg.registered_user_flag,
    bw.first_touch_week,
    bw.event_week,
    device_category,
    app_info_id,
    bw.event_name,
    FLOOR( TIMESTAMP_DIFF(bw.event_week, bw.first_touch_week, DAY)/7 ) AS weeks_since_first_touch
  FROM
    by_week bw
  LEFT JOIN
    users
  ON
    bw.user_pseudo_id = users.user_pseudo_id
  LEFT JOIN
    registrations reg
  ON
    bw.user_pseudo_id = reg.user_pseudo_id
  LEFT JOIN
    paying_users pu
  ON
    bw.user_pseudo_id = pu.user_pseudo_id )
SELECT
  country,
  registered_user_flag,
  paying_user_flag,
  first_touch_week,
  device_category,
  app_info_id,
  event_name,
  user_pseudo_id,
  CASE
    WHEN MAX(CASE
      WHEN weeks_since_first_touch = 0 THEN 1
    ELSE
    0
  END
    ) = 1 THEN user_pseudo_id
  ELSE
  NULL
END
  week_0,
  CASE
    WHEN MAX(CASE
      WHEN weeks_since_first_touch = 1 THEN 1
    ELSE
    0
  END
    ) = 1 THEN user_pseudo_id
  ELSE
  NULL
END
  week_1,
  CASE
    WHEN MAX(CASE
      WHEN weeks_since_first_touch = 2 THEN 1
    ELSE
    0
  END
    ) = 1 THEN user_pseudo_id
  ELSE
  NULL
END
  week_2,
  CASE
    WHEN MAX(CASE
      WHEN weeks_since_first_touch = 3 THEN 1
    ELSE
    0
  END
    ) = 1 THEN user_pseudo_id
  ELSE
  NULL
END
  week_3,
  CASE
    WHEN MAX(CASE
      WHEN weeks_since_first_touch = 4 THEN 1
    ELSE
    0
  END
    ) = 1 THEN user_pseudo_id
  ELSE
  NULL
END
  week_4,
  CASE
    WHEN MAX(CASE
      WHEN weeks_since_first_touch = 5 THEN 1
    ELSE
    0
  END
    ) = 1 THEN user_pseudo_id
  ELSE
  NULL
END
  week_5,
  CASE
    WHEN MAX(CASE
      WHEN weeks_since_first_touch = 6 THEN 1
    ELSE
    0
  END
    ) = 1 THEN user_pseudo_id
  ELSE
  NULL
END
  week_6,
  CASE
    WHEN MAX(CASE
      WHEN weeks_since_first_touch = 7 THEN 1
    ELSE
    0
  END
    ) = 1 THEN user_pseudo_id
  ELSE
  NULL
END
  week_7,
  CASE
    WHEN MAX(CASE
      WHEN weeks_since_first_touch = 8 THEN 1
    ELSE
    0
  END
    ) = 1 THEN user_pseudo_id
  ELSE
  NULL
END
  week_8,
  CASE
    WHEN MAX(CASE
      WHEN weeks_since_first_touch = 9 THEN 1
    ELSE
    0
  END
    ) = 1 THEN user_pseudo_id
  ELSE
  NULL
END
  week_9,
  CASE
    WHEN MAX(CASE
      WHEN weeks_since_first_touch = 10 THEN 1
    ELSE
    0
  END
    ) = 1 THEN user_pseudo_id
  ELSE
  NULL
END
  week_10
FROM
  with_week_number
WHERE
  DATE(first_touch_week) >= DATE_TRUNC(DATE_SUB(CURRENT_DATE(), INTERVAL 10 WEEK),WEEK(MONDAY))
GROUP BY
  user_pseudo_id,
  country,
  registered_user_flag,
  paying_user_flag,
  first_touch_week,
  app_info_id,
  device_category,
  event_name,
  user_pseudo_id;


2020-09-27 16:07:11.144006 (Thread-116): handling poll request
2020-09-27 16:07:11.144477 (Thread-116): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'a48143b7-69f2-44ce-9c93-64a5ba3d81a4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f149824d3c8>]}
2020-09-27 16:07:11.146827 (Thread-116): sending response (<Response 10804 bytes [200 OK]>) to 10.0.12.156
2020-09-27 16:07:11.867485 (Thread-1): finished collecting timing info
2020-09-27 16:07:11.868767 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7b13c04b-af07-420c-949b-e4511ed3029a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc18002f0b8>]}
2020-09-27 16:07:11.870633 (Thread-1): 16:07:11 | 5 of 5 OK created view model dbt_hdumon.bbd_week_on_week_retention_rate [CREATE VIEW in 0.97s]
2020-09-27 16:07:11.870791 (Thread-1): Finished running node model.bamboodata.bbd_week_on_week_retention_rate
2020-09-27 16:07:11.940587 (MainThread): Acquiring new bigquery connection "master".
2020-09-27 16:07:11.940764 (MainThread): Opening a new connection, currently in state closed
2020-09-27 16:07:11.941241 (MainThread): 16:07:11 | 
2020-09-27 16:07:11.941366 (MainThread): 16:07:11 | Finished running 5 view models in 5.99s.
2020-09-27 16:07:11.941461 (MainThread): Connection 'master' was properly closed.
2020-09-27 16:07:11.941534 (MainThread): Connection 'model.bamboodata.bbd_week_on_week_retention_rate' was properly closed.
2020-09-27 16:07:11.968407 (MainThread): unclosed <socket.socket fd=10, family=AddressFamily.AF_INET, type=2049, proto=6, laddr=('10.0.7.225', 35358), raddr=('172.217.8.10', 443)>
2020-09-27 16:07:11.968717 (MainThread): unclosed <socket.socket fd=11, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=6, laddr=('10.0.7.225', 39972), raddr=('172.217.2.106', 443)>
2020-09-27 16:07:12.011674 (MainThread): 
2020-09-27 16:07:12.011879 (MainThread): Completed successfully
2020-09-27 16:07:12.011981 (MainThread): 
Done. PASS=5 WARN=0 ERROR=0 SKIP=0 TOTAL=5
2020-09-27 16:07:12.732921 (Thread-117): handling poll request
2020-09-27 16:07:12.733445 (Thread-117): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'a48143b7-69f2-44ce-9c93-64a5ba3d81a4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f149848fac8>]}
2020-09-27 16:07:12.750426 (Thread-117): sending response (<Response 46045 bytes [200 OK]>) to 10.0.3.121
2020-09-27 16:07:13.168960 (Thread-118): handling status request
2020-09-27 16:07:13.169677 (Thread-118): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'a48143b7-69f2-44ce-9c93-64a5ba3d81a4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f149832dcf8>]}
2020-09-27 16:07:13.171110 (Thread-118): sending response (<Response 875 bytes [200 OK]>) to 10.0.27.68
2020-09-27 16:07:40.004926 (Thread-119): handling status request
2020-09-27 16:07:40.006663 (Thread-119): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'a48143b7-69f2-44ce-9c93-64a5ba3d81a4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1498508278>]}
2020-09-27 16:07:40.007751 (Thread-119): sending response (<Response 875 bytes [200 OK]>) to 10.0.12.156
